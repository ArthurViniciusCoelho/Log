/*! For license information please see main.bundle.js.LICENSE.txt */
(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}();const e=function(t,e){if(!t)throw n(e)},n=function(t){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+t)},i=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let s=t.charCodeAt(i);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=63&s|128):55296==(64512&s)&&i+1<t.length&&56320==(64512&t.charCodeAt(i+1))?(s=65536+((1023&s)<<10)+(1023&t.charCodeAt(++i)),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=63&s|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=63&s|128)}return e},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let e=0;e<t.length;e+=3){const s=t[e],r=e+1<t.length,o=r?t[e+1]:0,a=e+2<t.length,l=a?t[e+2]:0,c=s>>2,h=(3&s)<<4|o>>4;let u=(15&o)<<2|l>>6,d=63&l;a||(d=64,r||(u=64)),i.push(n[c],n[h],n[u],n[d])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(i(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){const e=[];let n=0,i=0;for(;n<t.length;){const s=t[n++];if(s<128)e[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=t[n++];e[i++]=String.fromCharCode((31&s)<<6|63&r)}else if(s>239&&s<365){const r=((7&s)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++])-65536;e[i++]=String.fromCharCode(55296+(r>>10)),e[i++]=String.fromCharCode(56320+(1023&r))}else{const r=t[n++],o=t[n++];e[i++]=String.fromCharCode((15&s)<<12|(63&r)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let e=0;e<t.length;){const s=n[t.charAt(e++)],o=e<t.length?n[t.charAt(e)]:0;++e;const a=e<t.length?n[t.charAt(e)]:64;++e;const l=e<t.length?n[t.charAt(e)]:64;if(++e,null==s||null==o||null==a||null==l)throw new r;const c=s<<2|o>>4;if(i.push(c),64!==a){const t=o<<4&240|a>>2;if(i.push(t),64!==l){const t=a<<6&192|l;i.push(t)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class r extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o=function(t){const e=i(t);return s.encodeByteArray(e,!0)},a=function(t){return o(t).replace(/\./g,"")},l=function(t){try{return s.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function c(t){return h(void 0,t)}function h(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=h(t[n],e[n]));return t}function u(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t.g)return t.g;throw new Error("Unable to locate global object.")}const d=()=>{try{return u().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process)return;const t="MISSING_ENV_VAR".__FIREBASE_DEFAULTS__;return t?JSON.parse(t):void 0})()||(()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(t){return}const e=t&&l(t[1]);return e&&JSON.parse(e)})()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}},p=t=>{var e,n;return null===(n=null===(e=d())||void 0===e?void 0:e.emulatorHosts)||void 0===n?void 0:n[t]},f=()=>{var t;return null===(t=d())||void 0===t?void 0:t.config},g=t=>{var e;return null===(e=d())||void 0===e?void 0:e[`_${t}`]};class m{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}wrapCallback(t){return(e,n)=>{e?this.reject(e):this.resolve(n),"function"==typeof t&&(this.promise.catch((()=>{})),1===t.length?t(e):t(e,n))}}}function _(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function y(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(_())}function v(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function b(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function w(){try{return"object"==typeof indexedDB}catch(t){return!1}}function x(){return new Promise(((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}class k extends Error{constructor(t,e,n){super(e),this.code=t,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,k.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,C.prototype.create)}}class C{constructor(t,e,n){this.service=t,this.serviceName=e,this.errors=n}create(t,...e){const n=e[0]||{},i=`${this.service}/${t}`,s=this.errors[t],r=s?function(t,e){return t.replace(I,((t,n)=>{const i=e[n];return null!=i?String(i):`<${n}?>`}))}(s,n):"Error",o=`${this.serviceName}: ${r} (${i}).`;return new k(i,o,n)}}const I=/\{\$([^}]+)}/g;function T(t){return JSON.parse(t)}function S(t){return JSON.stringify(t)}const E=function(t){let e={},n={},i={},s="";try{const r=t.split(".");e=T(l(r[0])||""),n=T(l(r[1])||""),s=r[2],i=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:i,signature:s}};function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function M(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function R(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function O(t,e,n){const i={};for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(i[s]=e.call(n,t[s],s,t));return i}function A(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const s of n){if(!i.includes(s))return!1;const n=t[s],r=e[s];if(D(n)&&D(r)){if(!A(n,r))return!1}else if(n!==r)return!1}for(const t of i)if(!n.includes(t))return!1;return!0}function D(t){return null!==t&&"object"==typeof t}function N(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach((t=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(t))})):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function L(t){const e={};return t.replace(/^\?/,"").split("&").forEach((t=>{if(t){const[n,i]=t.split("=");e[decodeURIComponent(n)]=decodeURIComponent(i)}})),e}function F(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}class z{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const n=this.W_;if("string"==typeof t)for(let i=0;i<16;i++)n[i]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let i=0;i<16;i++)n[i]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let t=16;t<80;t++){const e=n[t-3]^n[t-8]^n[t-14]^n[t-16];n[t]=4294967295&(e<<1|e>>>31)}let i,s,r=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let t=0;t<80;t++){t<40?t<20?(i=l^o&(a^l),s=1518500249):(i=o^a^l,s=1859775393):t<60?(i=o&a|l&(o|a),s=2400959708):(i=o^a^l,s=3395469782);const e=(r<<5|r>>>27)+i+c+s+n[t]&4294967295;c=l,l=a,a=4294967295&(o<<30|o>>>2),o=r,r=e}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const n=e-this.blockSize;let i=0;const s=this.buf_;let r=this.inbuf_;for(;i<e;){if(0===r)for(;i<=n;)this.compress_(t,i),i+=this.blockSize;if("string"==typeof t){for(;i<e;)if(s[r]=t.charCodeAt(i),++r,++i,r===this.blockSize){this.compress_(s),r=0;break}}else for(;i<e;)if(s[r]=t[i],++r,++i,r===this.blockSize){this.compress_(s),r=0;break}}this.inbuf_=r,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let t=this.blockSize-1;t>=56;t--)this.buf_[t]=255&e,e/=256;this.compress_(this.buf_);let n=0;for(let e=0;e<5;e++)for(let i=24;i>=0;i-=8)t[n]=this.chain_[e]>>i&255,++n;return t}}class j{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((()=>{t(this)})).catch((t=>{this.error(t)}))}next(t){this.forEachObserver((e=>{e.next(t)}))}error(t){this.forEachObserver((e=>{e.error(t)})),this.close(t)}complete(){this.forEachObserver((t=>{t.complete()})),this.close()}subscribe(t,e,n){let i;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");i=function(t){if("object"!=typeof t||null===t)return!1;for(const e of["next","error","complete"])if(e in t&&"function"==typeof t[e])return!0;return!1}(t)?t:{next:t,error:e,complete:n},void 0===i.next&&(i.next=V),void 0===i.error&&(i.error=V),void 0===i.complete&&(i.complete=V);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch(t){}})),this.observers.push(i),s}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function V(){}function U(t,e){return`${t} failed: ${e} argument `}const W=function(t){let e=0;for(let n=0;n<t.length;n++){const i=t.charCodeAt(n);i<128?e++:i<2048?e+=2:i>=55296&&i<=56319?(e+=4,n++):e+=3}return e},B=1e3,H=2,q=144e5,$=.5;function K(t,e=B,n=H){const i=e*Math.pow(n,t),s=Math.round($*i*(Math.random()-.5)*2);return Math.min(q,i+s)}function Y(t){return t&&t._delegate?t._delegate:t}class G{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const J="[DEFAULT]";class X{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const t=new m;if(this.instancesDeferred.set(e,t),this.isInitialized(e)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:e});n&&t.resolve(n)}catch(t){}}return this.instancesDeferred.get(e).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(i)return null;throw t}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:J})}catch(t){}for(const[t,e]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:n});e.resolve(t)}catch(t){}}}}clearInstance(t=J){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter((t=>"INTERNAL"in t)).map((t=>t.INTERNAL.delete())),...t.filter((t=>"_delete"in t)).map((t=>t._delete()))])}isComponentSet(){return null!=this.component}isInitialized(t=J){return this.instances.has(t)}getOptions(t=J){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[t,e]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(t)&&e.resolve(i);return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const i of n)try{i(t,e)}catch(t){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===J?void 0:i),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(t){}var i;return n||null}normalizeInstanceIdentifier(t=J){return this.component?this.component.multipleInstances?t:J:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Q{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new X(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}const Z=[];var tt;!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(tt||(tt={}));const et={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},nt=tt.INFO,it={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},st=(t,e,...n)=>{if(e<t.logLevel)return;const i=(new Date).toISOString(),s=it[e];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[s](`[${i}]  ${t.name}:`,...n)};class rt{constructor(t){this.name=t,this._logLevel=nt,this._logHandler=st,this._userLogHandler=null,Z.push(this)}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in tt))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel="string"==typeof t?et[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...t),this._logHandler(this,tt.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...t),this._logHandler(this,tt.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...t),this._logHandler(this,tt.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...t),this._logHandler(this,tt.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...t),this._logHandler(this,tt.ERROR,...t)}}const ot=(t,e)=>e.some((e=>t instanceof e));let at,lt;const ct=new WeakMap,ht=new WeakMap,ut=new WeakMap,dt=new WeakMap,pt=new WeakMap;let ft={get(t,e,n){if(t instanceof IDBTransaction){if("done"===e)return ht.get(t);if("objectStoreNames"===e)return t.objectStoreNames||ut.get(t);if("store"===e)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return mt(t[e])},set:(t,e,n)=>(t[e]=n,!0),has:(t,e)=>t instanceof IDBTransaction&&("done"===e||"store"===e)||e in t};function gt(t){return"function"==typeof t?(e=t)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(lt||(lt=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(_t(this),t),mt(ct.get(this))}:function(...t){return mt(e.apply(_t(this),t))}:function(t,...n){const i=e.call(_t(this),t,...n);return ut.set(i,t.sort?t.sort():[t]),mt(i)}:(t instanceof IDBTransaction&&function(t){if(ht.has(t))return;const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",r),t.removeEventListener("abort",r)},s=()=>{e(),i()},r=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",r),t.addEventListener("abort",r)}));ht.set(t,e)}(t),ot(t,at||(at=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(t,ft):t);var e}function mt(t){if(t instanceof IDBRequest)return function(t){const e=new Promise(((e,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",r)},s=()=>{e(mt(t.result)),i()},r=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",r)}));return e.then((e=>{e instanceof IDBCursor&&ct.set(e,t)})).catch((()=>{})),pt.set(e,t),e}(t);if(dt.has(t))return dt.get(t);const e=gt(t);return e!==t&&(dt.set(t,e),pt.set(e,t)),e}const _t=t=>pt.get(t);function yt(t,e,{blocked:n,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(t,e),a=mt(o);return i&&o.addEventListener("upgradeneeded",(t=>{i(mt(o.result),t.oldVersion,t.newVersion,mt(o.transaction),t)})),n&&o.addEventListener("blocked",(t=>n(t.oldVersion,t.newVersion,t))),a.then((t=>{r&&t.addEventListener("close",(()=>r())),s&&t.addEventListener("versionchange",(t=>s(t.oldVersion,t.newVersion,t)))})).catch((()=>{})),a}const vt=["get","getKey","getAll","getAllKeys","count"],bt=["put","add","delete","clear"],wt=new Map;function xt(t,e){if(!(t instanceof IDBDatabase)||e in t||"string"!=typeof e)return;if(wt.get(e))return wt.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,s=bt.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!s&&!vt.includes(n))return;const r=async function(t,...e){const r=this.transaction(t,s?"readwrite":"readonly");let o=r.store;return i&&(o=o.index(e.shift())),(await Promise.all([o[n](...e),s&&r.done]))[0]};return wt.set(e,r),r}var kt;kt=ft,ft={...kt,get:(t,e,n)=>xt(t,e)||kt.get(t,e,n),has:(t,e)=>!!xt(t,e)||kt.has(t,e)};class Ct{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map((t=>{if(function(t){const e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){const e=t.getImmediate();return`${e.library}/${e.version}`}return null})).filter((t=>t)).join(" ")}}const It="@firebase/app",Tt="0.10.8",St=new rt("@firebase/app"),Et="@firebase/app-compat",Pt="@firebase/analytics-compat",Mt="@firebase/analytics",Rt="@firebase/app-check-compat",Ot="@firebase/app-check",At="@firebase/auth",Dt="@firebase/auth-compat",Nt="@firebase/database",Lt="@firebase/database-compat",Ft="@firebase/functions",zt="@firebase/functions-compat",jt="@firebase/installations",Vt="@firebase/installations-compat",Ut="@firebase/messaging",Wt="@firebase/messaging-compat",Bt="@firebase/performance",Ht="@firebase/performance-compat",qt="@firebase/remote-config",$t="@firebase/remote-config-compat",Kt="@firebase/storage",Yt="@firebase/storage-compat",Gt="@firebase/firestore",Jt="@firebase/vertexai-preview",Xt="@firebase/firestore-compat",Qt="firebase",Zt="[DEFAULT]",te={[It]:"fire-core",[Et]:"fire-core-compat",[Mt]:"fire-analytics",[Pt]:"fire-analytics-compat",[Ot]:"fire-app-check",[Rt]:"fire-app-check-compat",[At]:"fire-auth",[Dt]:"fire-auth-compat",[Nt]:"fire-rtdb",[Lt]:"fire-rtdb-compat",[Ft]:"fire-fn",[zt]:"fire-fn-compat",[jt]:"fire-iid",[Vt]:"fire-iid-compat",[Ut]:"fire-fcm",[Wt]:"fire-fcm-compat",[Bt]:"fire-perf",[Ht]:"fire-perf-compat",[qt]:"fire-rc",[$t]:"fire-rc-compat",[Kt]:"fire-gcs",[Yt]:"fire-gcs-compat",[Gt]:"fire-fst",[Xt]:"fire-fst-compat",[Jt]:"fire-vertex","fire-js":"fire-js",[Qt]:"fire-js-all"},ee=new Map,ne=new Map,ie=new Map;function se(t,e){try{t.container.addComponent(e)}catch(n){St.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function re(t){const e=t.name;if(ie.has(e))return St.debug(`There were multiple attempts to register component ${e}.`),!1;ie.set(e,t);for(const e of ee.values())se(e,t);for(const e of ne.values())se(e,t);return!0}function oe(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function ae(t){return void 0!==t.settings}const le=new C("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class ce{constructor(t,e,n){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},e),this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new G("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw le.create("app-deleted",{appName:this._name})}}const he="10.12.5";function ue(t,e={}){let n=t;"object"!=typeof e&&(e={name:e});const i=Object.assign({name:Zt,automaticDataCollectionEnabled:!1},e),s=i.name;if("string"!=typeof s||!s)throw le.create("bad-app-name",{appName:String(s)});if(n||(n=f()),!n)throw le.create("no-options");const r=ee.get(s);if(r){if(A(n,r.options)&&A(i,r.config))return r;throw le.create("duplicate-app",{appName:s})}const o=new Q(s);for(const t of ie.values())o.addComponent(t);const a=new ce(n,i,o);return ee.set(s,a),a}function de(t=Zt){const e=ee.get(t);if(!e&&t===Zt&&f())return ue();if(!e)throw le.create("no-app",{appName:t});return e}function pe(t,e,n){var i;let s=null!==(i=te[t])&&void 0!==i?i:t;n&&(s+=`-${n}`);const r=s.match(/\s|\//),o=e.match(/\s|\//);if(r||o){const t=[`Unable to register library "${s}" with version "${e}":`];return r&&t.push(`library name "${s}" contains illegal characters (whitespace or "/")`),r&&o&&t.push("and"),o&&t.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void St.warn(t.join(" "))}re(new G(`${s}-version`,(()=>({library:s,version:e})),"VERSION"))}const fe="firebase-heartbeat-database",ge=1,me="firebase-heartbeat-store";let _e=null;function ye(){return _e||(_e=yt(fe,ge,{upgrade:(t,e)=>{if(0===e)try{t.createObjectStore(me)}catch(t){console.warn(t)}}}).catch((t=>{throw le.create("idb-open",{originalErrorMessage:t.message})}))),_e}async function ve(t,e){try{const n=(await ye()).transaction(me,"readwrite"),i=n.objectStore(me);await i.put(e,be(t)),await n.done}catch(t){if(t instanceof k)St.warn(t.message);else{const e=le.create("idb-set",{originalErrorMessage:null==t?void 0:t.message});St.warn(e.message)}}}function be(t){return`${t.name}!${t.options.appId}`}class we{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new ke(e),this._heartbeatsCachePromise=this._storage.read().then((t=>(this._heartbeatsCache=t,t)))}async triggerHeartbeat(){var t,e;const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=xe();if((null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==i&&!this._heartbeatsCache.heartbeats.some((t=>t.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((t=>{const e=new Date(t.date).valueOf();return Date.now()-e<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var t;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const e=xe(),{heartbeatsToSend:n,unsentEntries:i}=function(t,e=1024){const n=[];let i=t.slice();for(const s of t){const t=n.find((t=>t.agent===s.agent));if(t){if(t.dates.push(s.date),Ce(n)>e){t.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ce(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}(this._heartbeatsCache.heartbeats),s=a(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function xe(){return(new Date).toISOString().substring(0,10)}class ke{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!w()&&x().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const t=await async function(t){try{const e=(await ye()).transaction(me),n=await e.objectStore(me).get(be(t));return await e.done,n}catch(t){if(t instanceof k)St.warn(t.message);else{const e=le.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});St.warn(e.message)}}}(this.app);return(null==t?void 0:t.heartbeats)?t:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return ve(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:t.heartbeats})}}async add(t){var e;if(await this._canUseIndexedDBPromise){const n=await this.read();return ve(this.app,{lastSentHeartbeatDate:null!==(e=t.lastSentHeartbeatDate)&&void 0!==e?e:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...t.heartbeats]})}}}function Ce(t){return a(JSON.stringify({version:2,heartbeats:t})).length}re(new G("platform-logger",(t=>new Ct(t)),"PRIVATE")),re(new G("heartbeat",(t=>new we(t)),"PRIVATE")),pe(It,Tt,""),pe(It,Tt,"esm2017"),pe("fire-js",""),pe("firebase","10.12.5","app");const Ie="@firebase/installations",Te="0.6.8",Se=1e4,Ee=`w:${Te}`,Pe="FIS_v2",Me="https://firebaseinstallations.googleapis.com/v1",Re=36e5,Oe=new C("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function Ae(t){return t instanceof k&&t.code.includes("request-failed")}function De({projectId:t}){return`${Me}/projects/${t}/installations`}function Ne(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}async function Le(t,e){const n=(await e.json()).error;return Oe.create("request-failed",{requestName:t,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Fe({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}async function ze(t){const e=await t();return e.status>=500&&e.status<600?t():e}function je(t){return new Promise((e=>{setTimeout(e,t)}))}const Ve=/^[cdef][\w-]{21}$/,Ue="";function We(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const e=function(t){var e;return(e=t,btoa(String.fromCharCode(...e)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22)}(t);return Ve.test(e)?e:Ue}catch(t){return Ue}}function Be(t){return`${t.appName}!${t.appId}`}const He=new Map;function qe(t,e){const n=Be(t);$e(n,e),function(t,e){const n=(!Ke&&"BroadcastChannel"in self&&(Ke=new BroadcastChannel("[Firebase] FID Change"),Ke.onmessage=t=>{$e(t.data.key,t.data.fid)}),Ke);n&&n.postMessage({key:t,fid:e}),0===He.size&&Ke&&(Ke.close(),Ke=null)}(n,e)}function $e(t,e){const n=He.get(t);if(n)for(const t of n)t(e)}let Ke=null;const Ye="firebase-installations-database",Ge=1,Je="firebase-installations-store";let Xe=null;function Qe(){return Xe||(Xe=yt(Ye,Ge,{upgrade:(t,e)=>{0===e&&t.createObjectStore(Je)}})),Xe}async function Ze(t,e){const n=Be(t),i=(await Qe()).transaction(Je,"readwrite"),s=i.objectStore(Je),r=await s.get(n);return await s.put(e,n),await i.done,r&&r.fid===e.fid||qe(t,e.fid),e}async function tn(t){const e=Be(t),n=(await Qe()).transaction(Je,"readwrite");await n.objectStore(Je).delete(e),await n.done}async function en(t,e){const n=Be(t),i=(await Qe()).transaction(Je,"readwrite"),s=i.objectStore(Je),r=await s.get(n),o=e(r);return void 0===o?await s.delete(n):await s.put(o,n),await i.done,!o||r&&r.fid===o.fid||qe(t,o.fid),o}async function nn(t){let e;const n=await en(t.appConfig,(n=>{const i=function(t){return on(t||{fid:We(),registrationStatus:0})}(n),s=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(Oe.create("app-offline"))};const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=async function(t,e){try{const n=await async function({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const i=De(t),s=Fe(t),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={fid:n,authVersion:Pe,appId:t.appId,sdkVersion:Ee},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await ze((()=>fetch(i,a)));if(l.ok){const t=await l.json();return{fid:t.fid||n,registrationStatus:2,refreshToken:t.refreshToken,authToken:Ne(t.authToken)}}throw await Le("Create Installation",l)}(t,e);return Ze(t.appConfig,n)}catch(n){throw Ae(n)&&409===n.customData.serverCode?await tn(t.appConfig):await Ze(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}(t,n);return{installationEntry:n,registrationPromise:i}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:sn(t)}:{installationEntry:e}}(t,i);return e=s.registrationPromise,s.installationEntry}));return n.fid===Ue?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}async function sn(t){let e=await rn(t.appConfig);for(;1===e.registrationStatus;)await je(100),e=await rn(t.appConfig);if(0===e.registrationStatus){const{installationEntry:e,registrationPromise:n}=await nn(t);return n||e}return e}function rn(t){return en(t,(t=>{if(!t)throw Oe.create("installation-not-found");return on(t)}))}function on(t){return 1===(e=t).registrationStatus&&e.registrationTime+Se<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}async function an({appConfig:t,heartbeatServiceProvider:e},n){const i=function(t,{fid:e}){return`${De(t)}/${e}/authTokens:generate`}(t,n),s=function(t,{refreshToken:e}){const n=Fe(t);return n.append("Authorization",function(t){return`${Pe} ${t}`}(e)),n}(t,n),r=e.getImmediate({optional:!0});if(r){const t=await r.getHeartbeatsHeader();t&&s.append("x-firebase-client",t)}const o={installation:{sdkVersion:Ee,appId:t.appId}},a={method:"POST",headers:s,body:JSON.stringify(o)},l=await ze((()=>fetch(i,a)));if(l.ok)return Ne(await l.json());throw await Le("Generate Auth Token",l)}async function ln(t,e=!1){let n;const i=await en(t.appConfig,(i=>{if(!hn(i))throw Oe.create("not-registered");const s=i.authToken;if(!e&&(2===(r=s).requestStatus&&!function(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+Re}(r)))return i;var r;if(1===s.requestStatus)return n=async function(t,e){let n=await cn(t.appConfig);for(;1===n.authToken.requestStatus;)await je(100),n=await cn(t.appConfig);const i=n.authToken;return 0===i.requestStatus?ln(t,e):i}(t,e),i;{if(!navigator.onLine)throw Oe.create("app-offline");const e=function(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}(i);return n=async function(t,e){try{const n=await an(t,e),i=Object.assign(Object.assign({},e),{authToken:n});return await Ze(t.appConfig,i),n}catch(n){if(!Ae(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Ze(t.appConfig,n)}else await tn(t.appConfig);throw n}}(t,e),e}}));return n?await n:i.authToken}function cn(t){return en(t,(t=>{if(!hn(t))throw Oe.create("not-registered");return 1===(e=t.authToken).requestStatus&&e.requestTime+Se<Date.now()?Object.assign(Object.assign({},t),{authToken:{requestStatus:0}}):t;var e}))}function hn(t){return void 0!==t&&2===t.registrationStatus}function un(t){return Oe.create("missing-app-config-values",{valueName:t})}const dn="installations";re(new G(dn,(t=>{const e=t.getProvider("app").getImmediate(),n=function(t){if(!t||!t.options)throw un("App Configuration");if(!t.name)throw un("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw un(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e);return{app:e,appConfig:n,heartbeatServiceProvider:oe(e,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),re(new G("installations-internal",(t=>{const e=oe(t.getProvider("app").getImmediate(),dn).getImmediate();return{getId:()=>async function(t){const e=t,{installationEntry:n,registrationPromise:i}=await nn(e);return i?i.catch(console.error):ln(e).catch(console.error),n.fid}(e),getToken:t=>async function(t,e=!1){const n=t;return await async function(t){const{registrationPromise:e}=await nn(t);e&&await e}(n),(await ln(n,e)).token}(e,t)}}),"PRIVATE")),pe(Ie,Te),pe(Ie,Te,"esm2017");const pn="analytics",fn="firebase_id",gn="origin",mn=6e4,_n="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",yn="https://www.googletagmanager.com/gtag/js",vn=new rt("@firebase/analytics"),bn=new C("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."});function wn(t){if(!t.startsWith(yn)){const e=bn.create("invalid-gtag-resource",{gtagURL:t});return vn.warn(e.message),""}return t}function xn(t){return Promise.all(t.map((t=>t.catch((t=>t)))))}const kn=30,Cn=new class{constructor(t={},e=1e3){this.throttleMetadata=t,this.intervalMillis=e}getThrottleMetadata(t){return this.throttleMetadata[t]}setThrottleMetadata(t,e){this.throttleMetadata[t]=e}deleteThrottleMetadata(t){delete this.throttleMetadata[t]}};function In(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function Tn(t,e=Cn,n){const{appId:i,apiKey:s,measurementId:r}=t.options;if(!i)throw bn.create("no-app-id");if(!s){if(r)return{measurementId:r,appId:i};throw bn.create("no-api-key")}const o=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new En;return setTimeout((async()=>{a.abort()}),void 0!==n?n:mn),Sn({appId:i,apiKey:s,measurementId:r},o,a,e)}async function Sn(t,{throttleEndTimeMillis:e,backoffCount:n},i,s=Cn){var r;const{appId:o,measurementId:a}=t;try{await function(t,e){return new Promise(((n,i)=>{const s=Math.max(e-Date.now(),0),r=setTimeout(n,s);t.addEventListener((()=>{clearTimeout(r),i(bn.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}(i,e)}catch(t){if(a)return vn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==t?void 0:t.message}]`),{appId:o,measurementId:a};throw t}try{const e=await async function(t){var e;const{appId:n,apiKey:i}=t,s={method:"GET",headers:In(i)},r=_n.replace("{app-id}",n),o=await fetch(r,s);if(200!==o.status&&304!==o.status){let t="";try{const n=await o.json();(null===(e=n.error)||void 0===e?void 0:e.message)&&(t=n.error.message)}catch(t){}throw bn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:t})}return o.json()}(t);return s.deleteThrottleMetadata(o),e}catch(e){const l=e;if(!function(t){if(!(t instanceof k&&t.customData))return!1;const e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(l)){if(s.deleteThrottleMetadata(o),a)return vn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${null==l?void 0:l.message}]`),{appId:o,measurementId:a};throw e}const c=503===Number(null===(r=null==l?void 0:l.customData)||void 0===r?void 0:r.httpStatus)?K(n,s.intervalMillis,kn):K(n,s.intervalMillis),h={throttleEndTimeMillis:Date.now()+c,backoffCount:n+1};return s.setThrottleMetadata(o,h),vn.debug(`Calling attemptFetch again in ${c} millis`),Sn(t,h,i,s)}}class En{constructor(){this.listeners=[]}addEventListener(t){this.listeners.push(t)}abort(){this.listeners.forEach((t=>t()))}}let Pn,Mn;async function Rn(t,e,n,i,s,r,o){var a;const l=Tn(t);l.then((e=>{n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&vn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${e.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((t=>vn.error(t))),e.push(l);const c=async function(){if(!w())return vn.warn(bn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await x()}catch(t){return vn.warn(bn.create("indexeddb-unavailable",{errorInfo:null==t?void 0:t.toString()}).message),!1}return!0}().then((t=>t?i.getId():void 0)),[h,u]=await Promise.all([l,c]);(function(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(yn)&&n.src.includes(t))return n;return null})(r)||function(t,e){const n=function(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy("firebase-js-sdk-policy",e)),n}(0,{createScriptURL:wn}),i=document.createElement("script"),s=`${yn}?l=${t}&id=${e}`;i.src=n?null==n?void 0:n.createScriptURL(s):s,i.async=!0,document.head.appendChild(i)}(r,h.measurementId),Mn&&(s("consent","default",Mn),Mn=void 0),s("js",new Date);const d=null!==(a=null==o?void 0:o.config)&&void 0!==a?a:{};return d[gn]="firebase",d.update=!0,null!=u&&(d[fn]=u),s("config",h.measurementId,d),Pn&&(s("set",Pn),Pn=void 0),h.measurementId}class On{constructor(t){this.app=t}_delete(){return delete An[this.app.options.appId],Promise.resolve()}}let An={},Dn=[];const Nn={};let Ln,Fn,zn="dataLayer",jn=!1;function Vn(t,e,n){!function(){const t=[];if(v()&&t.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||t.push("Cookies are not available."),t.length>0){const e=t.map(((t,e)=>`(${e+1}) ${t}`)).join(" "),n=bn.create("invalid-analytics-context",{errorInfo:e});vn.warn(n.message)}}();const i=t.options.appId;if(!i)throw bn.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw bn.create("no-api-key");vn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=An[i])throw bn.create("already-exists",{id:i});if(!jn){!function(t){let e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(zn);const{wrappedGtag:t,gtagCore:e}=function(t,e,n,i,s){let r=function(...t){window[i].push(arguments)};return window[s]&&"function"==typeof window[s]&&(r=window[s]),window[s]=function(t,e,n,i){return async function(s,...r){try{if("event"===s){const[i,s]=r;await async function(t,e,n,i,s){try{let r=[];if(s&&s.send_to){let t=s.send_to;Array.isArray(t)||(t=[t]);const i=await xn(n);for(const n of t){const t=i.find((t=>t.measurementId===n)),s=t&&e[t.appId];if(!s){r=[];break}r.push(s)}}0===r.length&&(r=Object.values(e)),await Promise.all(r),t("event",i,s||{})}catch(t){vn.error(t)}}(t,e,n,i,s)}else if("config"===s){const[s,o]=r;await async function(t,e,n,i,s,r){const o=i[s];try{if(o)await e[o];else{const t=(await xn(n)).find((t=>t.measurementId===s));t&&await e[t.appId]}}catch(t){vn.error(t)}t("config",s,r)}(t,e,n,i,s,o)}else if("consent"===s){const[e,n]=r;t("consent",e,n)}else if("get"===s){const[e,n,i]=r;t("get",e,n,i)}else if("set"===s){const[e]=r;t("set",e)}else t(s,...r)}catch(t){vn.error(t)}}}(r,t,e,n),{gtagCore:r,wrappedGtag:window[s]}}(An,Dn,Nn,zn,"gtag");Fn=t,Ln=e,jn=!0}return An[i]=Rn(t,Dn,Nn,e,Ln,zn,n),new On(t)}const Un="@firebase/analytics",Wn="0.10.7";function Bn(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(i=Object.getOwnPropertySymbols(t);s<i.length;s++)e.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(t,i[s])&&(n[i[s]]=t[i[s]])}return n}re(new G(pn,((t,{options:e})=>Vn(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),e)),"PUBLIC")),re(new G("analytics-internal",(function(t){try{const e=t.getProvider(pn).getImmediate();return{logEvent:(t,n,i)=>function(t,e,n,i){t=Y(t),async function(t,e,n,i,s){if(s&&s.global)t("event",n,i);else{const s=await e;t("event",n,Object.assign(Object.assign({},i),{send_to:s}))}}(Fn,An[t.app.options.appId],e,n,i).catch((t=>vn.error(t)))}(e,t,n,i)}}catch(t){throw bn.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),pe(Un,Wn),pe(Un,Wn,"esm2017"),Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Hn=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},qn=new C("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),$n=new rt("@firebase/auth");function Kn(t,...e){$n.logLevel<=tt.ERROR&&$n.error(`Auth (${he}): ${t}`,...e)}function Yn(t,...e){throw Qn(t,...e)}function Gn(t,...e){return Qn(t,...e)}function Jn(t,e,n){const i=Object.assign(Object.assign({},Hn()),{[e]:n});return new C("auth","Firebase",i).create(e,{appName:t.name})}function Xn(t){return Jn(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Qn(t,...e){if("string"!=typeof t){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return qn.create(t,...e)}function Zn(t,e,...n){if(!t)throw Qn(e,...n)}function ti(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Kn(e),new Error(e)}function ei(t,e){t||ti(e)}function ni(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.href)||""}function ii(){var t;return"undefined"!=typeof self&&(null===(t=self.location)||void 0===t?void 0:t.protocol)||null}class si{constructor(t,e){this.shortDelay=t,this.longDelay=e,ei(e>t,"Short delay should be less than long delay!"),this.isMobile=y()||b()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===ii()||"https:"===ii()||v()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function ri(t,e){ei(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class oi{static initialize(t,e,n){this.fetchImpl=t,e&&(this.headersImpl=e),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void ti("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void ti("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void ti("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ai={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},li=new si(3e4,6e4);function ci(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function hi(t,e,n,i,s={}){return ui(t,s,(async()=>{let s={},r={};i&&("GET"===e?r=i:s={body:JSON.stringify(i)});const o=N(Object.assign({key:t.config.apiKey},r)).slice(1),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode),oi.fetch()(pi(t,t.config.apiHost,n,o),Object.assign({method:e,headers:a,referrerPolicy:"no-referrer"},s))}))}async function ui(t,e,n){t._canInitEmulator=!1;const i=Object.assign(Object.assign({},ai),e);try{const e=new gi(t),s=await Promise.race([n(),e.promise]);e.clearNetworkTimeout();const r=await s.json();if("needConfirmation"in r)throw mi(t,"account-exists-with-different-credential",r);if(s.ok&&!("errorMessage"in r))return r;{const e=s.ok?r.errorMessage:r.error.message,[n,o]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw mi(t,"credential-already-in-use",r);if("EMAIL_EXISTS"===n)throw mi(t,"email-already-in-use",r);if("USER_DISABLED"===n)throw mi(t,"user-disabled",r);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Jn(t,a,o);Yn(t,a)}}catch(e){if(e instanceof k)throw e;Yn(t,"network-request-failed",{message:String(e)})}}async function di(t,e,n,i,s={}){const r=await hi(t,e,n,i,s);return"mfaPendingCredential"in r&&Yn(t,"multi-factor-auth-required",{_serverResponse:r}),r}function pi(t,e,n,i){const s=`${e}${n}?${i}`;return t.config.emulator?ri(t.config,s):`${t.config.apiScheme}://${s}`}function fi(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class gi{constructor(t){this.auth=t,this.timer=null,this.promise=new Promise(((t,e)=>{this.timer=setTimeout((()=>e(Gn(this.auth,"network-request-failed"))),li.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function mi(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const s=Gn(t,e,i);return s.customData._tokenResponse=n,s}function _i(t){return void 0!==t&&void 0!==t.enterprise}class yi{constructor(t){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=t.recaptchaEnforcementState}getProviderEnforcementState(t){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const e of this.recaptchaEnforcementState)if(e.provider&&e.provider===t)return fi(e.enforcementState);return null}isProviderEnabled(t){return"ENFORCE"===this.getProviderEnforcementState(t)||"AUDIT"===this.getProviderEnforcementState(t)}}async function vi(t,e){return hi(t,"POST","/v1/accounts:lookup",e)}function bi(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch(t){}}function wi(t){return 1e3*Number(t)}function xi(t){const[e,n,i]=t.split(".");if(void 0===e||void 0===n||void 0===i)return Kn("JWT malformed, contained fewer than 3 sections"),null;try{const t=l(n);return t?JSON.parse(t):(Kn("Failed to decode base64 JWT payload"),null)}catch(t){return Kn("Caught error parsing JWT payload as JSON",null==t?void 0:t.toString()),null}}function ki(t){const e=xi(t);return Zn(e,"internal-error"),Zn(void 0!==e.exp,"internal-error"),Zn(void 0!==e.iat,"internal-error"),Number(e.exp)-Number(e.iat)}async function Ci(t,e,n=!1){if(n)return e;try{return await e}catch(e){throw e instanceof k&&function({code:t}){return"auth/user-disabled"===t||"auth/user-token-expired"===t}(e)&&t.auth.currentUser===t&&await t.auth.signOut(),e}}class Ii{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(t){var e;if(t){const t=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),t}{this.errorBackoff=3e4;const t=(null!==(e=this.user.stsTokenManager.expirationTime)&&void 0!==e?e:0)-Date.now()-3e5;return Math.max(0,t)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout((async()=>{await this.iteration()}),e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null==t?void 0:t.code)&&this.schedule(!0))}this.schedule()}}class Ti{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=bi(this.lastLoginAt),this.creationTime=bi(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Si(t){var e;const n=t.auth,i=await t.getIdToken(),s=await Ci(t,vi(n,{idToken:i}));Zn(null==s?void 0:s.users.length,n,"internal-error");const r=s.users[0];t._notifyReloadListener(r);const o=(null===(e=r.providerUserInfo)||void 0===e?void 0:e.length)?Ei(r.providerUserInfo):[],a=(l=t.providerData,c=o,[...l.filter((t=>!c.some((e=>e.providerId===t.providerId)))),...c]);var l,c;const h=t.isAnonymous,u=!(t.email&&r.passwordHash||(null==a?void 0:a.length)),d=!!h&&u,p={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:a,metadata:new Ti(r.createdAt,r.lastLoginAt),isAnonymous:d};Object.assign(t,p)}function Ei(t){return t.map((t=>{var{providerId:e}=t,n=Bn(t,["providerId"]);return{providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class Pi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){Zn(t.idToken,"internal-error"),Zn(void 0!==t.idToken,"internal-error"),Zn(void 0!==t.refreshToken,"internal-error");const e="expiresIn"in t&&void 0!==t.expiresIn?Number(t.expiresIn):ki(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){Zn(0!==t.length,"internal-error");const e=ki(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return e||!this.accessToken||this.isExpired?(Zn(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(t,e){const n=await ui(t,{},(async()=>{const n=N({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,r=pi(t,i,"/v1/token",`key=${s}`),o=await t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",oi.fetch()(r,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(t,e);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(t,e,n){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(t,e){const{refreshToken:n,accessToken:i,expirationTime:s}=e,r=new Pi;return n&&(Zn("string"==typeof n,"internal-error",{appName:t}),r.refreshToken=n),i&&(Zn("string"==typeof i,"internal-error",{appName:t}),r.accessToken=i),s&&(Zn("number"==typeof s,"internal-error",{appName:t}),r.expirationTime=s),r}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new Pi,this.toJSON())}_performRefresh(){return ti("not implemented")}}function Mi(t,e){Zn("string"==typeof t||void 0===t,"internal-error",{appName:e})}class Ri{constructor(t){var{uid:e,auth:n,stsTokenManager:i}=t,s=Bn(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Ii(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ti(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await Ci(this,this.stsTokenManager.getToken(this.auth,t));return Zn(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return async function(t,e=!1){const n=Y(t),i=await n.getIdToken(e),s=xi(i);Zn(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const r="object"==typeof s.firebase?s.firebase:void 0,o=null==r?void 0:r.sign_in_provider;return{claims:s,token:i,authTime:bi(wi(s.auth_time)),issuedAtTime:bi(wi(s.iat)),expirationTime:bi(wi(s.exp)),signInProvider:o||null,signInSecondFactor:(null==r?void 0:r.sign_in_second_factor)||null}}(this,t)}reload(){return async function(t){const e=Y(t);await Si(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}(this)}_assign(t){this!==t&&(Zn(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map((t=>Object.assign({},t))),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new Ri(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return e.metadata._copy(this.metadata),e}_onReload(t){Zn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let n=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),n=!0),e&&await Si(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ae(this.auth.app))return Promise.reject(Xn(this.auth));const t=await this.getIdToken();return await Ci(this,async function(t,e){return hi(t,"POST","/v1/accounts:delete",e)}(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((t=>Object.assign({},t))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){var n,i,s,r,o,a,l,c;const h=null!==(n=e.displayName)&&void 0!==n?n:void 0,u=null!==(i=e.email)&&void 0!==i?i:void 0,d=null!==(s=e.phoneNumber)&&void 0!==s?s:void 0,p=null!==(r=e.photoURL)&&void 0!==r?r:void 0,f=null!==(o=e.tenantId)&&void 0!==o?o:void 0,g=null!==(a=e._redirectEventId)&&void 0!==a?a:void 0,m=null!==(l=e.createdAt)&&void 0!==l?l:void 0,_=null!==(c=e.lastLoginAt)&&void 0!==c?c:void 0,{uid:y,emailVerified:v,isAnonymous:b,providerData:w,stsTokenManager:x}=e;Zn(y&&x,t,"internal-error");const k=Pi.fromJSON(this.name,x);Zn("string"==typeof y,t,"internal-error"),Mi(h,t.name),Mi(u,t.name),Zn("boolean"==typeof v,t,"internal-error"),Zn("boolean"==typeof b,t,"internal-error"),Mi(d,t.name),Mi(p,t.name),Mi(f,t.name),Mi(g,t.name),Mi(m,t.name),Mi(_,t.name);const C=new Ri({uid:y,auth:t,email:u,emailVerified:v,displayName:h,isAnonymous:b,photoURL:p,phoneNumber:d,tenantId:f,stsTokenManager:k,createdAt:m,lastLoginAt:_});return w&&Array.isArray(w)&&(C.providerData=w.map((t=>Object.assign({},t)))),g&&(C._redirectEventId=g),C}static async _fromIdTokenResponse(t,e,n=!1){const i=new Pi;i.updateFromServerResponse(e);const s=new Ri({uid:e.localId,auth:t,stsTokenManager:i,isAnonymous:n});return await Si(s),s}static async _fromGetAccountInfoResponse(t,e,n){const i=e.users[0];Zn(void 0!==i.localId,"internal-error");const s=void 0!==i.providerUserInfo?Ei(i.providerUserInfo):[],r=!(i.email&&i.passwordHash||(null==s?void 0:s.length)),o=new Pi;o.updateFromIdToken(n);const a=new Ri({uid:i.localId,auth:t,stsTokenManager:o,isAnonymous:r}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ti(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash||(null==s?void 0:s.length))};return Object.assign(a,l),a}}const Oi=new Map;function Ai(t){ei(t instanceof Function,"Expected a class definition");let e=Oi.get(t);return e?(ei(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Oi.set(t,e),e)}class Di{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return void 0===e?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}Di.type="NONE";const Ni=Di;function Li(t,e,n){return`firebase:${t}:${e}:${n}`}class Fi{constructor(t,e,n){this.persistence=t,this.auth=e,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=Li(this.userKey,i.apiKey,s),this.fullPersistenceKey=Li("persistence",i.apiKey,s),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);return t?Ri._fromJSON(this.auth,t):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=t,e?this.setCurrentUser(e):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,n="authUser"){if(!e.length)return new Fi(Ai(Ni),t,n);const i=(await Promise.all(e.map((async t=>{if(await t._isAvailable())return t})))).filter((t=>t));let s=i[0]||Ai(Ni);const r=Li(n,t.config.apiKey,t.name);let o=null;for(const n of e)try{const e=await n._get(r);if(e){const i=Ri._fromJSON(t,e);n!==s&&(o=i),s=n;break}}catch(t){}const a=i.filter((t=>t._shouldAllowMigration));return s._shouldAllowMigration&&a.length?(s=a[0],o&&await s._set(r,o.toJSON()),await Promise.all(e.map((async t=>{if(t!==s)try{await t._remove(r)}catch(t){}}))),new Fi(s,t,n)):new Fi(s,t,n)}}function zi(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Wi(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(ji(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Hi(e))return"Blackberry";if(qi(e))return"Webos";if(Vi(e))return"Safari";if((e.includes("chrome/")||Ui(e))&&!e.includes("edge/"))return"Chrome";if(Bi(e))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(e);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function ji(t=_()){return/firefox\//i.test(t)}function Vi(t=_()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Ui(t=_()){return/crios\//i.test(t)}function Wi(t=_()){return/iemobile/i.test(t)}function Bi(t=_()){return/android/i.test(t)}function Hi(t=_()){return/blackberry/i.test(t)}function qi(t=_()){return/webos/i.test(t)}function $i(t=_()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Ki(t=_()){return $i(t)||Bi(t)||qi(t)||Hi(t)||/windows phone/i.test(t)||Wi(t)}function Yi(t,e=[]){let n;switch(t){case"Browser":n=zi(_());break;case"Worker":n=`${zi(_())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${he}/${i}`}class Gi{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const n=e=>new Promise(((n,i)=>{try{n(t(e))}catch(t){i(t)}}));n.onAbort=e,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const n of this.queue)await n(t),n.onAbort&&e.push(n.onAbort)}catch(t){e.reverse();for(const t of e)try{t()}catch(t){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==t?void 0:t.message})}}}class Ji{constructor(t){var e,n,i,s;const r=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(e=r.minPasswordLength)&&void 0!==e?e:6,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),void 0!==r.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),void 0!==r.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),void 0!==r.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),void 0!==r.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=t.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(s=t.forceUpgradeOnSignin)&&void 0!==s&&s,this.schemaVersion=t.schemaVersion}validatePassword(t){var e,n,i,s,r,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,a),this.validatePasswordCharacterOptions(t,a),a.isValid&&(a.isValid=null===(e=a.meetsMinPasswordLength)||void 0===e||e),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsUppercaseLetter)||void 0===s||s),a.isValid&&(a.isValid=null===(r=a.containsNumericCharacter)||void 0===r||r),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(t,e){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(e.meetsMinPasswordLength=t.length>=n),i&&(e.meetsMaxPasswordLength=t.length<=i)}validatePasswordCharacterOptions(t,e){let n;this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);for(let i=0;i<t.length;i++)n=t.charAt(i),this.updatePasswordCharacterOptionsStatuses(e,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(t,e,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=s))}}class Xi{constructor(t,e,n,i){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Zi(this),this.idTokenSubscription=new Zi(this),this.beforeStateQueue=new Gi(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=qn,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=Ai(e)),this._initializationPromise=this.queue((async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Fi.create(this,t),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(t){}await this.initializeCurrentUser(e),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();return this.currentUser||t?this.currentUser&&t&&this.currentUser.uid===t.uid?(this._currentUser._assign(t),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(t,!0):void 0}async initializeCurrentUserFromIdToken(t){try{const e=await vi(this,{idToken:t}),n=await Ri._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){var e;if(ae(this.app)){const t=this.app.settings.authIdToken;return t?new Promise((e=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(t).then(e,e)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(e=this.redirectUser)||void 0===e?void 0:e._redirectEventId,r=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(t);n&&n!==r||!(null==o?void 0:o.user)||(i=o.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(t){i=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(t)))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Zn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch(t){await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await Si(t)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(ae(this.app))return Promise.reject(Xn(this));const e=t?Y(t):null;return e&&Zn(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&Zn(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue((async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()}))}async signOut(){return ae(this.app)?Promise.reject(Xn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return ae(this.app)?Promise.reject(Xn(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(Ai(t))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await async function(t,e={}){return hi(t,"GET","/v2/passwordPolicy",ci(t,e))}(this),e=new Ji(t);null===this.tenantId?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new C("auth","Firebase",t())}onAuthStateChanged(t,e,n){return this.registerStateListener(this.authStateSubscription,t,e,n)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,n){return this.registerStateListener(this.idTokenSubscription,t,e,n)}authStateReady(){return new Promise(((t,e)=>{if(this.currentUser)t();else{const n=this.onAuthStateChanged((()=>{n(),t()}),e)}}))}async revokeAccessToken(t){if(this.currentUser){const e={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(e.tenantId=this.tenantId),await async function(t,e){return hi(t,"POST","/v2/accounts:revokeToken",ci(t,e))}(this,e)}}toJSON(){var t;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(t=this._currentUser)||void 0===t?void 0:t.toJSON()}}async _setRedirectUser(t,e){const n=await this.getOrInitRedirectPersistenceManager(e);return null===t?n.removeCurrentUser():n.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&Ai(t)||this._popupRedirectResolver;Zn(e,this,"argument-error"),this.redirectPersistenceManager=await Fi.create(this,[Ai(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){var e,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(e=this._currentUser)||void 0===e?void 0:e._redirectEventId)===t?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(t)))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var t,e;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,n,i){if(this._deleted)return()=>{};const s="function"==typeof e?e:e.next.bind(e);let r=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Zn(o,this,"internal-error"),o.then((()=>{r||s(this.currentUser)})),"function"==typeof e){const s=t.addObserver(e,n,i);return()=>{r=!0,s()}}{const n=t.addObserver(e);return()=>{r=!0,n()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return Zn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){t&&!this.frameworks.includes(t)&&(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=Yi(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var t;const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader());n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){var t;const e=await(null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken());return(null==e?void 0:e.error)&&function(t,...e){$n.logLevel<=tt.WARN&&$n.warn(`Auth (${he}): ${t}`,...e)}(`Error while retrieving App Check token: ${e.error}`),null==e?void 0:e.token}}function Qi(t){return Y(t)}class Zi{constructor(t){this.auth=t,this.observer=null,this.addObserver=function(t){const e=new j(t,void 0);return e.subscribe.bind(e)}((t=>this.observer=t))}get next(){return Zn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ts={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function es(t){return ts.loadJS(t)}function ns(t){return`__${t}${Math.floor(1e6*Math.random())}`}class is{constructor(t){this.type="recaptcha-enterprise",this.auth=Qi(t)}async verify(t="verify",e=!1){function n(e,n,i){const s=window.grecaptcha;_i(s)?s.enterprise.ready((()=>{s.enterprise.execute(e,{action:t}).then((t=>{n(t)})).catch((()=>{n("NO_RECAPTCHA")}))})):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((t,i)=>{(async function(t){if(!e){if(null==t.tenantId&&null!=t._agentRecaptchaConfig)return t._agentRecaptchaConfig.siteKey;if(null!=t.tenantId&&void 0!==t._tenantRecaptchaConfigs[t.tenantId])return t._tenantRecaptchaConfigs[t.tenantId].siteKey}return new Promise((async(e,n)=>{(async function(t,e){return hi(t,"GET","/v2/recaptchaConfig",ci(t,e))})(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((i=>{if(void 0!==i.recaptchaKey){const n=new yi(i);return null==t.tenantId?t._agentRecaptchaConfig=n:t._tenantRecaptchaConfigs[t.tenantId]=n,e(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((t=>{n(t)}))}))})(this.auth).then((s=>{if(!e&&_i(window.grecaptcha))n(s,t,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let e=ts.recaptchaEnterpriseScript;0!==e.length&&(e+=s),es(e).then((()=>{n(s,t,i)})).catch((t=>{i(t)}))}})).catch((t=>{i(t)}))}))}}async function ss(t,e,n,i=!1){const s=new is(t);let r;try{r=await s.verify(n)}catch(t){r=await s.verify(n,!0)}const o=Object.assign({},e);return i?Object.assign(o,{captchaResp:r}):Object.assign(o,{captchaResponse:r}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function rs(t,e,n,i){var s;if(null===(s=t._getRecaptchaConfig())||void 0===s?void 0:s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await ss(t,e,n,"getOobCode"===n);return i(t,s)}return i(t,e).catch((async s=>{if("auth/missing-recaptcha-token"===s.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await ss(t,e,n,"getOobCode"===n);return i(t,s)}return Promise.reject(s)}))}function os(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function as(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}class ls{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return ti("not implemented")}_getIdTokenResponse(t){return ti("not implemented")}_linkToIdToken(t,e){return ti("not implemented")}_getReauthenticationResolver(t){return ti("not implemented")}}async function cs(t,e){return hi(t,"POST","/v1/accounts:signUp",e)}async function hs(t,e){return di(t,"POST","/v1/accounts:signInWithPassword",ci(t,e))}class us extends ls{constructor(t,e,n,i=null){super("password",n),this._email=t,this._password=e,this._tenantId=i}static _fromEmailAndPassword(t,e){return new us(t,e,"password")}static _fromEmailAndCode(t,e,n=null){return new us(t,e,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t;if((null==e?void 0:e.email)&&(null==e?void 0:e.password)){if("password"===e.signInMethod)return this._fromEmailAndPassword(e.email,e.password);if("emailLink"===e.signInMethod)return this._fromEmailAndCode(e.email,e.password,e.tenantId)}return null}async _getIdTokenResponse(t){switch(this.signInMethod){case"password":return rs(t,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",hs);case"emailLink":return async function(t,e){return di(t,"POST","/v1/accounts:signInWithEmailLink",ci(t,e))}(t,{email:this._email,oobCode:this._password});default:Yn(t,"internal-error")}}async _linkToIdToken(t,e){switch(this.signInMethod){case"password":return rs(t,{idToken:e,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",cs);case"emailLink":return async function(t,e){return di(t,"POST","/v1/accounts:signInWithEmailLink",ci(t,e))}(t,{idToken:e,email:this._email,oobCode:this._password});default:Yn(t,"internal-error")}}_getReauthenticationResolver(t){return this._getIdTokenResponse(t)}}async function ds(t,e){return di(t,"POST","/v1/accounts:signInWithIdp",ci(t,e))}class ps extends ls{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new ps(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Yn("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e="string"==typeof t?JSON.parse(t):t,{providerId:n,signInMethod:i}=e,s=Bn(e,["providerId","signInMethod"]);if(!n||!i)return null;const r=new ps(n,i);return r.idToken=s.idToken||void 0,r.accessToken=s.accessToken||void 0,r.secret=s.secret,r.nonce=s.nonce,r.pendingToken=s.pendingToken||null,r}_getIdTokenResponse(t){return ds(t,this.buildRequest())}_linkToIdToken(t,e){const n=this.buildRequest();return n.idToken=e,ds(t,n)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,ds(t,e)}buildRequest(){const t={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=N(e)}return t}}const fs={USER_NOT_FOUND:"user-not-found"};class gs extends ls{constructor(t){super("phone","phone"),this.params=t}static _fromVerification(t,e){return new gs({verificationId:t,verificationCode:e})}static _fromTokenResponse(t,e){return new gs({phoneNumber:t,temporaryProof:e})}_getIdTokenResponse(t){return async function(t,e){return di(t,"POST","/v1/accounts:signInWithPhoneNumber",ci(t,e))}(t,this._makeVerificationRequest())}_linkToIdToken(t,e){return async function(t,e){const n=await di(t,"POST","/v1/accounts:signInWithPhoneNumber",ci(t,e));if(n.temporaryProof)throw mi(t,"account-exists-with-different-credential",n);return n}(t,Object.assign({idToken:e},this._makeVerificationRequest()))}_getReauthenticationResolver(t){return async function(t,e){return di(t,"POST","/v1/accounts:signInWithPhoneNumber",ci(t,Object.assign(Object.assign({},e),{operation:"REAUTH"})),fs)}(t,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:t,phoneNumber:e,verificationId:n,verificationCode:i}=this.params;return t&&e?{temporaryProof:t,phoneNumber:e}:{sessionInfo:n,code:i}}toJSON(){const t={providerId:this.providerId};return this.params.phoneNumber&&(t.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(t.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(t.verificationCode=this.params.verificationCode),this.params.verificationId&&(t.verificationId=this.params.verificationId),t}static fromJSON(t){"string"==typeof t&&(t=JSON.parse(t));const{verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:s}=t;return n||e||i||s?new gs({verificationId:e,verificationCode:n,phoneNumber:i,temporaryProof:s}):null}}class ms{constructor(t){var e,n,i,s,r,o;const a=L(F(t)),l=null!==(e=a.apiKey)&&void 0!==e?e:null,c=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=a.mode)&&void 0!==i?i:null);Zn(l&&c&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=c,this.continueUrl=null!==(s=a.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(r=a.languageCode)&&void 0!==r?r:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(t){const e=function(t){const e=L(F(t)).link,n=e?L(F(e)).deep_link_id:null,i=L(F(t)).deep_link_id;return(i?L(F(i)).link:null)||i||n||e||t}(t);try{return new ms(e)}catch(t){return null}}}class _s{constructor(){this.providerId=_s.PROVIDER_ID}static credential(t,e){return us._fromEmailAndPassword(t,e)}static credentialWithLink(t,e){const n=ms.parseLink(e);return Zn(n,"argument-error"),us._fromEmailAndCode(t,n.code,n.tenantId)}}_s.PROVIDER_ID="password",_s.EMAIL_PASSWORD_SIGN_IN_METHOD="password",_s.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ys{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class vs extends ys{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class bs extends vs{constructor(){super("facebook.com")}static credential(t){return ps._fromParams({providerId:bs.PROVIDER_ID,signInMethod:bs.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return bs.credentialFromTaggedObject(t)}static credentialFromError(t){return bs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return bs.credential(t.oauthAccessToken)}catch(t){return null}}}bs.FACEBOOK_SIGN_IN_METHOD="facebook.com",bs.PROVIDER_ID="facebook.com";class ws extends vs{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return ps._fromParams({providerId:ws.PROVIDER_ID,signInMethod:ws.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return ws.credentialFromTaggedObject(t)}static credentialFromError(t){return ws.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:n}=t;if(!e&&!n)return null;try{return ws.credential(e,n)}catch(t){return null}}}ws.GOOGLE_SIGN_IN_METHOD="google.com",ws.PROVIDER_ID="google.com";class xs extends vs{constructor(){super("github.com")}static credential(t){return ps._fromParams({providerId:xs.PROVIDER_ID,signInMethod:xs.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return xs.credentialFromTaggedObject(t)}static credentialFromError(t){return xs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return xs.credential(t.oauthAccessToken)}catch(t){return null}}}xs.GITHUB_SIGN_IN_METHOD="github.com",xs.PROVIDER_ID="github.com";class ks extends vs{constructor(){super("twitter.com")}static credential(t,e){return ps._fromParams({providerId:ks.PROVIDER_ID,signInMethod:ks.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return ks.credentialFromTaggedObject(t)}static credentialFromError(t){return ks.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:n}=t;if(!e||!n)return null;try{return ks.credential(e,n)}catch(t){return null}}}ks.TWITTER_SIGN_IN_METHOD="twitter.com",ks.PROVIDER_ID="twitter.com";class Cs{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,n,i=!1){const s=await Ri._fromIdTokenResponse(t,n,i),r=Is(n);return new Cs({user:s,providerId:r,_tokenResponse:n,operationType:e})}static async _forOperation(t,e,n){await t._updateTokensIfNecessary(n,!0);const i=Is(n);return new Cs({user:t,providerId:i,_tokenResponse:n,operationType:e})}}function Is(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Ts extends k{constructor(t,e,n,i){var s;super(e.code,e.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Ts.prototype),this.customData={appName:t.name,tenantId:null!==(s=t.tenantId)&&void 0!==s?s:void 0,_serverResponse:e.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(t,e,n,i){return new Ts(t,e,n,i)}}function Ss(t,e,n,i){return("reauthenticate"===e?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Ts._fromErrorAndOperation(t,n,e,i);throw n}))}async function Es(t,e,n=!1){if(ae(t.app))return Promise.reject(Xn(t));const i="signIn",s=await Ss(t,i,e),r=await Cs._fromIdTokenResponse(t,i,s);return n||await t._updateCurrentUser(r.user),r}function Ps(t,e,n){return ae(t.app)?Promise.reject(Xn(t)):async function(t,e){return Es(Qi(t),e)}(Y(t),_s.credential(e,n)).catch((async e=>{throw"auth/password-does-not-meet-requirements"===e.code&&async function(t){const e=Qi(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}(t),e}))}new WeakMap;const Ms="__sak";class Rs{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(Ms,"1"),this.storage.removeItem(Ms),Promise.resolve(!0)):Promise.resolve(!1)}catch(t){return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}class Os extends Rs{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const t=_();return Vi(t)||$i(t)}()&&function(){try{return!(!window||window===window.top)}catch(t){return!1}}(),this.fallbackToPolling=Ki(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const n=this.storage.getItem(e),i=this.localCache[e];n!==i&&t(e,i,n)}}onStorageEvent(t,e=!1){if(!t.key)return void this.forAllChangedKeys(((t,e,n)=>{this.notifyListeners(t,n)}));const n=t.key;if(e?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(t.newValue!==i)null!==t.newValue?this.storage.setItem(n,t.newValue):this.storage.removeItem(n);else if(this.localCache[n]===t.newValue&&!e)return}const i=()=>{const t=this.storage.getItem(n);(e||this.localCache[n]!==t)&&this.notifyListeners(n,t)},s=this.storage.getItem(n);!function(){const t=_();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}()||10!==document.documentMode||s===t.newValue||t.newValue===t.oldValue?i():setTimeout(i,10)}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e?JSON.parse(e):e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((t,e,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}Os.type="LOCAL";const As=Os;class Ds extends Rs{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(t,e){}_removeListener(t,e){}}Ds.type="SESSION";const Ns=Ds;class Ls{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find((e=>e.isListeningto(t)));if(e)return e;const n=new Ls(t);return this.receivers.push(n),n}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:n,eventType:i,data:s}=e.data,r=this.handlersMap[i];if(!(null==r?void 0:r.size))return;e.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(r).map((async t=>t(e.origin,s))),a=await function(t){return Promise.all(t.map((async t=>{try{return{fulfilled:!0,value:await t}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);e.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(t,e){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),e&&0!==this.handlersMap[t].size||delete this.handlersMap[t],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Fs(t="",e=10){let n="";for(let t=0;t<e;t++)n+=Math.floor(10*Math.random());return t+n}Ls.receivers=[];class zs{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,r;return new Promise(((o,a)=>{const l=Fs("",20);i.port1.start();const c=setTimeout((()=>{a(new Error("unsupported_event"))}),n);r={messageChannel:i,onMessage(t){const e=t;if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(c),s=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(s),o(e.data.response);break;default:clearTimeout(c),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(r),i.port1.addEventListener("message",r.onMessage),this.target.postMessage({eventType:t,eventId:l,data:e},[i.port2])})).finally((()=>{r&&this.removeMessageHandler(r)}))}}function js(){return window}function Vs(){return void 0!==js().WorkerGlobalScope&&"function"==typeof js().importScripts}const Us="firebaseLocalStorageDb",Ws="firebaseLocalStorage",Bs="fbase_key";class Hs{constructor(t){this.request=t}toPromise(){return new Promise(((t,e)=>{this.request.addEventListener("success",(()=>{t(this.request.result)})),this.request.addEventListener("error",(()=>{e(this.request.error)}))}))}}function qs(t,e){return t.transaction([Ws],e?"readwrite":"readonly").objectStore(Ws)}function $s(){const t=indexedDB.open(Us,1);return new Promise(((e,n)=>{t.addEventListener("error",(()=>{n(t.error)})),t.addEventListener("upgradeneeded",(()=>{const e=t.result;try{e.createObjectStore(Ws,{keyPath:Bs})}catch(t){n(t)}})),t.addEventListener("success",(async()=>{const n=t.result;n.objectStoreNames.contains(Ws)?e(n):(n.close(),await function(){const t=indexedDB.deleteDatabase(Us);return new Hs(t).toPromise()}(),e(await $s()))}))}))}async function Ks(t,e,n){const i=qs(t,!0).put({[Bs]:e,value:n});return new Hs(i).toPromise()}function Ys(t,e){const n=qs(t,!0).delete(e);return new Hs(n).toPromise()}class Gs{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await $s()),this.db}async _withRetries(t){let e=0;for(;;)try{const e=await this._openDb();return await t(e)}catch(t){if(e++>3)throw t;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Vs()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ls._getInstance(Vs()?self:null),this.receiver._subscribe("keyChanged",(async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)}))),this.receiver._subscribe("ping",(async(t,e)=>["keyChanged"]))}async initializeSender(){var t,e;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new zs(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(t=n[0])||void 0===t?void 0:t.fulfilled)&&(null===(e=n[0])||void 0===e?void 0:e.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){var e;if(this.sender&&this.activeServiceWorker&&((null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await $s();return await Ks(t,Ms,"1"),await Ys(t,Ms),!0}catch(t){}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite((async()=>(await this._withRetries((n=>Ks(n,t,e))),this.localCache[t]=e,this.notifyServiceWorker(t))))}async _get(t){const e=await this._withRetries((e=>async function(t,e){const n=qs(t,!1).get(e),i=await new Hs(n).toPromise();return void 0===i?null:i.value}(e,t)));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite((async()=>(await this._withRetries((e=>Ys(e,t))),delete this.localCache[t],this.notifyServiceWorker(t))))}async _poll(){const t=await this._withRetries((t=>{const e=qs(t,!1).getAll();return new Hs(e).toPromise()}));if(!t)return[];if(0!==this.pendingWrites)return[];const e=[],n=new Set;if(0!==t.length)for(const{fbase_key:i,value:s}of t)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),e.push(i));for(const t of Object.keys(this.localCache))this.localCache[t]&&!n.has(t)&&(this.notifyListeners(t,null),e.push(t));return e}notifyListeners(t,e){this.localCache[t]=e;const n=this.listeners[t];if(n)for(const t of Array.from(n))t(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),0===this.listeners[t].size&&delete this.listeners[t]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Gs.type="LOCAL";const Js=Gs;ns("rcb"),new si(3e4,6e4);class Xs{constructor(t){this.providerId=Xs.PROVIDER_ID,this.auth=Qi(t)}verifyPhoneNumber(t,e){return async function(t,e,n){var i;const s=await n.verify();try{let r;if(Zn("string"==typeof s,t,"argument-error"),Zn("recaptcha"===n.type,t,"argument-error"),r="string"==typeof e?{phoneNumber:e}:e,"session"in r){const e=r.session;if("phoneNumber"in r){Zn("enroll"===e.type,t,"internal-error");const n=await function(t,e){return hi(t,"POST","/v2/accounts/mfaEnrollment:start",ci(t,e))}(t,{idToken:e.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,recaptchaToken:s}});return n.phoneSessionInfo.sessionInfo}{Zn("signin"===e.type,t,"internal-error");const n=(null===(i=r.multiFactorHint)||void 0===i?void 0:i.uid)||r.multiFactorUid;Zn(n,t,"missing-multi-factor-info");const o=await function(t,e){return hi(t,"POST","/v2/accounts/mfaSignIn:start",ci(t,e))}(t,{mfaPendingCredential:e.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:s}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:e}=await async function(t,e){return hi(t,"POST","/v1/accounts:sendVerificationCode",ci(t,e))}(t,{phoneNumber:r.phoneNumber,recaptchaToken:s});return e}}finally{n._reset()}}(this.auth,t,Y(e))}static credential(t,e){return gs._fromVerification(t,e)}static credentialFromResult(t){const e=t;return Xs.credentialFromTaggedObject(e)}static credentialFromError(t){return Xs.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{phoneNumber:e,temporaryProof:n}=t;return e&&n?gs._fromTokenResponse(e,n):null}}Xs.PROVIDER_ID="phone",Xs.PHONE_SIGN_IN_METHOD="phone";class Qs extends ls{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return ds(t,this._buildIdpRequest())}_linkToIdToken(t,e){return ds(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return ds(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function Zs(t){return Es(t.auth,new Qs(t),t.bypassAuthState)}function tr(t){const{auth:e,user:n}=t;return Zn(n,e,"internal-error"),async function(t,e,n=!1){const{auth:i}=t;if(ae(i.app))return Promise.reject(Xn(i));const s="reauthenticate";try{const r=await Ci(t,Ss(i,s,e,t),n);Zn(r.idToken,i,"internal-error");const o=xi(r.idToken);Zn(o,i,"internal-error");const{sub:a}=o;return Zn(t.uid===a,i,"user-mismatch"),Cs._forOperation(t,s,r)}catch(t){throw"auth/user-not-found"===(null==t?void 0:t.code)&&Yn(i,"user-mismatch"),t}}(n,new Qs(t),t.bypassAuthState)}async function er(t){const{auth:e,user:n}=t;return Zn(n,e,"internal-error"),async function(t,e,n=!1){const i=await Ci(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Cs._forOperation(t,"link",i)}(n,new Qs(t),t.bypassAuthState)}class nr{constructor(t,e,n,i,s=!1){this.auth=t,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise((async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(t){this.reject(t)}}))}async onAuthEvent(t){const{urlResponse:e,sessionId:n,postBody:i,tenantId:s,error:r,type:o}=t;if(r)return void this.reject(r);const a={auth:this.auth,requestUri:e,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(t){this.reject(t)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return Zs;case"linkViaPopup":case"linkViaRedirect":return er;case"reauthViaPopup":case"reauthViaRedirect":return tr;default:Yn(this.auth,"internal-error")}}resolve(t){ei(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){ei(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const ir=new si(2e3,1e4);class sr extends nr{constructor(t,e,n,i,s){super(t,e,i,s),this.provider=n,this.authWindow=null,this.pollId=null,sr.currentPopupAction&&sr.currentPopupAction.cancel(),sr.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return Zn(t,this.auth,"internal-error"),t}async onExecution(){ei(1===this.filter.length,"Popup operations only handle one event");const t=Fs();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((t=>{this.reject(t)})),this.resolver._isIframeWebStorageSupported(this.auth,(t=>{t||this.reject(Gn(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var t;return(null===(t=this.authWindow)||void 0===t?void 0:t.associatedEvent)||null}cancel(){this.reject(Gn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,sr.currentPopupAction=null}pollUserCancellation(){const t=()=>{var e,n;(null===(n=null===(e=this.authWindow)||void 0===e?void 0:e.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Gn(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(t,ir.get())};t()}}sr.currentPopupAction=null;const rr="pendingRedirect",or=new Map;class ar extends nr{constructor(t,e,n=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,n),this.eventId=null}async execute(){let t=or.get(this.auth._key());if(!t){try{const e=await async function(t,e){const n=function(t){return Li(rr,t.config.apiKey,t.name)}(e),i=function(t){return Ai(t._redirectPersistence)}(t);if(!await i._isAvailable())return!1;const s="true"===await i._get(n);return await i._remove(n),s}(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(e)}catch(e){t=()=>Promise.reject(e)}or.set(this.auth._key(),t)}return this.bypassAuthState||or.set(this.auth._key(),(()=>Promise.resolve(null))),t()}async onAuthEvent(t){if("signInViaRedirect"===t.type)return super.onAuthEvent(t);if("unknown"!==t.type){if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function lr(t,e){or.set(t._key(),e)}async function cr(t,e,n=!1){if(ae(t.app))return Promise.reject(Xn(t));const i=Qi(t),s=function(t,e){return e?Ai(e):(Zn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}(i,e),r=new ar(i,s,n),o=await r.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,e)),o}class hr{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(t,n)&&(e=!0,this.sendToConsumer(t,n),this.saveEventToCache(t))})),this.hasHandledPotentialRedirect||!function(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return dr(t);default:return!1}}(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){var n;if(t.error&&!dr(t)){const i=(null===(n=t.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";e.onError(Gn(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const n=null===e.eventId||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&n}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ur(t))}saveEventToCache(t){this.cachedEventUids.add(ur(t)),this.lastProcessedEventTime=Date.now()}}function ur(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter((t=>t)).join("-")}function dr({type:t,error:e}){return"unknown"===t&&"auth/no-auth-event"===(null==e?void 0:e.code)}const pr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fr=/^https?/;function gr(t){const e=ni(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const s=new URL(t);return""===s.hostname&&""===i?"chrome-extension:"===n&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===i}if(!fr.test(n))return!1;if(pr.test(t))return i===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const mr=new si(3e4,6e4);function _r(){const t=js().___jsl;if(null==t?void 0:t.H)for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let e=0;e<t.CP.length;e++)t.CP[e]=null}function yr(t){return new Promise(((e,n)=>{var i,s,r;function o(){_r(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{_r(),n(Gn(t,"network-request-failed"))},timeout:mr.get()})}if(null===(s=null===(i=js().gapi)||void 0===i?void 0:i.iframes)||void 0===s?void 0:s.Iframe)e(gapi.iframes.getContext());else{if(!(null===(r=js().gapi)||void 0===r?void 0:r.load)){const e=ns("iframefcb");return js()[e]=()=>{gapi.load?o():n(Gn(t,"network-request-failed"))},es(`${ts.gapiScript}?onload=${e}`).catch((t=>n(t)))}o()}})).catch((t=>{throw vr=null,t}))}let vr=null;const br=new si(5e3,15e3),wr="__/auth/iframe",xr="emulator/auth/iframe",kr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Cr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Ir(t){const e=t.config;Zn(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ri(e,xr):`https://${t.config.authDomain}/${wr}`,i={apiKey:e.apiKey,appName:t.name,v:he},s=Cr.get(t.config.apiHost);s&&(i.eid=s);const r=t._getFrameworks();return r.length&&(i.fw=r.join(",")),`${n}?${N(i).slice(1)}`}const Tr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Sr{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(t){}}}const Er=encodeURIComponent("fac");async function Pr(t,e,n,i,s,r){Zn(t.config.authDomain,t,"auth-domain-config-required"),Zn(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:he,eventId:s};if(e instanceof ys){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",R(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[t,e]of Object.entries(r||{}))o[t]=e}if(e instanceof vs){const t=e.getScopes().filter((t=>""!==t));t.length>0&&(o.scopes=t.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const t of Object.keys(a))void 0===a[t]&&delete a[t];const l=await t._getAppCheckToken(),c=l?`#${Er}=${encodeURIComponent(l)}`:"";return`${function({config:t}){return t.emulator?ri(t,"emulator/auth/handler"):`https://${t.authDomain}/__/auth/handler`}(t)}?${N(a).slice(1)}${c}`}const Mr="webStorageSupport",Rr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ns,this._completeRedirectFn=cr,this._overrideRedirectResult=lr}async _openPopup(t,e,n,i){var s;return ei(null===(s=this.eventManagers[t._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()"),function(t,e,n,i=500,s=600){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Tr),{width:i.toString(),height:s.toString(),top:r,left:o}),c=_().toLowerCase();n&&(a=Ui(c)?"_blank":n),ji(c)&&(e=e||"http://localhost",l.scrollbars="yes");const h=Object.entries(l).reduce(((t,[e,n])=>`${t}${e}=${n},`),"");if(function(t=_()){var e;return $i(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(c)&&"_self"!==a)return function(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}(e||"",a),new Sr(null);const u=window.open(e||"",a,h);Zn(u,t,"popup-blocked");try{u.focus()}catch(t){}return new Sr(u)}(t,await Pr(t,e,n,ni(),i),Fs())}async _openRedirect(t,e,n,i){return await this._originValidation(t),s=await Pr(t,e,n,ni(),i),js().location.href=s,new Promise((()=>{}));var s}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:t,promise:n}=this.eventManagers[e];return t?Promise.resolve(t):(ei(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(t);return this.eventManagers[e]={promise:n},n.catch((()=>{delete this.eventManagers[e]})),n}async initAndGetManager(t){const e=await async function(t){const e=await function(t){return vr=vr||yr(t),vr}(t),n=js().gapi;return Zn(n,t,"internal-error"),e.open({where:document.body,url:Ir(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:kr,dontclear:!0},(e=>new Promise((async(n,i)=>{await e.restyle({setHideOnLeave:!1});const s=Gn(t,"network-request-failed"),r=js().setTimeout((()=>{i(s)}),br.get());function o(){js().clearTimeout(r),n(e)}e.ping(o).then(o,(()=>{i(s)}))}))))}(t),n=new hr(t);return e.register("authEvent",(e=>(Zn(null==e?void 0:e.authEvent,t,"invalid-auth-event"),{status:n.onEvent(e.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:n},this.iframes[t._key()]=e,n}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Mr,{type:Mr},(n=>{var i;const s=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Mr];void 0!==s&&e(!!s),Yn(t,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=async function(t){if(t.config.emulator)return;const{authorizedDomains:e}=await async function(t,e={}){return hi(t,"GET","/v1/projects",e)}(t);for(const t of e)try{if(gr(t))return}catch(t){}Yn(t,"unauthorized-domain")}(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return Ki()||Vi()||$i()}};var Or="@firebase/auth",Ar="1.7.6";class Dr{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){var t;return this.assertAuthConfigured(),(null===(t=this.auth.currentUser)||void 0===t?void 0:t.uid)||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged((e=>{t((null==e?void 0:e.stsTokenManager.accessToken)||null)}));this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){Zn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Nr=g("authIdTokenMaxAge")||300;let Lr=null;const Fr=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>Nr)return;const s=null==n?void 0:n.token;Lr!==s&&(Lr=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function zr(t=de()){const e=oe(t,"auth");if(e.isInitialized())return e.getImmediate();const n=function(t,e){const n=oe(t,"auth");if(n.isInitialized()){const t=n.getImmediate();if(A(n.getOptions(),null!=e?e:{}))return t;Yn(t,"already-initialized")}return n.initialize({options:e})}(t,{popupRedirectResolver:Rr,persistence:[Js,As,Ns]}),i=g("authTokenSyncURL");if(i&&"boolean"==typeof isSecureContext&&isSecureContext){const t=new URL(i,location.origin);if(location.origin===t.origin){const e=Fr(t.toString());!function(t,e,n){Y(t).beforeAuthStateChanged(e,n)}(n,e,(()=>e(n.currentUser))),function(t){Y(t).onIdTokenChanged((t=>e(t)),void 0,void 0)}(n)}}const s=p("auth");return s&&function(t,e,n){const i=Qi(t);Zn(i._canInitEmulator,i,"emulator-config-failed"),Zn(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const s=!!(null==n?void 0:n.disableWarnings),r=os(e),{host:o,port:a}=function(t){const e=os(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const t=s[1];return{host:t,port:as(i.substr(t.length+1))}}{const[t,e]=i.split(":");return{host:t,port:as(e)}}}(e),l=null===a?"":`:${a}`;i.config.emulator={url:`${r}//${o}${l}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||function(){function t(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}()}(n,`http://${s}`),n}var jr,Vr;jr={loadJS:t=>new Promise(((e,n)=>{const i=document.createElement("script");var s,r;i.setAttribute("src",t),i.onload=e,i.onerror=t=>{const e=Gn("internal-error");e.customData=t,n(e)},i.type="text/javascript",i.charset="UTF-8",(null!==(r=null===(s=document.getElementsByTagName("head"))||void 0===s?void 0:s[0])&&void 0!==r?r:document).appendChild(i)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},ts=jr,Vr="Browser",re(new G("auth",((t,{options:e})=>{const n=t.getProvider("app").getImmediate(),i=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:r,authDomain:o}=n.options;Zn(r&&!r.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:r,authDomain:o,clientPlatform:Vr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Yi(Vr)},l=new Xi(n,i,s,a);return function(t,e){const n=(null==e?void 0:e.persistence)||[],i=(Array.isArray(n)?n:[n]).map(Ai);(null==e?void 0:e.errorMap)&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,null==e?void 0:e.popupRedirectResolver)}(l,e),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider("auth-internal").initialize()}))),re(new G("auth-internal",(t=>{return e=Qi(t.getProvider("auth").getImmediate()),new Dr(e);var e}),"PRIVATE").setInstantiationMode("EXPLICIT")),pe(Or,Ar,function(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Vr)),pe(Or,Ar,"esm2017");const Ur="@firebase/database",Wr="1.0.7";let Br="";class Hr{constructor(t){this.domStorage_=t,this.prefix_="firebase:"}set(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),S(e))}get(t){const e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:T(e)}remove(t){this.domStorage_.removeItem(this.prefixedName_(t))}prefixedName_(t){return this.prefix_+t}toString(){return this.domStorage_.toString()}}class qr{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e}get(t){return P(this.cache_,t)?this.cache_[t]:null}remove(t){delete this.cache_[t]}}const $r=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Hr(e)}}catch(t){}return new qr},Kr=$r("localStorage"),Yr=$r("sessionStorage"),Gr=new rt("@firebase/database"),Jr=function(){let t=1;return function(){return t++}}(),Xr=function(t){const n=function(t){const n=[];let i=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);if(r>=55296&&r<=56319){const n=r-55296;s++,e(s<t.length,"Surrogate pair missing trail surrogate."),r=65536+(n<<10)+(t.charCodeAt(s)-56320)}r<128?n[i++]=r:r<2048?(n[i++]=r>>6|192,n[i++]=63&r|128):r<65536?(n[i++]=r>>12|224,n[i++]=r>>6&63|128,n[i++]=63&r|128):(n[i++]=r>>18|240,n[i++]=r>>12&63|128,n[i++]=r>>6&63|128,n[i++]=63&r|128)}return n}(t),i=new z;i.update(n);const r=i.digest();return s.encodeByteArray(r)},Qr=function(...t){let e="";for(let n=0;n<t.length;n++){const i=t[n];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?e+=Qr.apply(null,i):e+="object"==typeof i?S(i):i,e+=" "}return e};let Zr=null,to=!0;const eo=function(...t){if(!0===to&&(to=!1,null===Zr&&!0===Yr.get("logging_enabled")&&(n=!0,e(!i||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(Gr.logLevel=tt.VERBOSE,Zr=Gr.log.bind(Gr),i&&Yr.set("logging_enabled",!0)):"function"==typeof n?Zr=n:(Zr=null,Yr.remove("logging_enabled")))),Zr){const e=Qr.apply(null,t);Zr(e)}var n,i},no=function(t){return function(...e){eo(t,...e)}},io=function(...t){const e="FIREBASE INTERNAL ERROR: "+Qr(...t);Gr.error(e)},so=function(...t){const e=`FIREBASE FATAL ERROR: ${Qr(...t)}`;throw Gr.error(e),new Error(e)},ro=function(...t){const e="FIREBASE WARNING: "+Qr(...t);Gr.warn(e)},oo=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},ao="[MIN_NAME]",lo="[MAX_NAME]",co=function(t,e){if(t===e)return 0;if(t===ao||e===lo)return-1;if(e===ao||t===lo)return 1;{const n=yo(t),i=yo(e);return null!==n?null!==i?n-i==0?t.length-e.length:n-i:-1:null!==i?1:t<e?-1:1}},ho=function(t,e){return t===e?0:t<e?-1:1},uo=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+S(e))},po=function(t){if("object"!=typeof t||null===t)return S(t);const e=[];for(const n in t)e.push(n);e.sort();let n="{";for(let i=0;i<e.length;i++)0!==i&&(n+=","),n+=S(e[i]),n+=":",n+=po(t[e[i]]);return n+="}",n},fo=function(t,e){const n=t.length;if(n<=e)return[t];const i=[];for(let s=0;s<n;s+=e)s+e>n?i.push(t.substring(s,n)):i.push(t.substring(s,s+e));return i};function go(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const mo=function(t){e(!oo(t),"Invalid JSON number");let n,i,s,r,o;0===t?(i=0,s=0,n=1/t==-1/0?1:0):(n=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(r=Math.min(Math.floor(Math.log(t)/Math.LN2),1023),i=r+1023,s=Math.round(t*Math.pow(2,52-r)-Math.pow(2,52))):(i=0,s=Math.round(t/Math.pow(2,-1074))));const a=[];for(o=52;o;o-=1)a.push(s%2?1:0),s=Math.floor(s/2);for(o=11;o;o-=1)a.push(i%2?1:0),i=Math.floor(i/2);a.push(n?1:0),a.reverse();const l=a.join("");let c="";for(o=0;o<64;o+=8){let t=parseInt(l.substr(o,8),2).toString(16);1===t.length&&(t="0"+t),c+=t}return c.toLowerCase()},_o=new RegExp("^-?(0*)\\d{1,10}$"),yo=function(t){if(_o.test(t)){const e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},vo=function(t){try{t()}catch(t){setTimeout((()=>{const e=t.stack||"";throw ro("Exception was thrown by user callback.",e),t}),Math.floor(0))}},bo=function(t,e){const n=setTimeout(t,e);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};class wo{constructor(t,e){this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then((t=>this.appCheck=t))}getToken(t){return this.appCheck?this.appCheck.getToken(t):new Promise(((e,n)=>{setTimeout((()=>{this.appCheck?this.getToken(t).then(e,n):e(null)}),0)}))}addTokenChangeListener(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((e=>e.addTokenListener(t)))}notifyForInvalidToken(){ro(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class xo{constructor(t,e,n){this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((t=>this.auth_=t))}getToken(t){return this.auth_?this.auth_.getToken(t).catch((t=>t&&"auth/token-not-initialized"===t.code?(eo("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t))):new Promise(((e,n)=>{setTimeout((()=>{this.auth_?this.getToken(t).then(e,n):e(null)}),0)}))}addTokenChangeListener(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((e=>e.addAuthTokenListener(t)))}removeTokenChangeListener(t){this.authProvider_.get().then((e=>e.removeAuthTokenListener(t)))}notifyForInvalidToken(){let t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ro(t)}}class ko{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}ko.OWNER="owner";const Co="5",Io=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,To="ac",So="websocket",Eo="long_polling";class Po{constructor(t,e,n,i,s=!1,r="",o=!1,a=!1){this.secure=e,this.namespace=n,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=r,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Kr.get("host:"+t)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&Kr.set("host:"+this._host,this.internalHost))}toString(){let t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t}toURLString(){const t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${t}${this.host}/${e}`}}function Mo(t,n,i){let s;if(e("string"==typeof n,"typeof type must == string"),e("object"==typeof i,"typeof params must == object"),n===So)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(n!==Eo)throw new Error("Unknown connection type: "+n);s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(i.ns=t.namespace);const r=[];return go(i,((t,e)=>{r.push(t+"="+e)})),s+r.join("&")}class Ro{constructor(){this.counters_={}}incrementCounter(t,e=1){P(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e}get(){return c(this.counters_)}}const Oo={},Ao={};function Do(t){const e=t.toString();return Oo[e]||(Oo[e]=new Ro),Oo[e]}class No{constructor(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(t,e){for(this.pendingResponses[t]=e;this.pendingResponses[this.currentResponseNum];){const t=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let e=0;e<t.length;++e)t[e]&&vo((()=>{this.onMessage_(t[e])}));if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const Lo="start";class Fo{constructor(t,e,n,i,s,r,o){this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.transportSessionId=r,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=no(t),this.stats_=Do(e),this.urlFn=t=>(this.appCheckToken&&(t[To]=this.appCheckToken),Mo(e,Eo,t))}open(t,e){this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new No(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if("complete"===document.readyState)t();else{let e=!1;const n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(()=>{"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((()=>{if(this.isClosed_)return;this.scriptTagHolder=new zo(((...t)=>{const[e,n,i,s,r]=t;if(this.incrementIncomingBytes_(t),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,e===Lo)this.id=n,this.password=i;else{if("close"!==e)throw new Error("Unrecognized command received: "+e);n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,(()=>{this.onClosed_()}))):this.onClosed_()}}),((...t)=>{const[e,n]=t;this.incrementIncomingBytes_(t),this.myPacketOrderer.handleResponse(e,n)}),(()=>{this.onClosed_()}),this.urlFn);const t={};t[Lo]="t",t.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=this.scriptTagHolder.uniqueCallbackIdentifier),t.v=Co,this.transportSessionId&&(t.s=this.transportSessionId),this.lastSessionId&&(t.ls=this.lastSessionId),this.applicationId&&(t.p=this.applicationId),this.appCheckToken&&(t[To]=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&Io.test(location.hostname)&&(t.r="f");const e=this.urlFn(t);this.log_("Connecting via long-poll to "+e),this.scriptTagHolder.addTag(e,(()=>{}))}))}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Fo.forceAllow_=!0}static forceDisallow(){Fo.forceDisallow_=!0}static isAvailable(){return!(!Fo.forceAllow_&&(Fo.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(t){const e=S(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=o(e),i=fo(n,1840);for(let t=0;t<i.length;t++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[t]),this.curSegmentNum++}addDisconnectPingFrame(t,e){this.myDisconnFrame=document.createElement("iframe");const n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(t){const e=S(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)}}class zo{constructor(t,e,n,i){this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=Jr(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=zo.createIFrame_();let n="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(n='<script>document.domain="'+document.domain+'";<\/script>');const i="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(i),this.myIFrame.doc.close()}catch(t){eo("frame writing exception"),t.stack&&eo(t.stack),eo(t)}}}static createIFrame_(){const t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||eo("No IE domain setting required")}catch(e){const n=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout((()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)}),Math.floor(0)));const t=this.onDisconnect;t&&(this.onDisconnect=null,t())}startLongPoll(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;let e=this.urlFn(t),n="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+n.length<=1870;){const t=this.pendingSegs.shift();n=n+"&seg"+i+"="+t.seg+"&ts"+i+"="+t.ts+"&d"+i+"="+t.d,i++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1}enqueueSegment(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(t,e){this.outstandingRequests.add(e);const n=()=>{this.outstandingRequests.delete(e),this.newRequest_()},i=setTimeout(n,Math.floor(25e3));this.addTag(t,(()=>{clearTimeout(i),n()}))}addTag(t,e){setTimeout((()=>{try{if(!this.sendNewPolls)return;const n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=t,n.onload=n.onreadystatechange=function(){const t=n.readyState;t&&"loaded"!==t&&"complete"!==t||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),e())},n.onerror=()=>{eo("Long-poll script failed to load: "+t),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(t){}}),Math.floor(1))}}let jo=null;"undefined"!=typeof MozWebSocket?jo=MozWebSocket:"undefined"!=typeof WebSocket&&(jo=WebSocket);class Vo{constructor(t,e,n,i,s,r,o){this.connId=t,this.applicationId=n,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=no(this.connId),this.stats_=Do(e),this.connURL=Vo.connectionURL_(e,r,o,i,n),this.nodeAdmin=e.nodeAdmin}static connectionURL_(t,e,n,i,s){const r={};return r.v=Co,"undefined"!=typeof location&&location.hostname&&Io.test(location.hostname)&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),i&&(r[To]=i),s&&(r.p=s),Mo(t,So,r)}open(t,e){this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Kr.set("previous_websocket_failure",!0);try{let t;0,this.mySock=new jo(this.connURL,[],t)}catch(t){this.log_("Error instantiating WebSocket.");const e=t.message||t.data;return e&&this.log_(e),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=t=>{this.handleIncomingFrame(t)},this.mySock.onerror=t=>{this.log_("WebSocket error.  Closing connection.");const e=t.message||t.data;e&&this.log_(e),this.onClosed_()}}start(){}static forceDisallow(){Vo.forceDisallow_=!0}static isAvailable(){let t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){const e=/Android ([0-9]{0,}\.[0-9]{0,})/,n=navigator.userAgent.match(e);n&&n.length>1&&parseFloat(n[1])<4.4&&(t=!0)}return!t&&null!==jo&&!Vo.forceDisallow_}static previouslyFailed(){return Kr.isInMemoryStorage||!0===Kr.get("previous_websocket_failure")}markConnectionHealthy(){Kr.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const t=this.frames.join("");this.frames=null;const e=T(t);this.onMessage(e)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(e(null===this.frames,"We already have a frame buffer"),t.length<=6){const e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{const t=this.extractFrameCount_(e);null!==t&&this.appendFrame_(t)}}send(t){this.resetKeepAlive();const e=S(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);const n=fo(e,16384);n.length>1&&this.sendString_(String(n.length));for(let t=0;t<n.length;t++)this.sendString_(n[t])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()}),Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Vo.responsesRequiredToBeHealthy=2,Vo.healthyTimeout=3e4;class Uo{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Fo,Vo]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const e=Vo&&Vo.isAvailable();let n=e&&!Vo.previouslyFailed();if(t.webSocketOnly&&(e||ro("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[Vo];else{const t=this.transports_=[];for(const e of Uo.ALL_TRANSPORTS)e&&e.isAvailable()&&t.push(e);Uo.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Uo.globalTransportInitialized_=!1;class Wo{constructor(t,e,n,i,s,r,o,a,l,c){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=r,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=no("c:"+this.id+":"),this.transportManager_=new Uo(e),this.log_("Connection created"),this.start_()}start_(){const t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((()=>{this.conn_&&this.conn_.open(e,n)}),Math.floor(0));const i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=bo((()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))}),Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(t){return e=>{t===this.conn_?this.onConnectionLost_(e):t===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(t){return e=>{2!==this.state_&&(t===this.rx_?this.onPrimaryMessageReceived_(e):t===this.secondaryConn_?this.onSecondaryMessageReceived_(e):this.log_("message on old connection"))}}sendRequest(t){const e={t:"d",d:t};this.sendData_(e)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(t){if("t"in t){const e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(t){const e=uo("t",t),n=uo("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(t){const e=uo("t",t),n=uo("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)}onDataMessage_(t){this.onPrimaryResponse_(),this.onMessage_(t)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(t){const e=uo("t",t);if("d"in t){const n=t.d;if("h"===e){const t=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(t.h=this.repoInfo_.host),this.onHandshake_(t)}else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let t=0;t<this.pendingDataMessages.length;++t)this.onDataMessage_(this.pendingDataMessages[t]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?io("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):io("Unknown control packet command: "+e)}}onHandshake_(t){const e=t.ts,n=t.v,i=t.h;this.sessionId=t.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),Co!==n&&ro("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)}startUpgrade_(t){this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;const e=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(e,n),bo((()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())}),Math.floor(6e4))}onReset_(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(t,e){this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):bo((()=>{this.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()}onConnectionLost_(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Kr.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class Bo{put(t,e,n,i){}merge(t,e,n,i){}refreshAuthToken(t){}refreshAppCheckToken(t){}onDisconnectPut(t,e,n){}onDisconnectMerge(t,e,n){}onDisconnectCancel(t,e){}reportStats(t){}}class Ho{constructor(t){this.allowedEvents_=t,this.listeners_={},e(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}trigger(t,...e){if(Array.isArray(this.listeners_[t])){const n=[...this.listeners_[t]];for(let t=0;t<n.length;t++)n[t].callback.apply(n[t].context,e)}}on(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});const i=this.getInitialEvent(t);i&&e.apply(n,i)}off(t,e,n){this.validateEventType_(t);const i=this.listeners_[t]||[];for(let t=0;t<i.length;t++)if(i[t].callback===e&&(!n||n===i[t].context))return void i.splice(t,1)}validateEventType_(t){e(this.allowedEvents_.find((e=>e===t)),"Unknown event: "+t)}}class qo extends Ho{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||y()||(window.addEventListener("online",(()=>{this.online_||(this.online_=!0,this.trigger("online",!0))}),!1),window.addEventListener("offline",(()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))}),!1))}static getInstance(){return new qo}getInitialEvent(t){return e("online"===t,"Unknown event type: "+t),[this.online_]}currentlyOnline(){return this.online_}}class $o{constructor(t,e){if(void 0===e){this.pieces_=t.split("/");let e=0;for(let t=0;t<this.pieces_.length;t++)this.pieces_[t].length>0&&(this.pieces_[e]=this.pieces_[t],e++);this.pieces_.length=e,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}toString(){let t="";for(let e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"}}function Ko(){return new $o("")}function Yo(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Go(t){return t.pieces_.length-t.pieceNum_}function Jo(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new $o(t.pieces_,e)}function Xo(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Qo(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function Zo(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new $o(e,0)}function ta(t,e){const n=[];for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);if(e instanceof $o)for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);else{const t=e.split("/");for(let e=0;e<t.length;e++)t[e].length>0&&n.push(t[e])}return new $o(n,0)}function ea(t){return t.pieceNum_>=t.pieces_.length}function na(t,e){const n=Yo(t),i=Yo(e);if(null===n)return e;if(n===i)return na(Jo(t),Jo(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function ia(t,e){if(Go(t)!==Go(e))return!1;for(let n=t.pieceNum_,i=e.pieceNum_;n<=t.pieces_.length;n++,i++)if(t.pieces_[n]!==e.pieces_[i])return!1;return!0}function sa(t,e){let n=t.pieceNum_,i=e.pieceNum_;if(Go(t)>Go(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[i])return!1;++n,++i}return!0}class ra{constructor(t,e){this.errorPrefix_=e,this.parts_=Qo(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(let t=0;t<this.parts_.length;t++)this.byteLength_+=W(this.parts_[t]);oa(this)}}function oa(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+aa(t))}function aa(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}class la extends Ho{constructor(){let t,e;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(e="visibilitychange",t="hidden"):void 0!==document.mozHidden?(e="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(e="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(e="webkitvisibilitychange",t="webkitHidden")),this.visible_=!0,e&&document.addEventListener(e,(()=>{const e=!document[t];e!==this.visible_&&(this.visible_=e,this.trigger("visible",e))}),!1)}static getInstance(){return new la}getInitialEvent(t){return e("visible"===t,"Unknown event type: "+t),[this.visible_]}}const ca=1e3;class ha extends Bo{constructor(t,e,n,i,s,r,o,a){if(super(),this.repoInfo_=t,this.applicationId_=e,this.onDataUpdate_=n,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=r,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=ha.nextPersistentConnectionId_++,this.log_=no("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=ca,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");la.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&qo.getInstance().on("online",this.onOnline_,this)}sendRequest(t,n,i){const s=++this.requestNumber_,r={r:s,a:t,b:n};this.log_(S(r)),e(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();const e=new m,n={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:t=>{const n=t.d;"ok"===t.s?e.resolve(n):e.reject(n)}};this.outstandingGets_.push(n),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(i),e.promise}listen(t,n,i,s){this.initConnection_();const r=t._queryIdentifier,o=t._path.toString();this.log_("Listen called for "+o+" "+r),this.listens.has(o)||this.listens.set(o,new Map),e(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),e(!this.listens.get(o).has(r),"listen() called twice for same path/queryId.");const a={onComplete:s,hashFn:n,query:t,tag:i};this.listens.get(o).set(r,a),this.connected_&&this.sendListen_(a)}sendGet_(t){const e=this.outstandingGets_[t];this.sendRequest("g",e.request,(n=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),e.onComplete&&e.onComplete(n)}))}sendListen_(t){const e=t.query,n=e._path.toString(),i=e._queryIdentifier;this.log_("Listen on "+n+" for "+i);const s={p:n};t.tag&&(s.q=e._queryObject,s.t=t.tag),s.h=t.hashFn(),this.sendRequest("q",s,(s=>{const r=s.d,o=s.s;ha.warnOnListenWarnings_(r,e),(this.listens.get(n)&&this.listens.get(n).get(i))===t&&(this.log_("listen response",s),"ok"!==o&&this.removeListen_(n,i),t.onComplete&&t.onComplete(o,r))}))}static warnOnListenWarnings_(t,e){if(t&&"object"==typeof t&&P(t,"w")){const n=M(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){const t='".indexOn": "'+e._queryParams.getIndex().toString()+'"',n=e._path.toString();ro(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${t} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(()=>{})),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||function(t){const e=E(t).claims;return"object"==typeof e&&!0===e.admin}(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(()=>{}))}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,e=function(t){const e=E(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")}(t)?"auth":"gauth",n={cred:t};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(e,n,(e=>{const n=e.s,i=e.d||"error";this.authToken_===t&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,i))}))}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(t=>{const e=t.s,n=t.d||"error";"ok"===e?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(e,n)}))}unlisten(t,n){const i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),e(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,n)}sendUnlisten_(t,e,n,i){this.log_("Unlisten on "+t+" for "+e);const s={p:t};i&&(s.q=n,s.t=i),this.sendRequest("n",s)}onDisconnectPut(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})}onDisconnectMerge(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})}onDisconnectCancel(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})}sendOnDisconnect_(t,e,n,i){const s={p:e,d:n};this.log_("onDisconnect "+t,s),this.sendRequest(t,s,(t=>{i&&setTimeout((()=>{i(t.s,t.d)}),Math.floor(0))}))}put(t,e,n,i){this.putInternal("p",t,e,n,i)}merge(t,e,n,i){this.putInternal("m",t,e,n,i)}putInternal(t,e,n,i,s){this.initConnection_();const r={p:e,d:n};void 0!==s&&(r.h=s),this.outstandingPuts_.push({action:t,request:r,onComplete:i}),this.outstandingPutCount_++;const o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+e)}sendPut_(t){const e=this.outstandingPuts_[t].action,n=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(e,n,(n=>{this.log_(e+" response",n),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),i&&i(n.s,n.d)}))}reportStats(t){if(this.connected_){const e={c:t};this.log_("reportStats",e),this.sendRequest("s",e,(t=>{if("ok"!==t.s){const e=t.d;this.log_("reportStats","Error sending stats: "+e)}}))}}onDataMessage_(t){if("r"in t){this.log_("from server: "+S(t));const e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):io("Unrecognized action received from server: "+S(t)+"\nAre you using the latest client?")}onReady_(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){e(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((()=>{this.establishConnectionTimer_=null,this.establishConnection_()}),Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=ca,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=ca,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=ca),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;const t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+ha.nextConnectionId_++,r=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,i())},c=function(t){e(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(t)};this.realtime_={close:l,sendRequest:c};const h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[e,l]=await Promise.all([this.authTokenProvider_.getToken(h),this.appCheckTokenProvider_.getToken(h)]);o?eo("getToken() completed but was canceled"):(eo("getToken() completed. Creating connection."),this.authToken_=e&&e.accessToken,this.appCheckToken_=l&&l.token,a=new Wo(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,i,(t=>{ro(t+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")}),r))}catch(t){this.log_("Failed to get token: "+t),o||(this.repoInfo_.nodeAdmin&&ro(t),l())}}}interrupt(t){eo("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){eo("Resuming connection for reason: "+t),delete this.interruptReasons_[t],R(this.interruptReasons_)&&(this.reconnectDelay_=ca,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,e){let n;n=e?e.map((t=>po(t))).join("$"):"default";const i=this.removeListen_(t,n);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(t,e){const n=new $o(t).toString();let i;if(this.listens.has(n)){const t=this.listens.get(n);i=t.get(e),t.delete(e),0===t.size&&this.listens.delete(n)}else i=void 0;return i}onAuthRevoked_(t,e){eo("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,e){eo("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const e of t.values())this.sendListen_(e);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let e="js";t["sdk."+e+"."+Br.replace(/\./g,"-")]=1,y()?t["framework.cordova"]=1:b()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=qo.getInstance().currentlyOnline();return R(this.interruptReasons_)&&t}}ha.nextPersistentConnectionId_=0,ha.nextConnectionId_=0;class ua{constructor(t,e){this.name=t,this.node=e}static Wrap(t,e){return new ua(t,e)}}class da{getCompare(){return this.compare.bind(this)}indexedValueChanged(t,e){const n=new ua(ao,t),i=new ua(ao,e);return 0!==this.compare(n,i)}minPost(){return ua.MIN}}let pa;class fa extends da{static get __EMPTY_NODE(){return pa}static set __EMPTY_NODE(t){pa=t}compare(t,e){return co(t.name,e.name)}isDefinedOn(t){throw n("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(t,e){return!1}minPost(){return ua.MIN}maxPost(){return new ua(lo,pa)}makePost(t,n){return e("string"==typeof t,"KeyIndex indexValue must always be a string."),new ua(t,pa)}toString(){return".key"}}const ga=new fa;class ma{constructor(t,e,n,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let r=1;for(;!t.isEmpty();)if(r=e?n(t.key,e):1,i&&(r*=-1),r<0)t=this.isReverse_?t.left:t.right;else{if(0===r){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}}}class _a{constructor(t,e,n,i,s){this.key=t,this.value=e,this.color=null!=n?n:_a.RED,this.left=null!=i?i:ya.EMPTY_NODE,this.right=null!=s?s:ya.EMPTY_NODE}copy(t,e,n,i,s){return new _a(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=s?s:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,n){let i=this;const s=n(t,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===s?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return ya.EMPTY_NODE;let t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,e){let n,i;if(n=this,e(t,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return ya.EMPTY_NODE;i=n.right.min_(),n=n.copy(i.key,i.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,_a.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,_a.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}_a.RED=!0,_a.BLACK=!1;class ya{constructor(t,e=ya.EMPTY_NODE){this.comparator_=t,this.root_=e}insert(t,e){return new ya(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,_a.BLACK,null,null))}remove(t){return new ya(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,_a.BLACK,null,null))}get(t){let e,n=this.root_;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e)return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null}getPredecessorKey(t){let e,n=this.root_,i=null;for(;!n.isEmpty();){if(e=this.comparator_(t,n.key),0===e){if(n.left.isEmpty())return i?i.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(i=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(t){return this.root_.inorderTraversal(t)}reverseTraversal(t){return this.root_.reverseTraversal(t)}getIterator(t){return new ma(this.root_,null,this.comparator_,!1,t)}getIteratorFrom(t,e){return new ma(this.root_,t,this.comparator_,!1,e)}getReverseIteratorFrom(t,e){return new ma(this.root_,t,this.comparator_,!0,e)}getReverseIterator(t){return new ma(this.root_,null,this.comparator_,!0,t)}}function va(t,e){return co(t.name,e.name)}function ba(t,e){return co(t,e)}let wa;ya.EMPTY_NODE=new class{copy(t,e,n,i,s){return this}insert(t,e,n){return new _a(t,e,null)}remove(t,e){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const xa=function(t){return"number"==typeof t?"number:"+mo(t):"string:"+t},ka=function(t){if(t.isLeafNode()){const n=t.val();e("string"==typeof n||"number"==typeof n||"object"==typeof n&&P(n,".sv"),"Priority must be a string or number.")}else e(t===wa||t.isEmpty(),"priority of unexpected type.");e(t===wa||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let Ca,Ia,Ta;class Sa{constructor(t,n=Sa.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=n,this.lazyHash_=null,e(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),ka(this.priorityNode_)}static set __childrenNodeConstructor(t){Ca=t}static get __childrenNodeConstructor(){return Ca}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new Sa(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:Sa.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return ea(t)?this:".priority"===Yo(t)?this.priorityNode_:Sa.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,e){return null}updateImmediateChild(t,e){return".priority"===t?this.updatePriority(e):e.isEmpty()&&".priority"!==t?this:Sa.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,e).updatePriority(this.priorityNode_)}updateChild(t,n){const i=Yo(t);return null===i?n:n.isEmpty()&&".priority"!==i?this:(e(".priority"!==i||1===Go(t),".priority must be the last token in a path"),this.updateImmediateChild(i,Sa.__childrenNodeConstructor.EMPTY_NODE.updateChild(Jo(t),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,e){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+xa(this.priorityNode_.val())+":");const e=typeof this.value_;t+=e+":",t+="number"===e?mo(this.value_):this.value_,this.lazyHash_=Xr(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===Sa.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof Sa.__childrenNodeConstructor?-1:(e(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const n=typeof t.value_,i=typeof this.value_,s=Sa.VALUE_TYPE_ORDER.indexOf(n),r=Sa.VALUE_TYPE_ORDER.indexOf(i);return e(s>=0,"Unknown leaf type: "+n),e(r>=0,"Unknown leaf type: "+i),s===r?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:r-s}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1}}Sa.VALUE_TYPE_ORDER=["object","boolean","number","string"];const Ea=new class extends da{compare(t,e){const n=t.node.getPriority(),i=e.node.getPriority(),s=n.compareTo(i);return 0===s?co(t.name,e.name):s}isDefinedOn(t){return!t.getPriority().isEmpty()}indexedValueChanged(t,e){return!t.getPriority().equals(e.getPriority())}minPost(){return ua.MIN}maxPost(){return new ua(lo,new Sa("[PRIORITY-POST]",Ta))}makePost(t,e){const n=Ia(t);return new ua(e,new Sa("[PRIORITY-POST]",n))}toString(){return".priority"}},Pa=Math.log(2);class Ma{constructor(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/Pa,10)),this.current_=this.count-1;const n=(i=this.count,parseInt(Array(i+1).join("1"),2));var i;this.bits_=t+1&n}nextBitIsOne(){const t=!(this.bits_&1<<this.current_);return this.current_--,t}}const Ra=function(t,e,n,i){t.sort(e);const s=function(e,i){const r=i-e;let o,a;if(0===r)return null;if(1===r)return o=t[e],a=n?n(o):o,new _a(a,o.node,_a.BLACK,null,null);{const l=parseInt(r/2,10)+e,c=s(e,l),h=s(l+1,i);return o=t[l],a=n?n(o):o,new _a(a,o.node,_a.BLACK,c,h)}},r=function(e){let i=null,r=null,o=t.length;const a=function(e,i){const r=o-e,a=o;o-=e;const c=s(r+1,a),h=t[r],u=n?n(h):h;l(new _a(u,h.node,i,null,c))},l=function(t){i?(i.left=t,i=t):(r=t,i=t)};for(let t=0;t<e.count;++t){const n=e.nextBitIsOne(),i=Math.pow(2,e.count-(t+1));n?a(i,_a.BLACK):(a(i,_a.BLACK),a(i,_a.RED))}return r}(new Ma(t.length));return new ya(i||e,r)};let Oa;const Aa={};class Da{constructor(t,e){this.indexes_=t,this.indexSet_=e}static get Default(){return e(Aa&&Ea,"ChildrenNode.ts has not been loaded"),Oa=Oa||new Da({".priority":Aa},{".priority":Ea}),Oa}get(t){const e=M(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof ya?e:null}hasIndex(t){return P(this.indexSet_,t.toString())}addIndex(t,n){e(t!==ga,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const i=[];let s=!1;const r=n.getIterator(ua.Wrap);let o,a=r.getNext();for(;a;)s=s||t.isDefinedOn(a.node),i.push(a),a=r.getNext();o=s?Ra(i,t.getCompare()):Aa;const l=t.toString(),c=Object.assign({},this.indexSet_);c[l]=t;const h=Object.assign({},this.indexes_);return h[l]=o,new Da(h,c)}addToIndexes(t,n){const i=O(this.indexes_,((i,s)=>{const r=M(this.indexSet_,s);if(e(r,"Missing index implementation for "+s),i===Aa){if(r.isDefinedOn(t.node)){const e=[],i=n.getIterator(ua.Wrap);let s=i.getNext();for(;s;)s.name!==t.name&&e.push(s),s=i.getNext();return e.push(t),Ra(e,r.getCompare())}return Aa}{const e=n.get(t.name);let s=i;return e&&(s=s.remove(new ua(t.name,e))),s.insert(t,t.node)}}));return new Da(i,this.indexSet_)}removeFromIndexes(t,e){const n=O(this.indexes_,(n=>{if(n===Aa)return n;{const i=e.get(t.name);return i?n.remove(new ua(t.name,i)):n}}));return new Da(n,this.indexSet_)}}let Na;class La{constructor(t,n,i){this.children_=t,this.priorityNode_=n,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&ka(this.priorityNode_),this.children_.isEmpty()&&e(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Na||(Na=new La(new ya(ba),null,Da.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Na}updatePriority(t){return this.children_.isEmpty()?this:new La(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const e=this.children_.get(t);return null===e?Na:e}}getChild(t){const e=Yo(t);return null===e?this:this.getImmediateChild(e).getChild(Jo(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,n){if(e(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);{const e=new ua(t,n);let i,s;n.isEmpty()?(i=this.children_.remove(t),s=this.indexMap_.removeFromIndexes(e,this.children_)):(i=this.children_.insert(t,n),s=this.indexMap_.addToIndexes(e,this.children_));const r=i.isEmpty()?Na:this.priorityNode_;return new La(i,r,s)}}updateChild(t,n){const i=Yo(t);if(null===i)return n;{e(".priority"!==Yo(t)||1===Go(t),".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(Jo(t),n);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const e={};let n=0,i=0,s=!0;if(this.forEachChild(Ea,((r,o)=>{e[r]=o.val(t),n++,s&&La.INTEGER_REGEXP_.test(r)?i=Math.max(i,Number(r)):s=!1})),!t&&s&&i<2*n){const t=[];for(const n in e)t[n]=e[n];return t}return t&&!this.getPriority().isEmpty()&&(e[".priority"]=this.getPriority().val()),e}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+xa(this.getPriority().val())+":"),this.forEachChild(Ea,((e,n)=>{const i=n.hash();""!==i&&(t+=":"+e+":"+i)})),this.lazyHash_=""===t?"":Xr(t)}return this.lazyHash_}getPredecessorChildName(t,e,n){const i=this.resolveIndex_(n);if(i){const n=i.getPredecessorKey(new ua(t,e));return n?n.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.minKey();return t&&t.name}return this.children_.minKey()}getFirstChild(t){const e=this.getFirstChildName(t);return e?new ua(e,this.children_.get(e)):null}getLastChildName(t){const e=this.resolveIndex_(t);if(e){const t=e.maxKey();return t&&t.name}return this.children_.maxKey()}getLastChild(t){const e=this.getLastChildName(t);return e?new ua(e,this.children_.get(e)):null}forEachChild(t,e){const n=this.resolveIndex_(t);return n?n.inorderTraversal((t=>e(t.name,t.node))):this.children_.inorderTraversal(e)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(t=>t));{const n=this.children_.getIteratorFrom(t.name,ua.Wrap);let i=n.peek();for(;null!=i&&e.compare(i,t)<0;)n.getNext(),i=n.peek();return n}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,e){const n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(t=>t));{const n=this.children_.getReverseIteratorFrom(t.name,ua.Wrap);let i=n.peek();for(;null!=i&&e.compare(i,t)>0;)n.getNext(),i=n.peek();return n}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Fa?-1:0}withIndex(t){if(t===ga||this.indexMap_.hasIndex(t))return this;{const e=this.indexMap_.addIndex(t,this.children_);return new La(this.children_,this.priorityNode_,e)}}isIndexed(t){return t===ga||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){const t=this.getIterator(Ea),n=e.getIterator(Ea);let i=t.getNext(),s=n.getNext();for(;i&&s;){if(i.name!==s.name||!i.node.equals(s.node))return!1;i=t.getNext(),s=n.getNext()}return null===i&&null===s}return!1}return!1}}resolveIndex_(t){return t===ga?null:this.indexMap_.get(t.toString())}}La.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;const Fa=new class extends La{constructor(){super(new ya(ba),La.EMPTY_NODE,Da.Default)}compareTo(t){return t===this?0:1}equals(t){return t===this}getPriority(){return this}getImmediateChild(t){return La.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(ua,{MIN:{value:new ua(ao,La.EMPTY_NODE)},MAX:{value:new ua(lo,Fa)}}),fa.__EMPTY_NODE=La.EMPTY_NODE,Sa.__childrenNodeConstructor=La,wa=Fa,Ta=Fa;const za=!0;function ja(t,n=null){if(null===t)return La.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(n=t[".priority"]),e(null===n||"string"==typeof n||"number"==typeof n||"object"==typeof n&&".sv"in n,"Invalid priority type found: "+typeof n),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Sa(t,ja(n));if(t instanceof Array||!za){let e=La.EMPTY_NODE;return go(t,((n,i)=>{if(P(t,n)&&"."!==n.substring(0,1)){const t=ja(i);!t.isLeafNode()&&t.isEmpty()||(e=e.updateImmediateChild(n,t))}})),e.updatePriority(ja(n))}{const e=[];let i=!1;if(go(t,((t,n)=>{if("."!==t.substring(0,1)){const s=ja(n);s.isEmpty()||(i=i||!s.getPriority().isEmpty(),e.push(new ua(t,s)))}})),0===e.length)return La.EMPTY_NODE;const s=Ra(e,va,(t=>t.name),ba);if(i){const t=Ra(e,Ea.getCompare());return new La(s,ja(n),new Da({".priority":t},{".priority":Ea}))}return new La(s,ja(n),Da.Default)}}!function(t){Ia=t}(ja);class Va extends da{constructor(t){super(),this.indexPath_=t,e(!ea(t)&&".priority"!==Yo(t),"Can't create PathIndex with empty path or .priority key")}extractChild(t){return t.getChild(this.indexPath_)}isDefinedOn(t){return!t.getChild(this.indexPath_).isEmpty()}compare(t,e){const n=this.extractChild(t.node),i=this.extractChild(e.node),s=n.compareTo(i);return 0===s?co(t.name,e.name):s}makePost(t,e){const n=ja(t),i=La.EMPTY_NODE.updateChild(this.indexPath_,n);return new ua(e,i)}maxPost(){const t=La.EMPTY_NODE.updateChild(this.indexPath_,Fa);return new ua(lo,t)}toString(){return Qo(this.indexPath_,0).join("/")}}const Ua=new class extends da{compare(t,e){const n=t.node.compareTo(e.node);return 0===n?co(t.name,e.name):n}isDefinedOn(t){return!0}indexedValueChanged(t,e){return!t.equals(e)}minPost(){return ua.MIN}maxPost(){return ua.MAX}makePost(t,e){const n=ja(t);return new ua(e,n)}toString(){return".value"}};function Wa(t){return{type:"value",snapshotNode:t}}function Ba(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ha(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function qa(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}class $a{constructor(t){this.index_=t}updateChild(t,n,i,s,r,o){e(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=t.getImmediateChild(n);return a.getChild(s).equals(i.getChild(s))&&a.isEmpty()===i.isEmpty()?t:(null!=o&&(i.isEmpty()?t.hasChild(n)?o.trackChildChange(Ha(n,a)):e(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ba(n,i)):o.trackChildChange(qa(n,i,a))),t.isLeafNode()&&i.isEmpty()?t:t.updateImmediateChild(n,i).withIndex(this.index_))}updateFullNode(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Ea,((t,i)=>{e.hasChild(t)||n.trackChildChange(Ha(t,i))})),e.isLeafNode()||e.forEachChild(Ea,((e,i)=>{if(t.hasChild(e)){const s=t.getImmediateChild(e);s.equals(i)||n.trackChildChange(qa(e,i,s))}else n.trackChildChange(Ba(e,i))}))),e.withIndex(this.index_)}updatePriority(t,e){return t.isEmpty()?La.EMPTY_NODE:t.updatePriority(e)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class Ka{constructor(t){this.indexedFilter_=new $a(t.getIndex()),this.index_=t.getIndex(),this.startPost_=Ka.getStartPost_(t),this.endPost_=Ka.getEndPost_(t),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(t){const e=this.startIsInclusive_?this.index_.compare(this.getStartPost(),t)<=0:this.index_.compare(this.getStartPost(),t)<0,n=this.endIsInclusive_?this.index_.compare(t,this.getEndPost())<=0:this.index_.compare(t,this.getEndPost())<0;return e&&n}updateChild(t,e,n,i,s,r){return this.matches(new ua(e,n))||(n=La.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,i,s,r)}updateFullNode(t,e,n){e.isLeafNode()&&(e=La.EMPTY_NODE);let i=e.withIndex(this.index_);i=i.updatePriority(La.EMPTY_NODE);const s=this;return e.forEachChild(Ea,((t,e)=>{s.matches(new ua(t,e))||(i=i.updateImmediateChild(t,La.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,i,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(t){if(t.hasStart()){const e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()}static getEndPost_(t){if(t.hasEnd()){const e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()}}class Ya{constructor(t){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const e=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?e<=0:e<0},this.withinEndPost=t=>{const e=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?e<=0:e<0},this.rangedFilter_=new Ka(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft(),this.startIsInclusive_=!t.startAfterSet_,this.endIsInclusive_=!t.endBeforeSet_}updateChild(t,e,n,i,s,r){return this.rangedFilter_.matches(new ua(e,n))||(n=La.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,i,s,r):this.fullLimitUpdateChild_(t,e,n,s,r)}updateFullNode(t,e,n){let i;if(e.isLeafNode()||e.isEmpty())i=La.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){let t;i=La.EMPTY_NODE.withIndex(this.index_),t=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;t.hasNext()&&n<this.limit_;){const e=t.getNext();if(this.withinDirectionalStart(e)){if(!this.withinDirectionalEnd(e))break;i=i.updateImmediateChild(e.name,e.node),n++}}}else{let t;i=e.withIndex(this.index_),i=i.updatePriority(La.EMPTY_NODE),t=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let n=0;for(;t.hasNext();){const e=t.getNext();n<this.limit_&&this.withinDirectionalStart(e)&&this.withinDirectionalEnd(e)?n++:i=i.updateImmediateChild(e.name,La.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,i,n)}updatePriority(t,e){return t}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(t,n,i,s,r){let o;if(this.reverse_){const t=this.index_.getCompare();o=(e,n)=>t(n,e)}else o=this.index_.getCompare();const a=t;e(a.numChildren()===this.limit_,"");const l=new ua(n,i),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(a.hasChild(n)){const t=a.getImmediateChild(n);let e=s.getChildAfterChild(this.index_,c,this.reverse_);for(;null!=e&&(e.name===n||a.hasChild(e.name));)e=s.getChildAfterChild(this.index_,e,this.reverse_);const u=null==e?1:o(e,l);if(h&&!i.isEmpty()&&u>=0)return null!=r&&r.trackChildChange(qa(n,i,t)),a.updateImmediateChild(n,i);{null!=r&&r.trackChildChange(Ha(n,t));const i=a.updateImmediateChild(n,La.EMPTY_NODE);return null!=e&&this.rangedFilter_.matches(e)?(null!=r&&r.trackChildChange(Ba(e.name,e.node)),i.updateImmediateChild(e.name,e.node)):i}}return i.isEmpty()?t:h&&o(c,l)>=0?(null!=r&&(r.trackChildChange(Ha(c.name,c.node)),r.trackChildChange(Ba(n,i))),a.updateImmediateChild(n,i).updateImmediateChild(c.name,La.EMPTY_NODE)):t}}class Ga{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ea}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return e(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return e(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ao}hasEnd(){return this.endSet_}getIndexEndValue(){return e(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return e(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:lo}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return e(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Ea}copy(){const t=new Ga;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.startAfterSet_=this.startAfterSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.endBeforeSet_=this.endBeforeSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t}}function Ja(t){const n={};if(t.isDefault())return n;let i;if(t.index_===Ea?i="$priority":t.index_===Ua?i="$value":t.index_===ga?i="$key":(e(t.index_ instanceof Va,"Unrecognized index type!"),i=t.index_.toString()),n.orderBy=S(i),t.startSet_){const e=t.startAfterSet_?"startAfter":"startAt";n[e]=S(t.indexStartValue_),t.startNameSet_&&(n[e]+=","+S(t.indexStartName_))}if(t.endSet_){const e=t.endBeforeSet_?"endBefore":"endAt";n[e]=S(t.indexEndValue_),t.endNameSet_&&(n[e]+=","+S(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_),n}function Xa(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==Ea&&(e.i=t.index_.toString()),e}class Qa extends Bo{constructor(t,e,n,i){super(),this.repoInfo_=t,this.onDataUpdate_=e,this.authTokenProvider_=n,this.appCheckTokenProvider_=i,this.log_=no("p:rest:"),this.listens_={}}reportStats(t){throw new Error("Method not implemented.")}static getListenId_(t,n){return void 0!==n?"tag$"+n:(e(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())}listen(t,e,n,i){const s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);const r=Qa.getListenId_(t,n),o={};this.listens_[r]=o;const a=Ja(t._queryParams);this.restRequest_(s+".json",a,((t,e)=>{let a=e;if(404===t&&(a=null,t=null),null===t&&this.onDataUpdate_(s,a,!1,n),M(this.listens_,r)===o){let e;e=t?401===t?"permission_denied":"rest_error:"+t:"ok",i(e,null)}}))}unlisten(t,e){const n=Qa.getListenId_(t,e);delete this.listens_[n]}get(t){const e=Ja(t._queryParams),n=t._path.toString(),i=new m;return this.restRequest_(n+".json",e,((t,e)=>{let s=e;404===t&&(s=null,t=null),null===t?(this.onDataUpdate_(n,s,!1,null),i.resolve(s)):i.reject(new Error(s))})),i.promise}refreshAuthToken(t){}restRequest_(t,e={},n){return e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((([i,s])=>{i&&i.accessToken&&(e.auth=i.accessToken),s&&s.token&&(e.ac=s.token);const r=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+t+"?ns="+this.repoInfo_.namespace+N(e);this.log_("Sending REST request for "+r);const o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+r+" received. status:",o.status,"response:",o.responseText);let t=null;if(o.status>=200&&o.status<300){try{t=T(o.responseText)}catch(t){ro("Failed to parse JSON response for "+r+": "+o.responseText)}n(null,t)}else 401!==o.status&&404!==o.status&&ro("Got unsuccessful REST response for "+r+" Status: "+o.status),n(o.status);n=null}},o.open("GET",r,!0),o.send()}))}}class Za{constructor(){this.rootNode_=La.EMPTY_NODE}getNode(t){return this.rootNode_.getChild(t)}updateSnapshot(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)}}function tl(){return{value:null,children:new Map}}function el(t,e,n){if(ea(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{const i=Yo(e);t.children.has(i)||t.children.set(i,tl()),el(t.children.get(i),e=Jo(e),n)}}function nl(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach(((t,n)=>{e(n,t)}))}(t,((t,i)=>{nl(i,new $o(e.toString()+"/"+t),n)}))}class il{constructor(t){this.collection_=t,this.last_=null}get(){const t=this.collection_.get(),e=Object.assign({},t);return this.last_&&go(this.last_,((t,n)=>{e[t]=e[t]-n})),this.last_=t,e}}class sl{constructor(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new il(t);const n=1e4+2e4*Math.random();bo(this.reportStats_.bind(this),Math.floor(n))}reportStats_(){const t=this.statsListener_.get(),e={};let n=!1;go(t,((t,i)=>{i>0&&P(this.statsToReport_,t)&&(e[t]=i,n=!0)})),n&&this.server_.reportStats(e),bo(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var rl,ol;function al(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}(ol=rl||(rl={}))[ol.OVERWRITE=0]="OVERWRITE",ol[ol.MERGE=1]="MERGE",ol[ol.ACK_USER_WRITE=2]="ACK_USER_WRITE",ol[ol.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";class ll{constructor(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=rl.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(t){if(ea(this.path)){if(null!=this.affectedTree.value)return e(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const e=this.affectedTree.subtree(new $o(t));return new ll(Ko(),e,this.revert)}}return e(Yo(this.path)===t,"operationForChild called for unrelated child."),new ll(Jo(this.path),this.affectedTree,this.revert)}}class cl{constructor(t,e){this.source=t,this.path=e,this.type=rl.LISTEN_COMPLETE}operationForChild(t){return ea(this.path)?new cl(this.source,Ko()):new cl(this.source,Jo(this.path))}}class hl{constructor(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=rl.OVERWRITE}operationForChild(t){return ea(this.path)?new hl(this.source,Ko(),this.snap.getImmediateChild(t)):new hl(this.source,Jo(this.path),this.snap)}}class ul{constructor(t,e,n){this.source=t,this.path=e,this.children=n,this.type=rl.MERGE}operationForChild(t){if(ea(this.path)){const e=this.children.subtree(new $o(t));return e.isEmpty()?null:e.value?new hl(this.source,Ko(),e.value):new ul(this.source,Ko(),e)}return e(Yo(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new ul(this.source,Jo(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class dl{constructor(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(t){if(ea(t))return this.isFullyInitialized()&&!this.filtered_;const e=Yo(t);return this.isCompleteForChild(e)}isCompleteForChild(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)}getNode(){return this.node_}}class pl{constructor(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()}}function fl(t,e,i,s,r,o){const a=s.filter((t=>t.type===i));a.sort(((e,i)=>function(t,e,i){if(null==e.childName||null==i.childName)throw n("Should only compare child_ events.");const s=new ua(e.childName,e.snapshotNode),r=new ua(i.childName,i.snapshotNode);return t.index_.compare(s,r)}(t,e,i))),a.forEach((n=>{const i=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,o);r.forEach((s=>{s.respondsTo(n.type)&&e.push(s.createEvent(i,t.query_))}))}))}function gl(t,e){return{eventCache:t,serverCache:e}}function ml(t,e,n,i){return gl(new dl(e,n,i),t.serverCache)}function _l(t,e,n,i){return gl(t.eventCache,new dl(e,n,i))}function yl(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function vl(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}let bl;class wl{constructor(t,e=(()=>(bl||(bl=new ya(ho)),bl))()){this.value=t,this.children=e}static fromObject(t){let e=new wl(null);return go(t,((t,n)=>{e=e.set(new $o(t),n)})),e}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(t,e){if(null!=this.value&&e(this.value))return{path:Ko(),value:this.value};if(ea(t))return null;{const n=Yo(t),i=this.children.get(n);if(null!==i){const s=i.findRootMostMatchingPathAndValue(Jo(t),e);return null!=s?{path:ta(new $o(n),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(t){return this.findRootMostMatchingPathAndValue(t,(()=>!0))}subtree(t){if(ea(t))return this;{const e=Yo(t),n=this.children.get(e);return null!==n?n.subtree(Jo(t)):new wl(null)}}set(t,e){if(ea(t))return new wl(e,this.children);{const n=Yo(t),i=(this.children.get(n)||new wl(null)).set(Jo(t),e),s=this.children.insert(n,i);return new wl(this.value,s)}}remove(t){if(ea(t))return this.children.isEmpty()?new wl(null):new wl(null,this.children);{const e=Yo(t),n=this.children.get(e);if(n){const i=n.remove(Jo(t));let s;return s=i.isEmpty()?this.children.remove(e):this.children.insert(e,i),null===this.value&&s.isEmpty()?new wl(null):new wl(this.value,s)}return this}}get(t){if(ea(t))return this.value;{const e=Yo(t),n=this.children.get(e);return n?n.get(Jo(t)):null}}setTree(t,e){if(ea(t))return e;{const n=Yo(t),i=(this.children.get(n)||new wl(null)).setTree(Jo(t),e);let s;return s=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new wl(this.value,s)}}fold(t){return this.fold_(Ko(),t)}fold_(t,e){const n={};return this.children.inorderTraversal(((i,s)=>{n[i]=s.fold_(ta(t,i),e)})),e(t,this.value,n)}findOnPath(t,e){return this.findOnPath_(t,Ko(),e)}findOnPath_(t,e,n){const i=!!this.value&&n(e,this.value);if(i)return i;if(ea(t))return null;{const i=Yo(t),s=this.children.get(i);return s?s.findOnPath_(Jo(t),ta(e,i),n):null}}foreachOnPath(t,e){return this.foreachOnPath_(t,Ko(),e)}foreachOnPath_(t,e,n){if(ea(t))return this;{this.value&&n(e,this.value);const i=Yo(t),s=this.children.get(i);return s?s.foreachOnPath_(Jo(t),ta(e,i),n):new wl(null)}}foreach(t){this.foreach_(Ko(),t)}foreach_(t,e){this.children.inorderTraversal(((n,i)=>{i.foreach_(ta(t,n),e)})),this.value&&e(t,this.value)}foreachChild(t){this.children.inorderTraversal(((e,n)=>{n.value&&t(e,n.value)}))}}class xl{constructor(t){this.writeTree_=t}static empty(){return new xl(new wl(null))}}function kl(t,e,n){if(ea(e))return new xl(new wl(n));{const i=t.writeTree_.findRootMostValueAndPath(e);if(null!=i){const s=i.path;let r=i.value;const o=na(s,e);return r=r.updateChild(o,n),new xl(t.writeTree_.set(s,r))}{const i=new wl(n),s=t.writeTree_.setTree(e,i);return new xl(s)}}}function Cl(t,e,n){let i=t;return go(n,((t,n)=>{i=kl(i,ta(e,t),n)})),i}function Il(t,e){if(ea(e))return xl.empty();{const n=t.writeTree_.setTree(e,new wl(null));return new xl(n)}}function Tl(t,e){return null!=Sl(t,e)}function Sl(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(na(n.path,e)):null}function El(t){const e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Ea,((t,n)=>{e.push(new ua(t,n))})):t.writeTree_.children.inorderTraversal(((t,n)=>{null!=n.value&&e.push(new ua(t,n.value))})),e}function Pl(t,e){if(ea(e))return t;{const n=Sl(t,e);return new xl(null!=n?new wl(n):t.writeTree_.subtree(e))}}function Ml(t){return t.writeTree_.isEmpty()}function Rl(t,e){return Ol(Ko(),t.writeTree_,e)}function Ol(t,n,i){if(null!=n.value)return i.updateChild(t,n.value);{let s=null;return n.children.inorderTraversal(((n,r)=>{".priority"===n?(e(null!==r.value,"Priority writes must always be leaf nodes"),s=r.value):i=Ol(ta(t,n),r,i)})),i.getChild(t).isEmpty()||null===s||(i=i.updateChild(ta(t,".priority"),s)),i}}function Al(t,e){return Hl(e,t)}function Dl(t,e){if(t.snap)return sa(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&sa(ta(t.path,n),e))return!0;return!1}function Nl(t){return t.visible}function Ll(t,e,i){let s=xl.empty();for(let r=0;r<t.length;++r){const o=t[r];if(e(o)){const t=o.path;let e;if(o.snap)sa(i,t)?(e=na(i,t),s=kl(s,e,o.snap)):sa(t,i)&&(e=na(t,i),s=kl(s,Ko(),o.snap.getChild(e)));else{if(!o.children)throw n("WriteRecord should have .snap or .children");if(sa(i,t))e=na(i,t),s=Cl(s,e,o.children);else if(sa(t,i))if(e=na(t,i),ea(e))s=Cl(s,Ko(),o.children);else{const t=M(o.children,Yo(e));if(t){const n=t.getChild(Jo(e));s=kl(s,Ko(),n)}}}}}return s}function Fl(t,e,n,i,s){if(i||s){const r=Pl(t.visibleWrites,e);if(!s&&Ml(r))return n;if(s||null!=n||Tl(r,Ko())){const r=function(t){return(t.visible||s)&&(!i||!~i.indexOf(t.writeId))&&(sa(t.path,e)||sa(e,t.path))};return Rl(Ll(t.allWrites,r,e),n||La.EMPTY_NODE)}return null}{const i=Sl(t.visibleWrites,e);if(null!=i)return i;{const i=Pl(t.visibleWrites,e);return Ml(i)?n:null!=n||Tl(i,Ko())?Rl(i,n||La.EMPTY_NODE):null}}}function zl(t,e,n,i){return Fl(t.writeTree,t.treePath,e,n,i)}function jl(t,e){return function(t,e,n){let i=La.EMPTY_NODE;const s=Sl(t.visibleWrites,e);if(s)return s.isLeafNode()||s.forEachChild(Ea,((t,e)=>{i=i.updateImmediateChild(t,e)})),i;if(n){const s=Pl(t.visibleWrites,e);return n.forEachChild(Ea,((t,e)=>{const n=Rl(Pl(s,new $o(t)),e);i=i.updateImmediateChild(t,n)})),El(s).forEach((t=>{i=i.updateImmediateChild(t.name,t.node)})),i}return El(Pl(t.visibleWrites,e)).forEach((t=>{i=i.updateImmediateChild(t.name,t.node)})),i}(t.writeTree,t.treePath,e)}function Vl(t,n,i,s){return function(t,n,i,s,r){e(s||r,"Either existingEventSnap or existingServerSnap must exist");const o=ta(n,i);if(Tl(t.visibleWrites,o))return null;{const e=Pl(t.visibleWrites,o);return Ml(e)?r.getChild(i):Rl(e,r.getChild(i))}}(t.writeTree,t.treePath,n,i,s)}function Ul(t,e){return function(t,e){return Sl(t.visibleWrites,e)}(t.writeTree,ta(t.treePath,e))}function Wl(t,e,n){return function(t,e,n,i){const s=ta(e,n),r=Sl(t.visibleWrites,s);return null!=r?r:i.isCompleteForChild(n)?Rl(Pl(t.visibleWrites,s),i.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function Bl(t,e){return Hl(ta(t.treePath,e),t.writeTree)}function Hl(t,e){return{treePath:t,writeTree:e}}class ql{constructor(){this.changeMap=new Map}trackChildChange(t){const i=t.type,s=t.childName;e("child_added"===i||"child_changed"===i||"child_removed"===i,"Only child changes supported for tracking"),e(".priority"!==s,"Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const e=r.type;if("child_added"===i&&"child_removed"===e)this.changeMap.set(s,qa(s,t.snapshotNode,r.snapshotNode));else if("child_removed"===i&&"child_added"===e)this.changeMap.delete(s);else if("child_removed"===i&&"child_changed"===e)this.changeMap.set(s,Ha(s,r.oldSnap));else if("child_changed"===i&&"child_added"===e)this.changeMap.set(s,Ba(s,t.snapshotNode));else{if("child_changed"!==i||"child_changed"!==e)throw n("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(s,qa(s,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(s,t)}getChanges(){return Array.from(this.changeMap.values())}}const $l=new class{getCompleteChild(t){return null}getChildAfterChild(t,e,n){return null}};class Kl{constructor(t,e,n=null){this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}getCompleteChild(t){const e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);{const e=null!=this.optCompleteServerCache_?new dl(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Wl(this.writes_,t,e)}}getChildAfterChild(t,e,n){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:vl(this.viewCache_),s=function(t,e,n,i,s,r){return function(t,e,n,i,s,r,o){let a;const l=Pl(t.visibleWrites,e),c=Sl(l,Ko());if(null!=c)a=c;else{if(null==n)return[];a=Rl(l,n)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const t=[],e=o.getCompare(),n=r?a.getReverseIteratorFrom(i,o):a.getIteratorFrom(i,o);let l=n.getNext();for(;l&&t.length<s;)0!==e(l,i)&&t.push(l),l=n.getNext();return t}}(t.writeTree,t.treePath,e,n,i,s,r)}(this.writes_,i,e,1,n,t);return 0===s.length?null:s[0]}}function Yl(t,n,i,s,r,o){const a=n.eventCache;if(null!=Ul(s,i))return n;{let l,c;if(ea(i))if(e(n.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),n.serverCache.isFiltered()){const e=vl(n),i=jl(s,e instanceof La?e:La.EMPTY_NODE);l=t.filter.updateFullNode(n.eventCache.getNode(),i,o)}else{const e=zl(s,vl(n));l=t.filter.updateFullNode(n.eventCache.getNode(),e,o)}else{const h=Yo(i);if(".priority"===h){e(1===Go(i),"Can't have a priority with additional path components");const r=a.getNode();c=n.serverCache.getNode();const o=Vl(s,i,r,c);l=null!=o?t.filter.updatePriority(r,o):a.getNode()}else{const e=Jo(i);let u;if(a.isCompleteForChild(h)){c=n.serverCache.getNode();const t=Vl(s,i,a.getNode(),c);u=null!=t?a.getNode().getImmediateChild(h).updateChild(e,t):a.getNode().getImmediateChild(h)}else u=Wl(s,h,n.serverCache);l=null!=u?t.filter.updateChild(a.getNode(),h,u,e,r,o):a.getNode()}}return ml(n,l,a.isFullyInitialized()||ea(i),t.filter.filtersNodes())}}function Gl(t,e,n,i,s,r,o,a){const l=e.serverCache;let c;const h=o?t.filter:t.filter.getIndexedFilter();if(ea(n))c=h.updateFullNode(l.getNode(),i,null);else if(h.filtersNodes()&&!l.isFiltered()){const t=l.getNode().updateChild(n,i);c=h.updateFullNode(l.getNode(),t,null)}else{const t=Yo(n);if(!l.isCompleteForPath(n)&&Go(n)>1)return e;const s=Jo(n),r=l.getNode().getImmediateChild(t).updateChild(s,i);c=".priority"===t?h.updatePriority(l.getNode(),r):h.updateChild(l.getNode(),t,r,s,$l,null)}const u=_l(e,c,l.isFullyInitialized()||ea(n),h.filtersNodes());return Yl(t,u,n,s,new Kl(s,u,r),a)}function Jl(t,e,n,i,s,r,o){const a=e.eventCache;let l,c;const h=new Kl(s,e,r);if(ea(n))c=t.filter.updateFullNode(e.eventCache.getNode(),i,o),l=ml(e,c,!0,t.filter.filtersNodes());else{const s=Yo(n);if(".priority"===s)c=t.filter.updatePriority(e.eventCache.getNode(),i),l=ml(e,c,a.isFullyInitialized(),a.isFiltered());else{const r=Jo(n),c=a.getNode().getImmediateChild(s);let u;if(ea(r))u=i;else{const t=h.getCompleteChild(s);u=null!=t?".priority"===Xo(r)&&t.getChild(Zo(r)).isEmpty()?t:t.updateChild(r,i):La.EMPTY_NODE}l=c.equals(u)?e:ml(e,t.filter.updateChild(a.getNode(),s,u,r,h,o),a.isFullyInitialized(),t.filter.filtersNodes())}}return l}function Xl(t,e){return t.eventCache.isCompleteForChild(e)}function Ql(t,e,n){return n.foreach(((t,n)=>{e=e.updateChild(t,n)})),e}function Zl(t,e,n,i,s,r,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l,c=e;l=ea(n)?i:new wl(null).setTree(n,i);const h=e.serverCache.getNode();return l.children.inorderTraversal(((n,i)=>{if(h.hasChild(n)){const l=Ql(0,e.serverCache.getNode().getImmediateChild(n),i);c=Gl(t,c,new $o(n),l,s,r,o,a)}})),l.children.inorderTraversal(((n,i)=>{const l=!e.serverCache.isCompleteForChild(n)&&null===i.value;if(!h.hasChild(n)&&!l){const l=Ql(0,e.serverCache.getNode().getImmediateChild(n),i);c=Gl(t,c,new $o(n),l,s,r,o,a)}})),c}class tc{constructor(t,e){this.query_=t,this.eventRegistrations_=[];const n=this.query_._queryParams,i=new $a(n.getIndex()),s=(r=n).loadsAllData()?new $a(r.getIndex()):r.hasLimit()?new Ya(r):new Ka(r);var r;this.processor_=function(t){return{filter:t}}(s);const o=e.serverCache,a=e.eventCache,l=i.updateFullNode(La.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(La.EMPTY_NODE,a.getNode(),null),h=new dl(l,o.isFullyInitialized(),i.filtersNodes()),u=new dl(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=gl(u,h),this.eventGenerator_=new pl(this.query_)}get query(){return this.query_}}function ec(t,e){const n=vl(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ea(e)&&!n.getImmediateChild(Yo(e)).isEmpty())?n.getChild(e):null}function nc(t){return 0===t.eventRegistrations_.length}function ic(t,n,i){const s=[];if(i){e(null==n,"A cancel should cancel all event registrations.");const r=t.query._path;t.eventRegistrations_.forEach((t=>{const e=t.createCancelEvent(i,r);e&&s.push(e)}))}if(n){let e=[];for(let i=0;i<t.eventRegistrations_.length;++i){const s=t.eventRegistrations_[i];if(s.matches(n)){if(n.hasAnyCallback()){e=e.concat(t.eventRegistrations_.slice(i+1));break}}else e.push(s)}t.eventRegistrations_=e}else t.eventRegistrations_=[];return s}function sc(t,i,s,r){i.type===rl.MERGE&&null!==i.source.queryId&&(e(vl(t.viewCache_),"We should always have a full cache before handling merges"),e(yl(t.viewCache_),"Missing event cache, even though we have a server cache"));const o=t.viewCache_,a=function(t,i,s,r,o){const a=new ql;let l,c;if(s.type===rl.OVERWRITE){const n=s;n.source.fromUser?l=Jl(t,i,n.path,n.snap,r,o,a):(e(n.source.fromServer,"Unknown source."),c=n.source.tagged||i.serverCache.isFiltered()&&!ea(n.path),l=Gl(t,i,n.path,n.snap,r,o,c,a))}else if(s.type===rl.MERGE){const n=s;n.source.fromUser?l=function(t,e,n,i,s,r,o){let a=e;return i.foreach(((i,l)=>{const c=ta(n,i);Xl(e,Yo(c))&&(a=Jl(t,a,c,l,s,r,o))})),i.foreach(((i,l)=>{const c=ta(n,i);Xl(e,Yo(c))||(a=Jl(t,a,c,l,s,r,o))})),a}(t,i,n.path,n.children,r,o,a):(e(n.source.fromServer,"Unknown source."),c=n.source.tagged||i.serverCache.isFiltered(),l=Zl(t,i,n.path,n.children,r,o,c,a))}else if(s.type===rl.ACK_USER_WRITE){const n=s;l=n.revert?function(t,n,i,s,r,o){let a;if(null!=Ul(s,i))return n;{const l=new Kl(s,n,r),c=n.eventCache.getNode();let h;if(ea(i)||".priority"===Yo(i)){let i;if(n.serverCache.isFullyInitialized())i=zl(s,vl(n));else{const t=n.serverCache.getNode();e(t instanceof La,"serverChildren would be complete if leaf node"),i=jl(s,t)}h=t.filter.updateFullNode(c,i,o)}else{const e=Yo(i);let r=Wl(s,e,n.serverCache);null==r&&n.serverCache.isCompleteForChild(e)&&(r=c.getImmediateChild(e)),h=null!=r?t.filter.updateChild(c,e,r,Jo(i),l,o):n.eventCache.getNode().hasChild(e)?t.filter.updateChild(c,e,La.EMPTY_NODE,Jo(i),l,o):c,h.isEmpty()&&n.serverCache.isFullyInitialized()&&(a=zl(s,vl(n)),a.isLeafNode()&&(h=t.filter.updateFullNode(h,a,o)))}return a=n.serverCache.isFullyInitialized()||null!=Ul(s,Ko()),ml(n,h,a,t.filter.filtersNodes())}}(t,i,n.path,r,o,a):function(t,e,n,i,s,r,o){if(null!=Ul(s,n))return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(null!=i.value){if(ea(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Gl(t,e,n,l.getNode().getChild(n),s,r,a,o);if(ea(n)){let i=new wl(null);return l.getNode().forEachChild(ga,((t,e)=>{i=i.set(new $o(t),e)})),Zl(t,e,n,i,s,r,a,o)}return e}{let c=new wl(null);return i.foreach(((t,e)=>{const i=ta(n,t);l.isCompleteForPath(i)&&(c=c.set(t,l.getNode().getChild(i)))})),Zl(t,e,n,c,s,r,a,o)}}(t,i,n.path,n.affectedTree,r,o,a)}else{if(s.type!==rl.LISTEN_COMPLETE)throw n("Unknown operation type: "+s.type);l=function(t,e,n,i,s){const r=e.serverCache;return Yl(t,_l(e,r.getNode(),r.isFullyInitialized()||ea(n),r.isFiltered()),n,i,$l,s)}(t,i,s.path,r,a)}const h=a.getChanges();return function(t,e,n){const i=e.eventCache;if(i.isFullyInitialized()){const s=i.getNode().isLeafNode()||i.getNode().isEmpty(),r=yl(t);(n.length>0||!t.eventCache.isFullyInitialized()||s&&!i.getNode().equals(r)||!i.getNode().getPriority().equals(r.getPriority()))&&n.push(Wa(yl(e)))}}(i,l,h),{viewCache:l,changes:h}}(t.processor_,o,i,s,r);var l,c;return l=t.processor_,c=a.viewCache,e(c.eventCache.getNode().isIndexed(l.filter.getIndex()),"Event snap not indexed"),e(c.serverCache.getNode().isIndexed(l.filter.getIndex()),"Server snap not indexed"),e(a.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=a.viewCache,rc(t,a.changes,a.viewCache.eventCache.getNode(),null)}function rc(t,e,n,i){const s=i?[i]:t.eventRegistrations_;return function(t,e,n,i){const s=[],r=[];return e.forEach((e=>{var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&r.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),fl(t,s,"child_removed",e,i,n),fl(t,s,"child_added",e,i,n),fl(t,s,"child_moved",r,i,n),fl(t,s,"child_changed",e,i,n),fl(t,s,"value",e,i,n),s}(t.eventGenerator_,e,n,s)}let oc,ac;class lc{constructor(){this.views=new Map}}function cc(t,n,i,s){const r=n.source.queryId;if(null!==r){const o=t.views.get(r);return e(null!=o,"SyncTree gave us an op for an invalid query."),sc(o,n,i,s)}{let e=[];for(const r of t.views.values())e=e.concat(sc(r,n,i,s));return e}}function hc(t,e,n,i,s){const r=e._queryIdentifier,o=t.views.get(r);if(!o){let t=zl(n,s?i:null),r=!1;t?r=!0:i instanceof La?(t=jl(n,i),r=!1):(t=La.EMPTY_NODE,r=!1);const o=gl(new dl(t,r,!1),new dl(i,s,!1));return new tc(e,o)}return o}function uc(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function dc(t,e){let n=null;for(const i of t.views.values())n=n||ec(i,e);return n}function pc(t,e){if(e._queryParams.loadsAllData())return mc(t);{const n=e._queryIdentifier;return t.views.get(n)}}function fc(t,e){return null!=pc(t,e)}function gc(t){return null!=mc(t)}function mc(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let _c=1;class yc{constructor(t){this.listenProvider_=t,this.syncPointTree_=new wl(null),this.pendingWriteTree_={visibleWrites:xl.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function vc(t,n,i,s,r){return function(t,n,i,s,r){e(s>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),t.allWrites.push({path:n,snap:i,writeId:s,visible:r}),r&&(t.visibleWrites=kl(t.visibleWrites,n,i)),t.lastWriteId=s}(t.pendingWriteTree_,n,i,s,r),r?Tc(t,new hl({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},n,i)):[]}function bc(t,n,i=!1){const s=function(t,e){for(let n=0;n<t.allWrites.length;n++){const i=t.allWrites[n];if(i.writeId===e)return i}return null}(t.pendingWriteTree_,n);if(function(t,n){const i=t.allWrites.findIndex((t=>t.writeId===n));e(i>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[i];t.allWrites.splice(i,1);let r=s.visible,o=!1,a=t.allWrites.length-1;for(;r&&a>=0;){const e=t.allWrites[a];e.visible&&(a>=i&&Dl(e,s.path)?r=!1:sa(s.path,e.path)&&(o=!0)),a--}return!!r&&(o?(function(t){t.visibleWrites=Ll(t.allWrites,Nl,Ko()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0):(s.snap?t.visibleWrites=Il(t.visibleWrites,s.path):go(s.children,(e=>{t.visibleWrites=Il(t.visibleWrites,ta(s.path,e))})),!0))}(t.pendingWriteTree_,n)){let e=new wl(null);return null!=s.snap?e=e.set(Ko(),!0):go(s.children,(t=>{e=e.set(new $o(t),!0)})),Tc(t,new ll(s.path,e,i))}return[]}function wc(t,e,n){return Tc(t,new hl({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function xc(t,n,i,s,r=!1){const o=n._path,a=t.syncPointTree_.get(o);let l=[];if(a&&("default"===n._queryIdentifier||fc(a,n))){const c=function(t,n,i,s){const r=n._queryIdentifier,o=[];let a=[];const l=gc(t);if("default"===r)for(const[e,n]of t.views.entries())a=a.concat(ic(n,i,s)),nc(n)&&(t.views.delete(e),n.query._queryParams.loadsAllData()||o.push(n.query));else{const e=t.views.get(r);e&&(a=a.concat(ic(e,i,s)),nc(e)&&(t.views.delete(r),e.query._queryParams.loadsAllData()||o.push(e.query)))}return l&&!gc(t)&&o.push(new(e(oc,"Reference.ts has not been loaded"),oc)(n._repo,n._path)),{removed:o,events:a}}(a,n,i,s);0===a.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(o));const h=c.removed;if(l=c.events,!r){const e=-1!==h.findIndex((t=>t._queryParams.loadsAllData())),i=t.syncPointTree_.findOnPath(o,((t,e)=>gc(e)));if(e&&!i){const e=t.syncPointTree_.subtree(o);if(!e.isEmpty()){const n=function(t){return t.fold(((t,e,n)=>{if(e&&gc(e))return[mc(e)];{let t=[];return e&&(t=uc(e)),go(n,((e,n)=>{t=t.concat(n)})),t}}))}(e);for(let e=0;e<n.length;++e){const i=n[e],s=i.query,r=Pc(t,i);t.listenProvider_.startListening(Nc(s),Mc(t,s),r.hashFn,r.onComplete)}}}if(!i&&h.length>0&&!s)if(e){const e=null;t.listenProvider_.stopListening(Nc(n),e)}else h.forEach((e=>{const n=t.queryToTagMap.get(Rc(e));t.listenProvider_.stopListening(Nc(e),n)}))}!function(t,e){for(let n=0;n<e.length;++n){const i=e[n];if(!i._queryParams.loadsAllData()){const e=Rc(i),n=t.queryToTagMap.get(e);t.queryToTagMap.delete(e),t.tagToQueryMap.delete(n)}}}(t,h)}return l}function kc(t,e,n,i){const s=Oc(t,i);if(null!=s){const i=Ac(s),r=i.path,o=i.queryId,a=na(r,e);return Dc(t,r,new hl(al(o),a,n))}return[]}function Cc(t,n,i,s=!1){const r=n._path;let o=null,a=!1;t.syncPointTree_.foreachOnPath(r,((t,e)=>{const n=na(t,r);o=o||dc(e,n),a=a||gc(e)}));let l,c=t.syncPointTree_.get(r);c?(a=a||gc(c),o=o||dc(c,Ko())):(c=new lc,t.syncPointTree_=t.syncPointTree_.set(r,c)),null!=o?l=!0:(l=!1,o=La.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild(((t,e)=>{const n=dc(e,Ko());n&&(o=o.updateImmediateChild(t,n))})));const h=fc(c,n);if(!h&&!n._queryParams.loadsAllData()){const i=Rc(n);e(!t.queryToTagMap.has(i),"View does not exist, but we have a tag");const s=_c++;t.queryToTagMap.set(i,s),t.tagToQueryMap.set(s,i)}let u=function(t,e,n,i,s,r){const o=hc(t,e,i,s,r);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),function(t,e){t.eventRegistrations_.push(e)}(o,n),function(t,e){const n=t.viewCache_.eventCache,i=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ea,((t,e)=>{i.push(Ba(t,e))})),n.isFullyInitialized()&&i.push(Wa(n.getNode())),rc(t,i,n.getNode(),e)}(o,n)}(c,n,i,Al(t.pendingWriteTree_,r),o,l);if(!h&&!a&&!s){const i=pc(c,n);u=u.concat(function(t,n,i){const s=n._path,r=Mc(t,n),o=Pc(t,i),a=t.listenProvider_.startListening(Nc(n),r,o.hashFn,o.onComplete),l=t.syncPointTree_.subtree(s);if(r)e(!gc(l.value),"If we're adding a query, it shouldn't be shadowed");else{const e=l.fold(((t,e,n)=>{if(!ea(t)&&e&&gc(e))return[mc(e).query];{let t=[];return e&&(t=t.concat(uc(e).map((t=>t.query)))),go(n,((e,n)=>{t=t.concat(n)})),t}}));for(let n=0;n<e.length;++n){const i=e[n];t.listenProvider_.stopListening(Nc(i),Mc(t,i))}}return a}(t,n,i))}return u}function Ic(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,((t,n)=>{const i=dc(n,na(t,e));if(i)return i}));return Fl(i,e,s,n,!0)}function Tc(t,e){return Sc(e,t.syncPointTree_,null,Al(t.pendingWriteTree_,Ko()))}function Sc(t,e,n,i){if(ea(t.path))return Ec(t,e,n,i);{const s=e.get(Ko());null==n&&null!=s&&(n=dc(s,Ko()));let r=[];const o=Yo(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const t=n?n.getImmediateChild(o):null,e=Bl(i,o);r=r.concat(Sc(a,l,t,e))}return s&&(r=r.concat(cc(s,t,i,n))),r}}function Ec(t,e,n,i){const s=e.get(Ko());null==n&&null!=s&&(n=dc(s,Ko()));let r=[];return e.children.inorderTraversal(((e,s)=>{const o=n?n.getImmediateChild(e):null,a=Bl(i,e),l=t.operationForChild(e);l&&(r=r.concat(Ec(l,s,o,a)))})),s&&(r=r.concat(cc(s,t,i,n))),r}function Pc(t,e){const n=e.query,i=Mc(t,n);return{hashFn:()=>{const t=function(t){return t.viewCache_.serverCache.getNode()}(e)||La.EMPTY_NODE;return t.hash()},onComplete:e=>{if("ok"===e)return i?function(t,e,n){const i=Oc(t,n);if(i){const n=Ac(i),s=n.path,r=n.queryId,o=na(s,e);return Dc(t,s,new cl(al(r),o))}return[]}(t,n._path,i):function(t,e){return Tc(t,new cl({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);{const i=function(t,e){let n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");const i=new Error(t+" at "+e._path.toString()+": "+n);return i.code=t.toUpperCase(),i}(e,n);return xc(t,n,null,i)}}}}function Mc(t,e){const n=Rc(e);return t.queryToTagMap.get(n)}function Rc(t){return t._path.toString()+"$"+t._queryIdentifier}function Oc(t,e){return t.tagToQueryMap.get(e)}function Ac(t){const n=t.indexOf("$");return e(-1!==n&&n<t.length-1,"Bad queryKey."),{queryId:t.substr(n+1),path:new $o(t.substr(0,n))}}function Dc(t,n,i){const s=t.syncPointTree_.get(n);return e(s,"Missing sync point for query tag that we're tracking"),cc(s,i,Al(t.pendingWriteTree_,n),null)}function Nc(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(e(ac,"Reference.ts has not been loaded"),ac)(t._repo,t._path):t}class Lc{constructor(t){this.node_=t}getImmediateChild(t){const e=this.node_.getImmediateChild(t);return new Lc(e)}node(){return this.node_}}class Fc{constructor(t,e){this.syncTree_=t,this.path_=e}getImmediateChild(t){const e=ta(this.path_,t);return new Fc(this.syncTree_,e)}node(){return Ic(this.syncTree_,this.path_)}}const zc=function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t},jc=function(t,n,i){return t&&"object"==typeof t?(e(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?Vc(t[".sv"],n,i):"object"==typeof t[".sv"]?Uc(t[".sv"],n):void e(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},Vc=function(t,n,i){if("timestamp"===t)return i.timestamp;e(!1,"Unexpected server value: "+t)},Uc=function(t,n,i){t.hasOwnProperty("increment")||e(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;"number"!=typeof s&&e(!1,"Unexpected increment value: "+s);const r=n.node();if(e(null!=r,"Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return"number"!=typeof o?s:o+s},Wc=function(t,e,n,i){return Hc(e,new Fc(n,t),i)},Bc=function(t,e,n){return Hc(t,new Lc(e),n)};function Hc(t,e,n){const i=t.getPriority().val(),s=jc(i,e.getImmediateChild(".priority"),n);let r;if(t.isLeafNode()){const i=t,r=jc(i.getValue(),e,n);return r!==i.getValue()||s!==i.getPriority().val()?new Sa(r,ja(s)):t}{const i=t;return r=i,s!==i.getPriority().val()&&(r=r.updatePriority(new Sa(s))),i.forEachChild(Ea,((t,i)=>{const s=Hc(i,e.getImmediateChild(t),n);s!==i&&(r=r.updateImmediateChild(t,s))})),r}}class qc{constructor(t="",e=null,n={children:{},childCount:0}){this.name=t,this.parent=e,this.node=n}}function $c(t,e){let n=e instanceof $o?e:new $o(e),i=t,s=Yo(n);for(;null!==s;){const t=M(i.node.children,s)||{children:{},childCount:0};i=new qc(s,i,t),n=Jo(n),s=Yo(n)}return i}function Kc(t){return t.node.value}function Yc(t,e){t.node.value=e,Zc(t)}function Gc(t){return t.node.childCount>0}function Jc(t,e){go(t.node.children,((n,i)=>{e(new qc(n,t,i))}))}function Xc(t,e,n,i){n&&!i&&e(t),Jc(t,(t=>{Xc(t,e,!0,i)})),n&&i&&e(t)}function Qc(t){return new $o(null===t.parent?t.name:Qc(t.parent)+"/"+t.name)}function Zc(t){null!==t.parent&&function(t,e,n){const i=function(t){return void 0===Kc(t)&&!Gc(t)}(n),s=P(t.node.children,e);i&&s?(delete t.node.children[e],t.node.childCount--,Zc(t)):i||s||(t.node.children[e]=n.node,t.node.childCount++,Zc(t))}(t.parent,t.name,t)}const th=/[\[\].#$\/\u0000-\u001F\u007F]/,eh=/[\[\].#$\u0000-\u001F\u007F]/,nh=10485760,ih=function(t){return"string"==typeof t&&0!==t.length&&!th.test(t)},sh=function(t){return"string"==typeof t&&0!==t.length&&!eh.test(t)},rh=function(t,e,n,i){i&&void 0===e||oh(U(t,"value"),e,n)},oh=function(t,e,n){const i=n instanceof $o?new ra(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+aa(i));if("function"==typeof e)throw new Error(t+"contains a function "+aa(i)+" with contents = "+e.toString());if(oo(e))throw new Error(t+"contains "+e.toString()+" "+aa(i));if("string"==typeof e&&e.length>nh/3&&W(e)>nh)throw new Error(t+"contains a string greater than "+nh+" utf8 bytes "+aa(i)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let n=!1,s=!1;if(go(e,((e,r)=>{if(".value"===e)n=!0;else if(".priority"!==e&&".sv"!==e&&(s=!0,!ih(e)))throw new Error(t+" contains an invalid key ("+e+") "+aa(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=W(e),oa(t)}(i,e),oh(t,r,i),function(t){const e=t.parts_.pop();t.byteLength_-=W(e),t.parts_.length>0&&(t.byteLength_-=1)}(i)})),n&&s)throw new Error(t+' contains ".value" child '+aa(i)+" in addition to actual children.")}},ah=function(t,e,n,i){if(!(i&&void 0===n||sh(n)))throw new Error(U(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},lh=function(t,e,n,i){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ah(t,e,n,i)},ch=function(t,e){if(".info"===Yo(e))throw new Error(t+" failed = Can't modify data under /.info/")};class hh{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function uh(t,e){let n=null;for(let i=0;i<e.length;i++){const s=e[i],r=s.getPath();null===n||ia(r,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:r}),n.events.push(s)}n&&t.eventLists_.push(n)}function dh(t,e,n){uh(t,n),fh(t,(t=>ia(t,e)))}function ph(t,e,n){uh(t,n),fh(t,(t=>sa(t,e)||sa(e,t)))}function fh(t,e){t.recursionDepth_++;let n=!0;for(let i=0;i<t.eventLists_.length;i++){const s=t.eventLists_[i];s&&(e(s.path)?(gh(t.eventLists_[i]),t.eventLists_[i]=null):n=!1)}n&&(t.eventLists_=[]),t.recursionDepth_--}function gh(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(null!==n){t.events[e]=null;const i=n.getEventRunner();Zr&&eo("event: "+n.toString()),vo(i)}}}const mh=25;class _h{constructor(t,e,n,i){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new hh,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=tl(),this.transactionQueueTree_=new qc,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function yh(t,e,n){if(t.stats_=Do(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new Qa(t.repoInfo_,((e,n,i,s)=>{wh(t,e,n,i,s)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((()=>xh(t,!0)),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{S(n)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}t.persistentConnection_=new ha(t.repoInfo_,e,((e,n,i,s)=>{wh(t,e,n,i,s)}),(e=>{xh(t,e)}),(e=>{!function(t,e){go(e,((e,n)=>{kh(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener((e=>{t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((e=>{t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=function(e){const n=e.toString();return Ao[n]||(Ao[n]=new sl(t.stats_,t.server_)),Ao[n]}(t.repoInfo_),t.infoData_=new Za,t.infoSyncTree_=new yc({startListening:(e,n,i,s)=>{let r=[];const o=t.infoData_.getNode(e._path);return o.isEmpty()||(r=wc(t.infoSyncTree_,e._path,o),setTimeout((()=>{s("ok")}),0)),r},stopListening:()=>{}}),kh(t,"connected",!1),t.serverSyncTree_=new yc({startListening:(e,n,i,s)=>(t.server_.listen(e,i,n,((n,i)=>{const r=s(n,i);ph(t.eventQueue_,e._path,r)})),[]),stopListening:(e,n)=>{t.server_.unlisten(e,n)}})}function vh(t){const e=t.infoData_.getNode(new $o(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function bh(t){return zc({timestamp:vh(t)})}function wh(t,e,n,i,s){t.dataUpdateCount++;const r=new $o(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(s)if(i){const e=O(n,(t=>ja(t)));o=function(t,e,n,i){const s=Oc(t,i);if(s){const i=Ac(s),r=i.path,o=i.queryId,a=na(r,e),l=wl.fromObject(n);return Dc(t,r,new ul(al(o),a,l))}return[]}(t.serverSyncTree_,r,e,s)}else{const e=ja(n);o=kc(t.serverSyncTree_,r,e,s)}else if(i){const e=O(n,(t=>ja(t)));o=function(t,e,n){const i=wl.fromObject(n);return Tc(t,new ul({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,i))}(t.serverSyncTree_,r,e)}else{const e=ja(n);o=wc(t.serverSyncTree_,r,e)}let a=r;o.length>0&&(a=Mh(t,r)),ph(t.eventQueue_,a,o)}function xh(t,e){kh(t,"connected",e),!1===e&&function(t){Sh(t,"onDisconnectEvents");const e=bh(t),n=tl();nl(t.onDisconnect_,Ko(),((i,s)=>{const r=Wc(i,s,t.serverSyncTree_,e);el(n,i,r)}));let i=[];nl(n,Ko(),((e,n)=>{i=i.concat(wc(t.serverSyncTree_,e,n));const s=Nh(t,e);Mh(t,s)})),t.onDisconnect_=tl(),ph(t.eventQueue_,Ko(),i)}(t)}function kh(t,e,n){const i=new $o("/.info/"+e),s=ja(n);t.infoData_.updateSnapshot(i,s);const r=wc(t.infoSyncTree_,i,s);ph(t.eventQueue_,i,r)}function Ch(t){return t.nextWriteId_++}function Ih(t,e,n,i,s){Sh(t,"set",{path:e.toString(),value:n,priority:i});const r=bh(t),o=ja(n,i),a=Ic(t.serverSyncTree_,e),l=Bc(o,a,r),c=Ch(t),h=vc(t.serverSyncTree_,e,l,c,!0);uh(t.eventQueue_,h),t.server_.put(e.toString(),o.val(!0),((n,i)=>{const r="ok"===n;r||ro("set at "+e+" failed: "+n);const o=bc(t.serverSyncTree_,c,!r);ph(t.eventQueue_,e,o),function(t,e,n,i){e&&vo((()=>{if("ok"===n)e(null);else{const t=(n||"error").toUpperCase();let s=t;i&&(s+=": "+i);const r=new Error(s);r.code=t,e(r)}}))}(0,s,n,i)}));const u=Nh(t,e);Mh(t,u),ph(t.eventQueue_,u,[])}function Th(t,e,n){let i;i=".info"===Yo(e._path)?xc(t.infoSyncTree_,e,n):xc(t.serverSyncTree_,e,n),dh(t.eventQueue_,e._path,i)}function Sh(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),eo(n,...e)}function Eh(t,e,n){return Ic(t.serverSyncTree_,e,n)||La.EMPTY_NODE}function Ph(t,n=t.transactionQueueTree_){if(n||Dh(t,n),Kc(n)){const i=Oh(t,n);e(i.length>0,"Sending zero length transaction queue"),i.every((t=>0===t.status))&&function(t,n,i){const s=i.map((t=>t.currentWriteId)),r=Eh(t,n,s);let o=r;const a=r.hash();for(let t=0;t<i.length;t++){const s=i[t];e(0===s.status,"tryToSendTransactionQueue_: items in queue should all be run."),s.status=1,s.retryCount++;const r=na(n,s.path);o=o.updateChild(r,s.currentOutputSnapshotRaw)}const l=o.val(!0),c=n;t.server_.put(c.toString(),l,(e=>{Sh(t,"transaction put response",{path:c.toString(),status:e});let s=[];if("ok"===e){const e=[];for(let n=0;n<i.length;n++)i[n].status=2,s=s.concat(bc(t.serverSyncTree_,i[n].currentWriteId)),i[n].onComplete&&e.push((()=>i[n].onComplete(null,!0,i[n].currentOutputSnapshotResolved))),i[n].unwatcher();Dh(t,$c(t.transactionQueueTree_,n)),Ph(t,t.transactionQueueTree_),ph(t.eventQueue_,n,s);for(let t=0;t<e.length;t++)vo(e[t])}else{if("datastale"===e)for(let t=0;t<i.length;t++)3===i[t].status?i[t].status=4:i[t].status=0;else{ro("transaction at "+c.toString()+" failed: "+e);for(let t=0;t<i.length;t++)i[t].status=4,i[t].abortReason=e}Mh(t,n)}}),a)}(t,Qc(n),i)}else Gc(n)&&Jc(n,(e=>{Ph(t,e)}))}function Mh(t,n){const i=Rh(t,n),s=Qc(i);return function(t,n,i){if(0===n.length)return;const s=[];let r=[];const o=n.filter((t=>0===t.status)).map((t=>t.currentWriteId));for(let l=0;l<n.length;l++){const c=n[l],h=na(i,c.path);let u,d=!1;if(e(null!==h,"rerunTransactionsUnderNode_: relativePath should not be null."),4===c.status)d=!0,u=c.abortReason,r=r.concat(bc(t.serverSyncTree_,c.currentWriteId,!0));else if(0===c.status)if(c.retryCount>=mh)d=!0,u="maxretry",r=r.concat(bc(t.serverSyncTree_,c.currentWriteId,!0));else{const e=Eh(t,c.path,o);c.currentInputSnapshot=e;const i=n[l].update(e.val());if(void 0!==i){oh("transaction failed: Data returned ",i,c.path);let n=ja(i);"object"==typeof i&&null!=i&&P(i,".priority")||(n=n.updatePriority(e.getPriority()));const s=c.currentWriteId,a=bh(t),l=Bc(n,e,a);c.currentOutputSnapshotRaw=n,c.currentOutputSnapshotResolved=l,c.currentWriteId=Ch(t),o.splice(o.indexOf(s),1),r=r.concat(vc(t.serverSyncTree_,c.path,l,c.currentWriteId,c.applyLocally)),r=r.concat(bc(t.serverSyncTree_,s,!0))}else d=!0,u="nodata",r=r.concat(bc(t.serverSyncTree_,c.currentWriteId,!0))}ph(t.eventQueue_,i,r),r=[],d&&(n[l].status=2,a=n[l].unwatcher,setTimeout(a,Math.floor(0)),n[l].onComplete&&("nodata"===u?s.push((()=>n[l].onComplete(null,!1,n[l].currentInputSnapshot))):s.push((()=>n[l].onComplete(new Error(u),!1,null)))))}var a;Dh(t,t.transactionQueueTree_);for(let t=0;t<s.length;t++)vo(s[t]);Ph(t,t.transactionQueueTree_)}(t,Oh(t,i),s),s}function Rh(t,e){let n,i=t.transactionQueueTree_;for(n=Yo(e);null!==n&&void 0===Kc(i);)i=$c(i,n),n=Yo(e=Jo(e));return i}function Oh(t,e){const n=[];return Ah(t,e,n),n.sort(((t,e)=>t.order-e.order)),n}function Ah(t,e,n){const i=Kc(e);if(i)for(let t=0;t<i.length;t++)n.push(i[t]);Jc(e,(e=>{Ah(t,e,n)}))}function Dh(t,e){const n=Kc(e);if(n){let t=0;for(let e=0;e<n.length;e++)2!==n[e].status&&(n[t]=n[e],t++);n.length=t,Yc(e,n.length>0?n:void 0)}Jc(e,(e=>{Dh(t,e)}))}function Nh(t,e){const n=Qc(Rh(t,e)),i=$c(t.transactionQueueTree_,e);return function(t,e){let n=t.parent;for(;null!==n;){if(e(n))return!0;n=n.parent}}(i,(e=>{Lh(t,e)})),Lh(t,i),Xc(i,(e=>{Lh(t,e)})),n}function Lh(t,n){const i=Kc(n);if(i){const s=[];let r=[],o=-1;for(let n=0;n<i.length;n++)3===i[n].status||(1===i[n].status?(e(o===n-1,"All SENT items should be at beginning of queue."),o=n,i[n].status=3,i[n].abortReason="set"):(e(0===i[n].status,"Unexpected transaction status in abort"),i[n].unwatcher(),r=r.concat(bc(t.serverSyncTree_,i[n].currentWriteId,!0)),i[n].onComplete&&s.push(i[n].onComplete.bind(null,new Error("set"),!1,null))));-1===o?Yc(n,void 0):i.length=o+1,ph(t.eventQueue_,Qc(n),r);for(let t=0;t<s.length;t++)vo(s[t])}}const Fh=function(t,e){const n=zh(t),i=n.namespace;"firebase.com"===n.domain&&so(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),i&&"undefined"!==i||"localhost"===n.domain||so("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ro("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");const s="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new Po(n.host,n.secure,i,s,e,"",i!==n.subdomain),path:new $o(n.pathString)}},zh=function(t){let e="",n="",i="",s="",r="",o=!0,a="https",l=443;if("string"==typeof t){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let h=t.indexOf("/");-1===h&&(h=t.length);let u=t.indexOf("?");-1===u&&(u=t.length),e=t.substring(0,Math.min(h,u)),h<u&&(s=function(t){let e="";const n=t.split("/");for(let t=0;t<n.length;t++)if(n[t].length>0){let i=n[t];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(h,u)));const d=function(t){const e={};"?"===t.charAt(0)&&(t=t.substring(1));for(const n of t.split("&")){if(0===n.length)continue;const i=n.split("=");2===i.length?e[decodeURIComponent(i[0])]=decodeURIComponent(i[1]):ro(`Invalid query segment '${n}' in query '${t}'`)}return e}(t.substring(Math.min(t.length,u)));c=e.indexOf(":"),c>=0?(o="https"===a||"wss"===a,l=parseInt(e.substring(c+1),10)):c=e.length;const p=e.slice(0,c);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{const t=e.indexOf(".");i=e.substring(0,t).toLowerCase(),n=e.substring(t+1),r=i}"ns"in d&&(r=d.ns)}return{host:e,port:l,domain:n,subdomain:i,secure:o,scheme:a,pathString:s,namespace:r}};class jh{constructor(t,e,n,i){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=i}getPath(){const t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+S(this.snapshot.exportVal())}}class Vh{constructor(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class Uh{constructor(t,e){this.snapshotCallback=t,this.cancelCallback=e}onValue(t,e){this.snapshotCallback.call(null,t,e)}onCancel(t){return e(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)}get hasCancelCallback(){return!!this.cancelCallback}matches(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context}}class Wh{constructor(t,e,n,i){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=i}get key(){return ea(this._path)?null:Xo(this._path)}get ref(){return new Bh(this._repo,this._path)}get _queryIdentifier(){const t=Xa(this._queryParams),e=po(t);return"{}"===e?"default":e}get _queryObject(){return Xa(this._queryParams)}isEqual(t){if(!((t=Y(t))instanceof Wh))return!1;const e=this._repo===t._repo,n=ia(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return e&&n&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)}}class Bh extends Wh{constructor(t,e){super(t,e,new Ga,!1)}get parent(){const t=Zo(this._path);return null===t?null:new Bh(this._repo,t)}get root(){let t=this;for(;null!==t.parent;)t=t.parent;return t}}class Hh{constructor(t,e,n){this._node=t,this.ref=e,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(t){const e=new $o(t),n=$h(this.ref,t);return new Hh(this._node.getChild(e),n,Ea)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(t){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,((e,n)=>t(new Hh(n,$h(this.ref,e),Ea))))}hasChild(t){const e=new $o(t);return!this._node.getChild(e).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function qh(t,e){return(t=Y(t))._checkNotDeleted("ref"),void 0!==e?$h(t._root,e):t._root}function $h(t,e){return null===Yo((t=Y(t))._path)?lh("child","path",e,!1):ah("child","path",e,!1),new Bh(t._repo,ta(t._path,e))}function Kh(t,e){t=Y(t),ch("set",t._path),rh("set",e,t._path,!1);const n=new m;return Ih(t._repo,t._path,e,null,n.wrapCallback((()=>{}))),n.promise}function Yh(t){t=Y(t);const e=new Uh((()=>{})),n=new Gh(e);return function(t,e,n){const i=function(t,e){const n=e._path;let i=null;t.syncPointTree_.foreachOnPath(n,((t,e)=>{const s=na(t,n);i=i||dc(e,s)}));let s=t.syncPointTree_.get(n);s?i=i||dc(s,Ko()):(s=new lc,t.syncPointTree_=t.syncPointTree_.set(n,s));const r=null!=i,o=r?new dl(i,!0,!1):null;return yl(hc(s,e,Al(t.pendingWriteTree_,e._path),r?o.getNode():La.EMPTY_NODE,r).viewCache_)}(t.serverSyncTree_,e);return null!=i?Promise.resolve(i):t.server_.get(e).then((i=>{const s=ja(i).withIndex(e._queryParams.getIndex());let r;if(Cc(t.serverSyncTree_,e,n,!0),e._queryParams.loadsAllData())r=wc(t.serverSyncTree_,e._path,s);else{const n=Mc(t.serverSyncTree_,e);r=kc(t.serverSyncTree_,e._path,s,n)}return ph(t.eventQueue_,e._path,r),xc(t.serverSyncTree_,e,n,null,!0),s}),(n=>(Sh(t,"get for query "+S(e)+" failed: "+n),Promise.reject(new Error(n)))))}(t._repo,t,n).then((e=>new Hh(e,new Bh(t._repo,t._path),t._queryParams.getIndex())))}class Gh{constructor(t){this.callbackContext=t}respondsTo(t){return"value"===t}createEvent(t,e){const n=e._queryParams.getIndex();return new jh("value",this,new Hh(t.snapshotNode,new Bh(e._repo,e._path),n))}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,null)}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new Vh(this,t,e):null}matches(t){return t instanceof Gh&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class Jh{constructor(t,e){this.eventType=t,this.callbackContext=e}respondsTo(t){let e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e}createCancelEvent(t,e){return this.callbackContext.hasCancelCallback?new Vh(this,t,e):null}createEvent(t,n){e(null!=t.childName,"Child events should have a childName.");const i=$h(new Bh(n._repo,n._path),t.childName),s=n._queryParams.getIndex();return new jh(t.type,this,new Hh(t.snapshotNode,i,s),t.prevName)}getEventRunner(t){return"cancel"===t.getEventType()?()=>this.callbackContext.onCancel(t.error):()=>this.callbackContext.onValue(t.snapshot,t.prevName)}matches(t){return t instanceof Jh&&this.eventType===t.eventType&&(!this.callbackContext||!t.callbackContext||this.callbackContext.matches(t.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}!function(t){e(!oc,"__referenceConstructor has already been defined"),oc=t}(Bh),function(t){e(!ac,"__referenceConstructor has already been defined"),ac=t}(Bh);const Xh={};function Qh(t,e,n,i,s){let r=i||t.options.databaseURL;void 0===r&&(t.options.projectId||so("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),eo("Using default host for project ",t.options.projectId),r=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o,a,l=Fh(r,s),c=l.repoInfo;"undefined"!=typeof process&&(a="MISSING_ENV_VAR".FIREBASE_DATABASE_EMULATOR_HOST),a?(o=!0,r=`http://${a}?ns=${c.namespace}`,l=Fh(r,s),c=l.repoInfo):o=!l.repoInfo.secure;const h=s&&o?new ko(ko.OWNER):new xo(t.name,t.options,e);(function(t,e){const n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!ih(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),sh(t)}(n))throw new Error(U(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",l),ea(l.path)||so("Database URL must point to the root of a Firebase Database (not including a child path).");const u=function(t,e,n,i){let s=Xh[e.name];s||(s={},Xh[e.name]=s);let r=s[t.toURLString()];return r&&so("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new _h(t,false,n,i),s[t.toURLString()]=r,r}(c,t,h,new wo(t.name,n));return new Zh(u,t)}class Zh{constructor(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(yh(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Bh(this._repo,Ko())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(t,e){const n=Xh[e];n&&n[t.key]===t||so(`Database ${e}(${t.repoInfo_}) has already been deleted.`),function(t){t.persistentConnection_&&t.persistentConnection_.interrupt("repo_interrupt")}(t),delete n[t.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(t){null===this._rootInternal&&so("Cannot call "+t+" on a deleted database.")}}ha.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},ha.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)},Br=he,re(new G("database",((t,{instanceIdentifier:e})=>Qh(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"),t.getProvider("app-check-internal"),e)),"PUBLIC").setMultipleInstances(!0)),pe(Ur,Wr,void 0),pe(Ur,Wr,"esm2017");const tu=new Map,eu={activated:!1,tokenObservers:[]},nu={initialized:!1,enabled:!1};function iu(t){return tu.get(t)||Object.assign({},eu)}function su(){return nu}const ru="https://content-firebaseappcheck.googleapis.com/v1",ou="exchangeDebugToken",au={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class lu{constructor(t,e,n,i,s){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=n,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((()=>{}))}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(t){this.stop();try{this.pending=new m,this.pending.promise.catch((t=>{})),await(e=this.getNextRun(t),new Promise((t=>{setTimeout(t,e)}))),this.pending.resolve(),await this.pending.promise,this.pending=new m,this.pending.promise.catch((t=>{})),await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch((()=>{}))}catch(t){this.retryPolicy(t)?this.process(!1).catch((()=>{})):this.stop()}var e}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const cu=new C("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function hu(t=!1){var e;return t?null===(e=self.grecaptcha)||void 0===e?void 0:e.enterprise:self.grecaptcha}function uu(t){if(!iu(t).activated)throw cu.create("use-before-activation",{appName:t.name})}function du(t){const e=Math.round(t/1e3),n=Math.floor(e/86400),i=Math.floor((e-3600*n*24)/3600),s=Math.floor((e-3600*n*24-3600*i)/60),r=e-3600*n*24-3600*i-60*s;let o="";return n&&(o+=pu(n)+"d:"),i&&(o+=pu(i)+"h:"),o+=pu(s)+"m:"+pu(r)+"s",o}function pu(t){return 0===t?"00":t>=10?t.toString():"0"+t}async function fu({url:t,body:e},n){const i={"Content-Type":"application/json"},s=n.getImmediate({optional:!0});if(s){const t=await s.getHeartbeatsHeader();t&&(i["X-Firebase-Client"]=t)}const r={method:"POST",body:JSON.stringify(e),headers:i};let o,a;try{o=await fetch(t,r)}catch(t){throw cu.create("fetch-network-error",{originalErrorMessage:null==t?void 0:t.message})}if(200!==o.status)throw cu.create("fetch-status-error",{httpStatus:o.status});try{a=await o.json()}catch(t){throw cu.create("fetch-parse-error",{originalErrorMessage:null==t?void 0:t.message})}const l=a.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw cu.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const c=1e3*Number(l[1]),h=Date.now();return{token:a.token,expireTimeMillis:h+c,issuedAtTimeMillis:h}}function gu(t,e){const{projectId:n,appId:i,apiKey:s}=t.options;return{url:`${ru}/projects/${n}/apps/${i}:${ou}?key=${s}`,body:{debug_token:e}}}const mu="firebase-app-check-database",_u=1,yu="firebase-app-check-store",vu="debug-token";let bu=null;function wu(){return bu||(bu=new Promise(((t,e)=>{try{const n=indexedDB.open(mu,_u);n.onsuccess=e=>{t(e.target.result)},n.onerror=t=>{var n;e(cu.create("storage-open",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=t=>{const e=t.target.result;0===t.oldVersion&&e.createObjectStore(yu,{keyPath:"compositeKey"})}}catch(t){e(cu.create("storage-open",{originalErrorMessage:null==t?void 0:t.message}))}})),bu)}async function xu(t,e){const n=(await wu()).transaction(yu,"readwrite"),i=n.objectStore(yu).put({compositeKey:t,value:e});return new Promise(((t,e)=>{i.onsuccess=e=>{t()},n.onerror=t=>{var n;e(cu.create("storage-set",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))}async function ku(t){const e=(await wu()).transaction(yu,"readonly"),n=e.objectStore(yu).get(t);return new Promise(((t,i)=>{n.onsuccess=e=>{const n=e.target.result;t(n?n.value:void 0)},e.onerror=t=>{var e;i(cu.create("storage-get",{originalErrorMessage:null===(e=t.target.error)||void 0===e?void 0:e.message}))}}))}function Cu(t){return`${t.options.appId}-${t.name}`}const Iu=new rt("@firebase/app-check");function Tu(t,e){return w()?function(t,e){return xu(Cu(t),e)}(t,e).catch((t=>{Iu.warn(`Failed to write token to IndexedDB. Error: ${t}`)})):Promise.resolve()}async function Su(){let t;try{t=await ku(vu)}catch(t){}if(t)return t;{const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}));return(e=t,xu(vu,e)).catch((t=>Iu.warn(`Failed to persist debug token to IndexedDB. Error: ${t}`))),t}var e}function Eu(){return su().enabled}async function Pu(){const t=su();if(t.enabled&&t.token)return t.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}const Mu={error:"UNKNOWN_ERROR"};async function Ru(t,e=!1){const n=t.app;uu(n);const i=iu(n);let s,r=i.token;if(r&&!Lu(r)&&(i.token=void 0,r=void 0),!r){const t=await i.cachedTokenPromise;t&&(Lu(t)?r=t:await Tu(n,void 0))}if(!e&&r&&Lu(r))return{token:r.token};let o,a=!1;if(Eu()){i.exchangeTokenPromise||(i.exchangeTokenPromise=fu(gu(n,await Pu()),t.heartbeatServiceProvider).finally((()=>{i.exchangeTokenPromise=void 0})),a=!0);const e=await i.exchangeTokenPromise;return await Tu(n,e),i.token=e,{token:e.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally((()=>{i.exchangeTokenPromise=void 0})),a=!0),r=await iu(n).exchangeTokenPromise}catch(t){"appCheck/throttled"===t.code?Iu.warn(t.message):Iu.error(t),s=t}return r?s?o=Lu(r)?{token:r.token,internalError:s}:Fu(s):(o={token:r.token},i.token=r,await Tu(n,r)):o=Fu(s),a&&Nu(n,o),o}function Ou(t,e,n,i){const{app:s}=t,r=iu(s),o={next:n,error:i,type:e};if(r.tokenObservers=[...r.tokenObservers,o],r.token&&Lu(r.token)){const e=r.token;Promise.resolve().then((()=>{n({token:e.token}),Du(t)})).catch((()=>{}))}r.cachedTokenPromise.then((()=>Du(t)))}function Au(t,e){const n=iu(t),i=n.tokenObservers.filter((t=>t.next!==e));0===i.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=i}function Du(t){const{app:e}=t,n=iu(e);let i=n.tokenRefresher;i||(i=function(t){const{app:e}=t;return new lu((async()=>{let n;if(n=iu(e).token?await Ru(t,!0):await Ru(t),n.error)throw n.error;if(n.internalError)throw n.internalError}),(()=>!0),(()=>{const t=iu(e);if(t.token){let e=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;const n=t.token.expireTimeMillis-3e5;return e=Math.min(e,n),Math.max(0,e-Date.now())}return 0}),au.RETRIAL_MIN_WAIT,au.RETRIAL_MAX_WAIT)}(t),n.tokenRefresher=i),!i.isRunning()&&n.isTokenAutoRefreshEnabled&&i.start()}function Nu(t,e){const n=iu(t).tokenObservers;for(const t of n)try{"EXTERNAL"===t.type&&null!=e.error?t.error(e.error):t.next(e)}catch(t){}}function Lu(t){return t.expireTimeMillis-Date.now()>0}function Fu(t){return{token:(e=Mu,s.encodeString(JSON.stringify(e),!1)),error:t};var e}class zu{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){const{tokenObservers:t}=iu(this.app);for(const e of t)Au(this.app,e.next);return Promise.resolve()}}function ju(t,e){const n=new m;iu(t).reCAPTCHAState={initialized:n};const i=function(t){const e=`fire_app_check_${t.name}`,n=document.createElement("div");return n.id=e,n.style.display="none",document.body.appendChild(n),e}(t),s=hu(!1);return s?Vu(t,e,s,i,n):function(){const s=document.createElement("script");s.src="https://www.google.com/recaptcha/api.js",s.onload=()=>{const s=hu(!1);if(!s)throw new Error("no recaptcha");Vu(t,e,s,i,n)},document.head.appendChild(s)}(),n.promise}function Vu(t,e,n,i,s){n.ready((()=>{!function(t,e,n,i){const s=n.render(i,{sitekey:e,size:"invisible",callback:()=>{iu(t).reCAPTCHAState.succeeded=!0},"error-callback":()=>{iu(t).reCAPTCHAState.succeeded=!1}}),r=iu(t);r.reCAPTCHAState=Object.assign(Object.assign({},r.reCAPTCHAState),{widgetId:s})}(t,e,n,i),s.resolve(n)}))}class Uu{constructor(t){this._siteKey=t,this._throttleData=null}async getToken(){var t,e,n;!function(t){if(t&&Date.now()-t.allowRequestsAfter<=0)throw cu.create("throttled",{time:du(t.allowRequestsAfter-Date.now()),httpStatus:t.httpStatus})}(this._throttleData);const i=await async function(t){uu(t);const e=iu(t).reCAPTCHAState,n=await e.initialized.promise;return new Promise(((e,i)=>{const s=iu(t).reCAPTCHAState;n.ready((()=>{e(n.execute(s.widgetId,{action:"fire_app_check"}))}))}))}(this._app).catch((t=>{throw cu.create("recaptcha-error")}));if(!(null===(t=iu(this._app).reCAPTCHAState)||void 0===t?void 0:t.succeeded))throw cu.create("recaptcha-error");let s;try{s=await fu(function(t,e){const{projectId:n,appId:i,apiKey:s}=t.options;return{url:`${ru}/projects/${n}/apps/${i}:exchangeRecaptchaV3Token?key=${s}`,body:{recaptcha_v3_token:e}}}(this._app,i),this._heartbeatServiceProvider)}catch(t){throw(null===(e=t.code)||void 0===e?void 0:e.includes("fetch-status-error"))?(this._throttleData=function(t,e){if(404===t||403===t)return{backoffCount:1,allowRequestsAfter:Date.now()+864e5,httpStatus:t};{const n=e?e.backoffCount:0,i=K(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+i,httpStatus:t}}}(Number(null===(n=t.customData)||void 0===n?void 0:n.httpStatus),this._throttleData),cu.create("throttled",{time:du(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):t}return this._throttleData=null,s}initialize(t){this._app=t,this._heartbeatServiceProvider=oe(t,"heartbeat"),ju(t,this._siteKey).catch((()=>{}))}isEqual(t){return t instanceof Uu&&this._siteKey===t._siteKey}}const Wu="app-check-internal";function Bu(t){return t+.5|0}re(new G("app-check",(t=>function(t,e){return new zu(t,e)}(t.getProvider("app").getImmediate(),t.getProvider("heartbeat"))),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((t,e,n)=>{t.getProvider(Wu).initialize()}))),re(new G(Wu,(t=>{return e=t.getProvider("app-check").getImmediate(),{getToken:t=>Ru(e,t),getLimitedUseToken:()=>async function(t){const e=t.app;uu(e);const{provider:n}=iu(e);if(Eu()){const n=await Pu(),{token:i}=await fu(gu(e,n),t.heartbeatServiceProvider);return{token:i}}{const{token:t}=await n.getToken();return{token:t}}}(e),addTokenListener:t=>Ou(e,"INTERNAL",t),removeTokenListener:t=>Au(e.app,t)};var e}),"PUBLIC").setInstantiationMode("EXPLICIT")),pe("@firebase/app-check","0.8.7");const Hu=(t,e,n)=>Math.max(Math.min(t,n),e);function qu(t){return Hu(Bu(2.55*t),0,255)}function $u(t){return Hu(Bu(255*t),0,255)}function Ku(t){return Hu(Bu(t/2.55)/100,0,1)}function Yu(t){return Hu(Bu(100*t),0,100)}const Gu={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Ju=[..."0123456789ABCDEF"],Xu=t=>Ju[15&t],Qu=t=>Ju[(240&t)>>4]+Ju[15&t],Zu=t=>(240&t)>>4==(15&t);const td=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function ed(t,e,n){const i=e*Math.min(n,1-n),s=(e,s=(e+t/30)%12)=>n-i*Math.max(Math.min(s-3,9-s,1),-1);return[s(0),s(8),s(4)]}function nd(t,e,n){const i=(i,s=(i+t/60)%6)=>n-n*e*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function id(t,e,n){const i=ed(t,1,.5);let s;for(e+n>1&&(s=1/(e+n),e*=s,n*=s),s=0;s<3;s++)i[s]*=1-e-n,i[s]+=e;return i}function sd(t){const e=t.r/255,n=t.g/255,i=t.b/255,s=Math.max(e,n,i),r=Math.min(e,n,i),o=(s+r)/2;let a,l,c;return s!==r&&(c=s-r,l=o>.5?c/(2-s-r):c/(s+r),a=function(t,e,n,i,s){return t===s?(e-n)/i+(e<n?6:0):e===s?(n-t)/i+2:(t-e)/i+4}(e,n,i,c,s),a=60*a+.5),[0|a,l||0,o]}function rd(t,e,n,i){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,i)).map($u)}function od(t,e,n){return rd(ed,t,e,n)}function ad(t){return(t%360+360)%360}const ld={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},cd={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let hd;const ud=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/,dd=t=>t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055,pd=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function fd(t,e,n){if(t){let i=sd(t);i[e]=Math.max(0,Math.min(i[e]+i[e]*n,0===e?360:1)),i=od(i),t.r=i[0],t.g=i[1],t.b=i[2]}}function gd(t,e){return t?Object.assign(e||{},t):t}function md(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=$u(t[3]))):(e=gd(t,{r:0,g:0,b:0,a:1})).a=$u(e.a),e}function _d(t){return"r"===t.charAt(0)?function(t){const e=ud.exec(t);let n,i,s,r=255;if(e){if(e[7]!==n){const t=+e[7];r=e[8]?qu(t):Hu(255*t,0,255)}return n=+e[1],i=+e[3],s=+e[5],n=255&(e[2]?qu(n):Hu(n,0,255)),i=255&(e[4]?qu(i):Hu(i,0,255)),s=255&(e[6]?qu(s):Hu(s,0,255)),{r:n,g:i,b:s,a:r}}}(t):function(t){const e=td.exec(t);let n,i=255;if(!e)return;e[5]!==n&&(i=e[6]?qu(+e[5]):$u(+e[5]));const s=ad(+e[2]),r=+e[3]/100,o=+e[4]/100;return n="hwb"===e[1]?function(t,e,n){return rd(id,t,e,n)}(s,r,o):"hsv"===e[1]?function(t,e,n){return rd(nd,t,e,n)}(s,r,o):od(s,r,o),{r:n[0],g:n[1],b:n[2],a:i}}(t)}class yd{constructor(t){if(t instanceof yd)return t;const e=typeof t;let n;var i,s,r;"object"===e?n=md(t):"string"===e&&(r=(i=t).length,"#"===i[0]&&(4===r||5===r?s={r:255&17*Gu[i[1]],g:255&17*Gu[i[2]],b:255&17*Gu[i[3]],a:5===r?17*Gu[i[4]]:255}:7!==r&&9!==r||(s={r:Gu[i[1]]<<4|Gu[i[2]],g:Gu[i[3]]<<4|Gu[i[4]],b:Gu[i[5]]<<4|Gu[i[6]],a:9===r?Gu[i[7]]<<4|Gu[i[8]]:255})),n=s||function(t){hd||(hd=function(){const t={},e=Object.keys(cd),n=Object.keys(ld);let i,s,r,o,a;for(i=0;i<e.length;i++){for(o=a=e[i],s=0;s<n.length;s++)r=n[s],a=a.replace(r,ld[r]);r=parseInt(cd[o],16),t[a]=[r>>16&255,r>>8&255,255&r]}return t}(),hd.transparent=[0,0,0,0]);const e=hd[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:4===e.length?e[3]:255}}(t)||_d(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=gd(this._rgb);return t&&(t.a=Ku(t.a)),t}set rgb(t){this._rgb=md(t)}rgbString(){return this._valid?(t=this._rgb)&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Ku(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`):void 0;var t}hexString(){return this._valid?(t=this._rgb,e=(t=>Zu(t.r)&&Zu(t.g)&&Zu(t.b)&&Zu(t.a))(t)?Xu:Qu,t?"#"+e(t.r)+e(t.g)+e(t.b)+((t,e)=>t<255?e(t):"")(t.a,e):void 0):void 0;var t,e}hslString(){return this._valid?function(t){if(!t)return;const e=sd(t),n=e[0],i=Yu(e[1]),s=Yu(e[2]);return t.a<255?`hsla(${n}, ${i}%, ${s}%, ${Ku(t.a)})`:`hsl(${n}, ${i}%, ${s}%)`}(this._rgb):void 0}mix(t,e){if(t){const n=this.rgb,i=t.rgb;let s;const r=e===s?.5:e,o=2*r-1,a=n.a-i.a,l=((o*a==-1?o:(o+a)/(1+o*a))+1)/2;s=1-l,n.r=255&l*n.r+s*i.r+.5,n.g=255&l*n.g+s*i.g+.5,n.b=255&l*n.b+s*i.b+.5,n.a=r*n.a+(1-r)*i.a,this.rgb=n}return this}interpolate(t,e){return t&&(this._rgb=function(t,e,n){const i=pd(Ku(t.r)),s=pd(Ku(t.g)),r=pd(Ku(t.b));return{r:$u(dd(i+n*(pd(Ku(e.r))-i))),g:$u(dd(s+n*(pd(Ku(e.g))-s))),b:$u(dd(r+n*(pd(Ku(e.b))-r))),a:t.a+n*(e.a-t.a)}}(this._rgb,t._rgb,e)),this}clone(){return new yd(this.rgb)}alpha(t){return this._rgb.a=$u(t),this}clearer(t){return this._rgb.a*=1-t,this}greyscale(){const t=this._rgb,e=Bu(.3*t.r+.59*t.g+.11*t.b);return t.r=t.g=t.b=e,this}opaquer(t){return this._rgb.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return fd(this._rgb,2,t),this}darken(t){return fd(this._rgb,2,-t),this}saturate(t){return fd(this._rgb,1,t),this}desaturate(t){return fd(this._rgb,1,-t),this}rotate(t){return function(t,e){var n=sd(t);n[0]=ad(n[0]+e),n=od(n),t.r=n[0],t.g=n[1],t.b=n[2]}(this._rgb,t),this}}function vd(){}const bd=(()=>{let t=0;return()=>t++})();function wd(t){return null==t}function xd(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return"[object"===e.slice(0,7)&&"Array]"===e.slice(-6)}function kd(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)}function Cd(t){return("number"==typeof t||t instanceof Number)&&isFinite(+t)}function Id(t,e){return Cd(t)?t:e}function Td(t,e){return void 0===t?e:t}const Sd=(t,e)=>"string"==typeof t&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Ed(t,e,n){if(t&&"function"==typeof t.call)return t.apply(n,e)}function Pd(t,e,n,i){let s,r,o;if(xd(t))if(r=t.length,i)for(s=r-1;s>=0;s--)e.call(n,t[s],s);else for(s=0;s<r;s++)e.call(n,t[s],s);else if(kd(t))for(o=Object.keys(t),r=o.length,s=0;s<r;s++)e.call(n,t[o[s]],o[s])}function Md(t,e){let n,i,s,r;if(!t||!e||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;++n)if(s=t[n],r=e[n],s.datasetIndex!==r.datasetIndex||s.index!==r.index)return!1;return!0}function Rd(t){if(xd(t))return t.map(Rd);if(kd(t)){const e=Object.create(null),n=Object.keys(t),i=n.length;let s=0;for(;s<i;++s)e[n[s]]=Rd(t[n[s]]);return e}return t}function Od(t){return-1===["__proto__","prototype","constructor"].indexOf(t)}function Ad(t,e,n,i){if(!Od(t))return;const s=e[t],r=n[t];kd(s)&&kd(r)?Dd(s,r,i):e[t]=Rd(r)}function Dd(t,e,n){const i=xd(e)?e:[e],s=i.length;if(!kd(t))return t;const r=(n=n||{}).merger||Ad;let o;for(let e=0;e<s;++e){if(o=i[e],!kd(o))continue;const s=Object.keys(o);for(let e=0,i=s.length;e<i;++e)r(s[e],t,o,n)}return t}function Nd(t,e){return Dd(t,e,{merger:Ld})}function Ld(t,e,n){if(!Od(t))return;const i=e[t],s=n[t];kd(i)&&kd(s)?Nd(i,s):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Rd(s))}const Fd={"":t=>t,x:t=>t.x,y:t=>t.y};function zd(t,e){const n=Fd[e]||(Fd[e]=function(t){const e=function(t){const e=t.split("."),n=[];let i="";for(const t of e)i+=t,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}(t);return t=>{for(const n of e){if(""===n)break;t=t&&t[n]}return t}}(e));return n(t)}function jd(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Vd=t=>void 0!==t,Ud=t=>"function"==typeof t,Wd=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0},Bd=Math.PI,Hd=2*Bd,qd=Hd+Bd,$d=Number.POSITIVE_INFINITY,Kd=Bd/180,Yd=Bd/2,Gd=Bd/4,Jd=2*Bd/3,Xd=Math.log10,Qd=Math.sign;function Zd(t,e,n){return Math.abs(t-e)<n}function tp(t){const e=Math.round(t);t=Zd(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(Xd(t))),i=t/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function ep(t){return!isNaN(parseFloat(t))&&isFinite(t)}function np(t,e,n){let i,s,r;for(i=0,s=t.length;i<s;i++)r=t[i][n],isNaN(r)||(e.min=Math.min(e.min,r),e.max=Math.max(e.max,r))}function ip(t){return t*(Bd/180)}function sp(t){return t*(180/Bd)}function rp(t){if(!Cd(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function op(t,e){const n=e.x-t.x,i=e.y-t.y,s=Math.sqrt(n*n+i*i);let r=Math.atan2(i,n);return r<-.5*Bd&&(r+=Hd),{angle:r,distance:s}}function ap(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function lp(t,e){return(t-e+qd)%Hd-Bd}function cp(t){return(t%Hd+Hd)%Hd}function hp(t,e,n,i){const s=cp(t),r=cp(e),o=cp(n),a=cp(r-s),l=cp(o-s),c=cp(s-r),h=cp(s-o);return s===r||s===o||i&&r===o||a>l&&c<h}function up(t,e,n){return Math.max(e,Math.min(n,t))}function dp(t,e,n,i=1e-6){return t>=Math.min(e,n)-i&&t<=Math.max(e,n)+i}function pp(t,e,n){n=n||(n=>t[n]<e);let i,s=t.length-1,r=0;for(;s-r>1;)i=r+s>>1,n(i)?r=i:s=i;return{lo:r,hi:s}}const fp=(t,e,n,i)=>pp(t,n,i?i=>{const s=t[i][e];return s<n||s===n&&t[i+1][e]===n}:i=>t[i][e]<n),gp=(t,e,n)=>pp(t,n,(i=>t[i][e]>=n)),mp=["push","pop","shift","splice","unshift"];function _p(t,e){const n=t._chartjs;if(!n)return;const i=n.listeners,s=i.indexOf(e);-1!==s&&i.splice(s,1),i.length>0||(mp.forEach((e=>{delete t[e]})),delete t._chartjs)}function yp(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const vp="undefined"==typeof window?function(t){return t()}:window.requestAnimationFrame;function bp(t,e){let n=[],i=!1;return function(...s){n=s,i||(i=!0,vp.call(window,(()=>{i=!1,t.apply(e,n)})))}}const wp=t=>"start"===t?"left":"end"===t?"right":"center",xp=(t,e,n)=>"start"===t?e:"end"===t?n:(e+n)/2;function kp(t,e,n){const i=e.length;let s=0,r=i;if(t._sorted){const{iScale:o,_parsed:a}=t,l=o.axis,{min:c,max:h,minDefined:u,maxDefined:d}=o.getUserBounds();u&&(s=up(Math.min(fp(a,l,c).lo,n?i:fp(e,l,o.getPixelForValue(c)).lo),0,i-1)),r=d?up(Math.max(fp(a,o.axis,h,!0).hi+1,n?0:fp(e,l,o.getPixelForValue(h),!0).hi+1),s,i)-s:i-s}return{start:s,count:r}}function Cp(t){const{xScale:e,yScale:n,_scaleRanges:i}=t,s={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!i)return t._scaleRanges=s,!0;const r=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,s),r}const Ip=t=>0===t||1===t,Tp=(t,e,n)=>-Math.pow(2,10*(t-=1))*Math.sin((t-e)*Hd/n),Sp=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Hd/n)+1,Ep={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>1-Math.cos(t*Yd),easeOutSine:t=>Math.sin(t*Yd),easeInOutSine:t=>-.5*(Math.cos(Bd*t)-1),easeInExpo:t=>0===t?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>1===t?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>Ip(t)?t:t<.5?.5*Math.pow(2,10*(2*t-1)):.5*(2-Math.pow(2,-10*(2*t-1))),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Ip(t)?t:Tp(t,.075,.3),easeOutElastic:t=>Ip(t)?t:Sp(t,.075,.3),easeInOutElastic(t){const e=.1125;return Ip(t)?t:t<.5?.5*Tp(2*t,e,.45):.5+.5*Sp(2*t-1,e,.45)},easeInBack(t){const e=1.70158;return t*t*((e+1)*t-e)},easeOutBack(t){const e=1.70158;return(t-=1)*t*((e+1)*t+e)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},easeInBounce:t=>1-Ep.easeOutBounce(1-t),easeOutBounce(t){const e=7.5625,n=2.75;return t<1/n?e*t*t:t<2/n?e*(t-=1.5/n)*t+.75:t<2.5/n?e*(t-=2.25/n)*t+.9375:e*(t-=2.625/n)*t+.984375},easeInOutBounce:t=>t<.5?.5*Ep.easeInBounce(2*t):.5*Ep.easeOutBounce(2*t-1)+.5};function Pp(t){if(t&&"object"==typeof t){const e=t.toString();return"[object CanvasPattern]"===e||"[object CanvasGradient]"===e}return!1}function Mp(t){return Pp(t)?t:new yd(t)}function Rp(t){return Pp(t)?t:new yd(t).saturate(.5).darken(.1).hexString()}const Op=["x","y","borderWidth","radius","tension"],Ap=["color","borderColor","backgroundColor"],Dp=new Map;function Np(t,e,n){return function(t,e){e=e||{};const n=t+JSON.stringify(e);let i=Dp.get(n);return i||(i=new Intl.NumberFormat(t,e),Dp.set(n,i)),i}(e,n).format(t)}const Lp={values:t=>xd(t)?t:""+t,numeric(t,e,n){if(0===t)return"0";const i=this.chart.options.locale;let s,r=t;if(n.length>1){const e=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(e<1e-4||e>1e15)&&(s="scientific"),r=function(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}(t,n)}const o=Xd(Math.abs(r)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),Np(t,i,l)},logarithmic(t,e,n){if(0===t)return"0";const i=n[e].significand||t/Math.pow(10,Math.floor(Xd(t)));return[1,2,3,5,10,15].includes(i)||e>.8*n.length?Lp.numeric.call(this,t,e,n):""}};var Fp={formatters:Lp};const zp=Object.create(null),jp=Object.create(null);function Vp(t,e){if(!e)return t;const n=e.split(".");for(let e=0,i=n.length;e<i;++e){const i=n[e];t=t[i]||(t[i]=Object.create(null))}return t}function Up(t,e,n){return"string"==typeof e?Dd(Vp(t,e),n):Dd(Vp(t,""),e)}class Wp{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=t=>t.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(t,e)=>Rp(e.backgroundColor),this.hoverBorderColor=(t,e)=>Rp(e.borderColor),this.hoverColor=(t,e)=>Rp(e.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return Up(this,t,e)}get(t){return Vp(this,t)}describe(t,e){return Up(jp,t,e)}override(t,e){return Up(zp,t,e)}route(t,e,n,i){const s=Vp(this,t),r=Vp(this,n),o="_"+e;Object.defineProperties(s,{[o]:{value:s[e],writable:!0},[e]:{enumerable:!0,get(){const t=this[o],e=r[i];return kd(t)?Object.assign({},e,t):Td(t,e)},set(t){this[o]=t}}})}apply(t){t.forEach((t=>t(this)))}}var Bp=new Wp({_scriptable:t=>!t.startsWith("on"),_indexable:t=>"events"!==t,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>"onProgress"!==t&&"onComplete"!==t&&"fn"!==t}),t.set("animations",{colors:{type:"color",properties:Ap},numbers:{type:"number",properties:Op}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>0|t}}}})},function(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Fp.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&"callback"!==t&&"parser"!==t,_indexable:t=>"borderDash"!==t&&"tickBorderDash"!==t&&"dash"!==t}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:t=>"backdropPadding"!==t&&"callback"!==t,_indexable:t=>"backdropPadding"!==t})}]);function Hp(t,e,n,i,s){let r=e[s];return r||(r=e[s]=t.measureText(s).width,n.push(s)),r>i&&(i=r),i}function qp(t,e,n,i){let s=(i=i||{}).data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(s=i.data={},r=i.garbageCollect=[],i.font=e),t.save(),t.font=e;let o=0;const a=n.length;let l,c,h,u,d;for(l=0;l<a;l++)if(u=n[l],null==u||xd(u)){if(xd(u))for(c=0,h=u.length;c<h;c++)d=u[c],null==d||xd(d)||(o=Hp(t,s,r,o,d))}else o=Hp(t,s,r,o,u);t.restore();const p=r.length/2;if(p>n.length){for(l=0;l<p;l++)delete s[r[l]];r.splice(0,p)}return o}function $p(t,e,n){const i=t.currentDevicePixelRatio,s=0!==n?Math.max(n/2,.5):0;return Math.round((e-s)*i)/i+s}function Kp(t,e){(e||t)&&((e=e||t.getContext("2d")).save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function Yp(t,e,n,i){Gp(t,e,n,i,null)}function Gp(t,e,n,i,s){let r,o,a,l,c,h,u,d;const p=e.pointStyle,f=e.rotation,g=e.radius;let m=(f||0)*Kd;if(p&&"object"==typeof p&&(r=p.toString(),"[object HTMLImageElement]"===r||"[object HTMLCanvasElement]"===r))return t.save(),t.translate(n,i),t.rotate(m),t.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),void t.restore();if(!(isNaN(g)||g<=0)){switch(t.beginPath(),p){default:s?t.ellipse(n,i,s/2,g,0,0,Hd):t.arc(n,i,g,0,Hd),t.closePath();break;case"triangle":h=s?s/2:g,t.moveTo(n+Math.sin(m)*h,i-Math.cos(m)*g),m+=Jd,t.lineTo(n+Math.sin(m)*h,i-Math.cos(m)*g),m+=Jd,t.lineTo(n+Math.sin(m)*h,i-Math.cos(m)*g),t.closePath();break;case"rectRounded":c=.516*g,l=g-c,o=Math.cos(m+Gd)*l,u=Math.cos(m+Gd)*(s?s/2-c:l),a=Math.sin(m+Gd)*l,d=Math.sin(m+Gd)*(s?s/2-c:l),t.arc(n-u,i-a,c,m-Bd,m-Yd),t.arc(n+d,i-o,c,m-Yd,m),t.arc(n+u,i+a,c,m,m+Yd),t.arc(n-d,i+o,c,m+Yd,m+Bd),t.closePath();break;case"rect":if(!f){l=Math.SQRT1_2*g,h=s?s/2:l,t.rect(n-h,i-l,2*h,2*l);break}m+=Gd;case"rectRot":u=Math.cos(m)*(s?s/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),t.moveTo(n-u,i-a),t.lineTo(n+d,i-o),t.lineTo(n+u,i+a),t.lineTo(n-d,i+o),t.closePath();break;case"crossRot":m+=Gd;case"cross":u=Math.cos(m)*(s?s/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),t.moveTo(n-u,i-a),t.lineTo(n+u,i+a),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o);break;case"star":u=Math.cos(m)*(s?s/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),t.moveTo(n-u,i-a),t.lineTo(n+u,i+a),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o),m+=Gd,u=Math.cos(m)*(s?s/2:g),o=Math.cos(m)*g,a=Math.sin(m)*g,d=Math.sin(m)*(s?s/2:g),t.moveTo(n-u,i-a),t.lineTo(n+u,i+a),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o);break;case"line":o=s?s/2:Math.cos(m)*g,a=Math.sin(m)*g,t.moveTo(n-o,i-a),t.lineTo(n+o,i+a);break;case"dash":t.moveTo(n,i),t.lineTo(n+Math.cos(m)*(s?s/2:g),i+Math.sin(m)*g);break;case!1:t.closePath()}t.fill(),e.borderWidth>0&&t.stroke()}}function Jp(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function Xp(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function Qp(t){t.restore()}function Zp(t,e,n,i,s){if(!e)return t.lineTo(n.x,n.y);if("middle"===s){const i=(e.x+n.x)/2;t.lineTo(i,e.y),t.lineTo(i,n.y)}else"after"===s!=!!i?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function tf(t,e,n,i){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function ef(t,e,n,i,s){if(s.strikethrough||s.underline){const r=t.measureText(i),o=e-r.actualBoundingBoxLeft,a=e+r.actualBoundingBoxRight,l=n-r.actualBoundingBoxAscent,c=n+r.actualBoundingBoxDescent,h=s.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=s.decorationWidth||2,t.moveTo(o,h),t.lineTo(a,h),t.stroke()}}function nf(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function sf(t,e,n,i,s,r={}){const o=xd(e)?e:[e],a=r.strokeWidth>0&&""!==r.strokeColor;let l,c;for(t.save(),t.font=s.string,function(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),wd(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}(t,r),l=0;l<o.length;++l)c=o[l],r.backdrop&&nf(t,r.backdrop),a&&(r.strokeColor&&(t.strokeStyle=r.strokeColor),wd(r.strokeWidth)||(t.lineWidth=r.strokeWidth),t.strokeText(c,n,i,r.maxWidth)),t.fillText(c,n,i,r.maxWidth),ef(t,n,i,c,r),i+=Number(s.lineHeight);t.restore()}function rf(t,e){const{x:n,y:i,w:s,h:r,radius:o}=e;t.arc(n+o.topLeft,i+o.topLeft,o.topLeft,1.5*Bd,Bd,!0),t.lineTo(n,i+r-o.bottomLeft),t.arc(n+o.bottomLeft,i+r-o.bottomLeft,o.bottomLeft,Bd,Yd,!0),t.lineTo(n+s-o.bottomRight,i+r),t.arc(n+s-o.bottomRight,i+r-o.bottomRight,o.bottomRight,Yd,0,!0),t.lineTo(n+s,i+o.topRight),t.arc(n+s-o.topRight,i+o.topRight,o.topRight,0,-Yd,!0),t.lineTo(n+o.topLeft,i)}const of=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,af=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function lf(t,e){const n=(""+t).match(of);if(!n||"normal"===n[1])return 1.2*e;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100}return e*t}const cf=t=>+t||0;function hf(t,e){const n={},i=kd(e),s=i?Object.keys(e):e,r=kd(t)?i?n=>Td(t[n],t[e[n]]):e=>t[e]:()=>t;for(const t of s)n[t]=cf(r(t));return n}function uf(t){return hf(t,{top:"y",right:"x",bottom:"y",left:"x"})}function df(t){return hf(t,["topLeft","topRight","bottomLeft","bottomRight"])}function pf(t){const e=uf(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function ff(t,e){t=t||{},e=e||Bp.font;let n=Td(t.size,e.size);"string"==typeof n&&(n=parseInt(n,10));let i=Td(t.style,e.style);i&&!(""+i).match(af)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const s={family:Td(t.family,e.family),lineHeight:lf(Td(t.lineHeight,e.lineHeight),n),size:n,style:i,weight:Td(t.weight,e.weight),string:""};return s.string=function(t){return!t||wd(t.size)||wd(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}(s),s}function gf(t,e,n,i){let s,r,o,a=!0;for(s=0,r=t.length;s<r;++s)if(o=t[s],void 0!==o&&(void 0!==e&&"function"==typeof o&&(o=o(e),a=!1),void 0!==n&&xd(o)&&(o=o[n%o.length],a=!1),void 0!==o))return i&&!a&&(i.cacheable=!1),o}function mf(t,e){return Object.assign(Object.create(t),e)}function _f(t,e=[""],n,i,s=()=>t[0]){const r=n||t;void 0===i&&(i=Ef("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:r,_fallback:i,_getTarget:s,override:n=>_f([n,...t],e,r,i)};return new Proxy(o,{deleteProperty:(e,n)=>(delete e[n],delete e._keys,delete t[0][n],!0),get:(n,i)=>xf(n,i,(()=>function(t,e,n,i){let s;for(const r of e)if(s=Ef(bf(r,t),n),void 0!==s)return wf(t,s)?Tf(n,i,t,s):s}(i,e,t,n))),getOwnPropertyDescriptor:(t,e)=>Reflect.getOwnPropertyDescriptor(t._scopes[0],e),getPrototypeOf:()=>Reflect.getPrototypeOf(t[0]),has:(t,e)=>Pf(t).includes(e),ownKeys:t=>Pf(t),set(t,e,n){const i=t._storage||(t._storage=s());return t[e]=i[e]=n,delete t._keys,!0}})}function yf(t,e,n,i){const s={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:vf(t,i),setContext:e=>yf(t,e,n,i),override:s=>yf(t.override(s),e,n,i)};return new Proxy(s,{deleteProperty:(e,n)=>(delete e[n],delete t[n],!0),get:(t,e,n)=>xf(t,e,(()=>function(t,e,n){const{_proxy:i,_context:s,_subProxy:r,_descriptors:o}=t;let a=i[e];return Ud(a)&&o.isScriptable(e)&&(a=function(t,e,n,i){const{_proxy:s,_context:r,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(r,o||i);return a.delete(t),wf(t,l)&&(l=Tf(s._scopes,s,t,l)),l}(e,a,t,n)),xd(a)&&a.length&&(a=function(t,e,n,i){const{_proxy:s,_context:r,_subProxy:o,_descriptors:a}=n;if(void 0!==r.index&&i(t))return e[r.index%e.length];if(kd(e[0])){const n=e,i=s._scopes.filter((t=>t!==n));e=[];for(const l of n){const n=Tf(i,s,t,l);e.push(yf(n,r,o&&o[t],a))}}return e}(e,a,t,o.isIndexable)),wf(e,a)&&(a=yf(a,s,r&&r[e],o)),a}(t,e,n))),getOwnPropertyDescriptor:(e,n)=>e._descriptors.allKeys?Reflect.has(t,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,n),getPrototypeOf:()=>Reflect.getPrototypeOf(t),has:(e,n)=>Reflect.has(t,n),ownKeys:()=>Reflect.ownKeys(t),set:(e,n,i)=>(t[n]=i,delete e[n],!0)})}function vf(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:i=e.indexable,_allKeys:s=e.allKeys}=t;return{allKeys:s,scriptable:n,indexable:i,isScriptable:Ud(n)?n:()=>n,isIndexable:Ud(i)?i:()=>i}}const bf=(t,e)=>t?t+jd(e):e,wf=(t,e)=>kd(e)&&"adapters"!==t&&(null===Object.getPrototypeOf(e)||e.constructor===Object);function xf(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||"constructor"===e)return t[e];const i=n();return t[e]=i,i}function kf(t,e,n){return Ud(t)?t(e,n):t}const Cf=(t,e)=>!0===t?e:"string"==typeof t?zd(e,t):void 0;function If(t,e,n,i,s){for(const r of e){const e=Cf(n,r);if(e){t.add(e);const r=kf(e._fallback,n,s);if(void 0!==r&&r!==n&&r!==i)return r}else if(!1===e&&void 0!==i&&n!==i)return null}return!1}function Tf(t,e,n,i){const s=e._rootScopes,r=kf(e._fallback,n,i),o=[...t,...s],a=new Set;a.add(i);let l=Sf(a,o,n,r||n,i);return null!==l&&(void 0===r||r===n||(l=Sf(a,o,r,l,i),null!==l))&&_f(Array.from(a),[""],s,r,(()=>function(t,e,n){const i=t._getTarget();e in i||(i[e]={});const s=i[e];return xd(s)&&kd(n)?n:s||{}}(e,n,i)))}function Sf(t,e,n,i,s){for(;n;)n=If(t,e,n,i,s);return n}function Ef(t,e){for(const n of e){if(!n)continue;const e=n[t];if(void 0!==e)return e}}function Pf(t){let e=t._keys;return e||(e=t._keys=function(t){const e=new Set;for(const n of t)for(const t of Object.keys(n).filter((t=>!t.startsWith("_"))))e.add(t);return Array.from(e)}(t._scopes)),e}function Mf(t,e,n,i){const{iScale:s}=t,{key:r="r"}=this._parsing,o=new Array(i);let a,l,c,h;for(a=0,l=i;a<l;++a)c=a+n,h=e[c],o[a]={r:s.parse(zd(h,r),c)};return o}const Rf=Number.EPSILON||1e-14,Of=(t,e)=>e<t.length&&!t[e].skip&&t[e],Af=t=>"x"===t?"y":"x";function Df(t,e,n,i){const s=t.skip?e:t,r=e,o=n.skip?e:n,a=ap(r,s),l=ap(o,r);let c=a/(a+l),h=l/(a+l);c=isNaN(c)?0:c,h=isNaN(h)?0:h;const u=i*c,d=i*h;return{previous:{x:r.x-u*(o.x-s.x),y:r.y-u*(o.y-s.y)},next:{x:r.x+d*(o.x-s.x),y:r.y+d*(o.y-s.y)}}}function Nf(t,e,n){return Math.max(Math.min(t,n),e)}function Lf(t,e,n,i,s){let r,o,a,l;if(e.spanGaps&&(t=t.filter((t=>!t.skip))),"monotone"===e.cubicInterpolationMode)!function(t,e="x"){const n=Af(e),i=t.length,s=Array(i).fill(0),r=Array(i);let o,a,l,c=Of(t,0);for(o=0;o<i;++o)if(a=l,l=c,c=Of(t,o+1),l){if(c){const t=c[e]-l[e];s[o]=0!==t?(c[n]-l[n])/t:0}r[o]=a?c?Qd(s[o-1])!==Qd(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}!function(t,e,n){const i=t.length;let s,r,o,a,l,c=Of(t,0);for(let h=0;h<i-1;++h)l=c,c=Of(t,h+1),l&&c&&(Zd(e[h],0,Rf)?n[h]=n[h+1]=0:(s=n[h]/e[h],r=n[h+1]/e[h],a=Math.pow(s,2)+Math.pow(r,2),a<=9||(o=3/Math.sqrt(a),n[h]=s*o*e[h],n[h+1]=r*o*e[h])))}(t,s,r),function(t,e,n="x"){const i=Af(n),s=t.length;let r,o,a,l=Of(t,0);for(let c=0;c<s;++c){if(o=a,a=l,l=Of(t,c+1),!a)continue;const s=a[n],h=a[i];o&&(r=(s-o[n])/3,a[`cp1${n}`]=s-r,a[`cp1${i}`]=h-r*e[c]),l&&(r=(l[n]-s)/3,a[`cp2${n}`]=s+r,a[`cp2${i}`]=h+r*e[c])}}(t,r,e)}(t,s);else{let n=i?t[t.length-1]:t[0];for(r=0,o=t.length;r<o;++r)a=t[r],l=Df(n,a,t[Math.min(r+1,o-(i?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,n=a}e.capBezierPoints&&function(t,e){let n,i,s,r,o,a=Jp(t[0],e);for(n=0,i=t.length;n<i;++n)o=r,r=a,a=n<i-1&&Jp(t[n+1],e),r&&(s=t[n],o&&(s.cp1x=Nf(s.cp1x,e.left,e.right),s.cp1y=Nf(s.cp1y,e.top,e.bottom)),a&&(s.cp2x=Nf(s.cp2x,e.left,e.right),s.cp2y=Nf(s.cp2y,e.top,e.bottom)))}(t,n)}function Ff(){return"undefined"!=typeof window&&"undefined"!=typeof document}function zf(t){let e=t.parentNode;return e&&"[object ShadowRoot]"===e.toString()&&(e=e.host),e}function jf(t,e,n){let i;return"string"==typeof t?(i=parseInt(t,10),-1!==t.indexOf("%")&&(i=i/100*e.parentNode[n])):i=t,i}const Vf=t=>t.ownerDocument.defaultView.getComputedStyle(t,null),Uf=["top","right","bottom","left"];function Wf(t,e,n){const i={};n=n?"-"+n:"";for(let s=0;s<4;s++){const r=Uf[s];i[r]=parseFloat(t[e+"-"+r+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const Bf=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function Hf(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:i}=e,s=Vf(n),r="border-box"===s.boxSizing,o=Wf(s,"padding"),a=Wf(s,"border","width"),{x:l,y:c,box:h}=function(t,e){const n=t.touches,i=n&&n.length?n[0]:t,{offsetX:s,offsetY:r}=i;let o,a,l=!1;if(Bf(s,r,t.target))o=s,a=r;else{const t=e.getBoundingClientRect();o=i.clientX-t.left,a=i.clientY-t.top,l=!0}return{x:o,y:a,box:l}}(t,n),u=o.left+(h&&a.left),d=o.top+(h&&a.top);let{width:p,height:f}=e;return r&&(p-=o.width+a.width,f-=o.height+a.height),{x:Math.round((l-u)/p*n.width/i),y:Math.round((c-d)/f*n.height/i)}}const qf=t=>Math.round(10*t)/10;function $f(t,e,n){const i=e||1,s=Math.floor(t.height*i),r=Math.floor(t.width*i);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),(t.currentDevicePixelRatio!==i||o.height!==s||o.width!==r)&&(t.currentDevicePixelRatio=i,o.height=s,o.width=r,t.ctx.setTransform(i,0,0,i,0,0),!0)}const Kf=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};Ff()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch(t){}return t}();function Yf(t,e){const n=function(t,e){return Vf(t).getPropertyValue(e)}(t,e),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Gf(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function Jf(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:"middle"===i?n<.5?t.y:e.y:"after"===i?n<1?t.y:e.y:n>0?e.y:t.y}}function Xf(t,e,n,i){const s={x:t.cp2x,y:t.cp2y},r={x:e.cp1x,y:e.cp1y},o=Gf(t,s,n),a=Gf(s,r,n),l=Gf(r,e,n),c=Gf(o,a,n),h=Gf(a,l,n);return Gf(c,h,n)}function Qf(t,e,n){return t?function(t,e){return{x:n=>t+t+e-n,setWidth(t){e=t},textAlign:t=>"center"===t?t:"right"===t?"left":"right",xPlus:(t,e)=>t-e,leftForLtr:(t,e)=>t-e}}(e,n):{x:t=>t,setWidth(t){},textAlign:t=>t,xPlus:(t,e)=>t+e,leftForLtr:(t,e)=>t}}function Zf(t,e){let n,i;"ltr"!==e&&"rtl"!==e||(n=t.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=i)}function tg(t,e){void 0!==e&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function eg(t){return"angle"===t?{between:hp,compare:lp,normalize:cp}:{between:dp,compare:(t,e)=>t-e,normalize:t=>t}}function ng({start:t,end:e,count:n,loop:i,style:s}){return{start:t%n,end:e%n,loop:i&&(e-t+1)%n==0,style:s}}function ig(t,e,n){if(!n)return[t];const{property:i,start:s,end:r}=n,o=e.length,{compare:a,between:l,normalize:c}=eg(i),{start:h,end:u,loop:d,style:p}=function(t,e,n){const{property:i,start:s,end:r}=n,{between:o,normalize:a}=eg(i),l=e.length;let c,h,{start:u,end:d,loop:p}=t;if(p){for(u+=l,d+=l,c=0,h=l;c<h&&o(a(e[u%l][i]),s,r);++c)u--,d--;u%=l,d%=l}return d<u&&(d+=l),{start:u,end:d,loop:p,style:t.style}}(t,e,n),f=[];let g,m,_,y=!1,v=null;for(let t=h,n=h;t<=u;++t)m=e[t%o],m.skip||(g=c(m[i]),g!==_&&(y=l(g,s,r),null===v&&(y||l(s,_,g)&&0!==a(s,_))&&(v=0===a(g,s)?t:n),null!==v&&(!y||0===a(r,g)||l(r,_,g))&&(f.push(ng({start:v,end:t,loop:d,count:o,style:p})),v=null),n=t,_=g));return null!==v&&f.push(ng({start:v,end:u,loop:d,count:o,style:p})),f}function sg(t,e){const n=[],i=t.segments;for(let s=0;s<i.length;s++){const r=ig(i[s],t.points,e);r.length&&n.push(...r)}return n}function rg(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function og(t,e){if(!e)return!1;const n=[],i=function(t,e){return Pp(e)?(n.includes(e)||n.push(e),n.indexOf(e)):e};return JSON.stringify(t,i)!==JSON.stringify(e,i)}class ag{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,n,i){const s=e.listeners[i],r=e.duration;s.forEach((i=>i({chart:t,initial:e.initial,numSteps:r,currentStep:Math.min(n-e.start,r)})))}_refresh(){this._request||(this._running=!0,this._request=vp.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(t=Date.now()){let e=0;this._charts.forEach(((n,i)=>{if(!n.running||!n.items.length)return;const s=n.items;let r,o=s.length-1,a=!1;for(;o>=0;--o)r=s[o],r._active?(r._total>n.duration&&(n.duration=r._total),r.tick(t),a=!0):(s[o]=s[s.length-1],s.pop());a&&(i.draw(),this._notify(i,n,t,"progress")),s.length||(n.running=!1,this._notify(i,n,t,"complete"),n.initial=!1),e+=s.length})),this._lastDate=t,0===e&&(this._running=!1)}_getAnims(t){const e=this._charts;let n=e.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,n)),n}listen(t,e,n){this._getAnims(t).listeners[e].push(n)}add(t,e){e&&e.length&&this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce(((t,e)=>Math.max(t,e._duration)),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!!(e&&e.running&&e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const n=e.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var lg=new ag;const cg="transparent",hg={boolean:(t,e,n)=>n>.5?e:t,color(t,e,n){const i=Mp(t||cg),s=i.valid&&Mp(e||cg);return s&&s.valid?s.mix(i,n).hexString():e},number:(t,e,n)=>t+(e-t)*n};class ug{constructor(t,e,n,i){const s=e[n];i=gf([t.to,i,s,t.from]);const r=gf([t.from,s,i]);this._active=!0,this._fn=t.fn||hg[t.type||typeof r],this._easing=Ep[t.easing]||Ep.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=n,this._from=r,this._to=i,this._promises=void 0}active(){return this._active}update(t,e,n){if(this._active){this._notify(!1);const i=this._target[this._prop],s=n-this._start,r=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(r,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=gf([t.to,e,i,t.from]),this._from=gf([t.from,i,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,n=this._duration,i=this._prop,s=this._from,r=this._loop,o=this._to;let a;if(this._active=s!==o&&(r||e<n),!this._active)return this._target[i]=o,void this._notify(!0);e<0?this._target[i]=s:(a=e/n%2,a=r&&a>1?2-a:a,a=this._easing(Math.min(1,Math.max(0,a))),this._target[i]=this._fn(s,o,a))}wait(){const t=this._promises||(this._promises=[]);return new Promise(((e,n)=>{t.push({res:e,rej:n})}))}_notify(t){const e=t?"res":"rej",n=this._promises||[];for(let t=0;t<n.length;t++)n[t][e]()}}class dg{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!kd(t))return;const e=Object.keys(Bp.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach((i=>{const s=t[i];if(!kd(s))return;const r={};for(const t of e)r[t]=s[t];(xd(s.properties)&&s.properties||[i]).forEach((t=>{t!==i&&n.has(t)||n.set(t,r)}))}))}_animateOptions(t,e){const n=e.options,i=function(t,e){if(!e)return;let n=t.options;if(n)return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n;t.options=e}(t,n);if(!i)return[];const s=this._createAnimations(i,n);return n.$shared&&function(t,e){const n=[],i=Object.keys(e);for(let e=0;e<i.length;e++){const s=t[i[e]];s&&s.active()&&n.push(s.wait())}return Promise.all(n)}(t.options.$animations,n).then((()=>{t.options=n}),(()=>{})),s}_createAnimations(t,e){const n=this._properties,i=[],s=t.$animations||(t.$animations={}),r=Object.keys(e),o=Date.now();let a;for(a=r.length-1;a>=0;--a){const l=r[a];if("$"===l.charAt(0))continue;if("options"===l){i.push(...this._animateOptions(t,e));continue}const c=e[l];let h=s[l];const u=n.get(l);if(h){if(u&&h.active()){h.update(u,c,o);continue}h.cancel()}u&&u.duration?(s[l]=h=new ug(u,t,l,c),i.push(h)):t[l]=c}return i}update(t,e){if(0===this._properties.size)return void Object.assign(t,e);const n=this._createAnimations(t,e);return n.length?(lg.add(this._chart,n),!0):void 0}}function pg(t,e){const n=t&&t.options||{},i=n.reverse,s=void 0===n.min?e:0,r=void 0===n.max?e:0;return{start:i?r:s,end:i?s:r}}function fg(t,e){const n=[],i=t._getSortedDatasetMetas(e);let s,r;for(s=0,r=i.length;s<r;++s)n.push(i[s].index);return n}function gg(t,e,n,i={}){const s=t.keys,r="single"===i.mode;let o,a,l,c;if(null!==e){for(o=0,a=s.length;o<a;++o){if(l=+s[o],l===n){if(i.all)continue;break}c=t.values[l],Cd(c)&&(r||0===e||Qd(e)===Qd(c))&&(e+=c)}return e}}function mg(t,e){const n=t&&t.options.stacked;return n||void 0===n&&void 0!==e.stack}function _g(t,e,n){const i=t[e]||(t[e]={});return i[n]||(i[n]={})}function yg(t,e,n,i){for(const s of e.getMatchingVisibleMetas(i).reverse()){const e=t[s.index];if(n&&e>0||!n&&e<0)return s.index}return null}function vg(t,e){const{chart:n,_cachedMeta:i}=t,s=n._stacks||(n._stacks={}),{iScale:r,vScale:o,index:a}=i,l=r.axis,c=o.axis,h=function(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}(r,o,i),u=e.length;let d;for(let t=0;t<u;++t){const n=e[t],{[l]:r,[c]:u}=n;d=(n._stacks||(n._stacks={}))[c]=_g(s,h,r),d[a]=u,d._top=yg(d,o,!0,i.type),d._bottom=yg(d,o,!1,i.type),(d._visualValues||(d._visualValues={}))[a]=u}}function bg(t,e){const n=t.scales;return Object.keys(n).filter((t=>n[t].axis===e)).shift()}function wg(t,e){const n=t.controller.index,i=t.vScale&&t.vScale.axis;if(i){e=e||t._parsed;for(const t of e){const e=t._stacks;if(!e||void 0===e[i]||void 0===e[i][n])return;delete e[i][n],void 0!==e[i]._visualValues&&void 0!==e[i]._visualValues[n]&&delete e[i]._visualValues[n]}}}const xg=t=>"reset"===t||"none"===t,kg=(t,e)=>e?t:Object.assign({},t);class Cg{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=mg(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&wg(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,n=this.getDataset(),i=(t,e,n,i)=>"x"===t?e:"r"===t?i:n,s=e.xAxisID=Td(n.xAxisID,bg(t,"x")),r=e.yAxisID=Td(n.yAxisID,bg(t,"y")),o=e.rAxisID=Td(n.rAxisID,bg(t,"r")),a=e.indexAxis,l=e.iAxisID=i(a,s,r,o),c=e.vAxisID=i(a,r,s,o);e.xScale=this.getScaleForId(s),e.yScale=this.getScaleForId(r),e.rScale=this.getScaleForId(o),e.iScale=this.getScaleForId(l),e.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&_p(this._data,this),t._stacked&&wg(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),n=this._data;if(kd(e)){const t=this._cachedMeta;this._data=function(t,e){const{iScale:n,vScale:i}=e,s="x"===n.axis?"x":"y",r="x"===i.axis?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,c,h;for(l=0,c=o.length;l<c;++l)h=o[l],a[l]={[s]:h,[r]:t[h]};return a}(e,t)}else if(n!==e){if(n){_p(n,this);const t=this._cachedMeta;wg(t),t._parsed=[]}e&&Object.isExtensible(e)&&((i=e)._chartjs?i._chartjs.listeners.push(this):(Object.defineProperty(i,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[this]}}),mp.forEach((t=>{const e="_onData"+jd(t),n=i[t];Object.defineProperty(i,t,{configurable:!0,enumerable:!1,value(...t){const s=n.apply(this,t);return i._chartjs.listeners.forEach((n=>{"function"==typeof n[e]&&n[e](...t)})),s}})})))),this._syncList=[],this._data=e}var i}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const s=e._stacked;e._stacked=mg(e.vScale,e),e.stack!==n.stack&&(i=!0,wg(e),e.stack=n.stack),this._resyncElements(t),(i||s!==e._stacked)&&vg(this,e._parsed)}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:n,_data:i}=this,{iScale:s,_stacked:r}=n,o=s.axis;let a,l,c,h=0===t&&e===i.length||n._sorted,u=t>0&&n._parsed[t-1];if(!1===this._parsing)n._parsed=i,n._sorted=!0,c=i;else{c=xd(i[t])?this.parseArrayData(n,i,t,e):kd(i[t])?this.parseObjectData(n,i,t,e):this.parsePrimitiveData(n,i,t,e);const s=()=>null===l[o]||u&&l[o]<u[o];for(a=0;a<e;++a)n._parsed[a+t]=l=c[a],h&&(s()&&(h=!1),u=l);n._sorted=h}r&&vg(this,c)}parsePrimitiveData(t,e,n,i){const{iScale:s,vScale:r}=t,o=s.axis,a=r.axis,l=s.getLabels(),c=s===r,h=new Array(i);let u,d,p;for(u=0,d=i;u<d;++u)p=u+n,h[u]={[o]:c||s.parse(l[p],p),[a]:r.parse(e[p],p)};return h}parseArrayData(t,e,n,i){const{xScale:s,yScale:r}=t,o=new Array(i);let a,l,c,h;for(a=0,l=i;a<l;++a)c=a+n,h=e[c],o[a]={x:s.parse(h[0],c),y:r.parse(h[1],c)};return o}parseObjectData(t,e,n,i){const{xScale:s,yScale:r}=t,{xAxisKey:o="x",yAxisKey:a="y"}=this._parsing,l=new Array(i);let c,h,u,d;for(c=0,h=i;c<h;++c)u=c+n,d=e[u],l[c]={x:s.parse(zd(d,o),u),y:r.parse(zd(d,a),u)};return l}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,n){const i=this.chart,s=this._cachedMeta,r=e[t.axis];return gg({keys:fg(i,!0),values:e._stacks[t.axis]._visualValues},r,s.index,{mode:n})}updateRangeFromParsed(t,e,n,i){const s=n[e.axis];let r=null===s?NaN:s;const o=i&&n._stacks[e.axis];i&&o&&(i.values=o,r=gg(i,s,this._cachedMeta.index)),t.min=Math.min(t.min,r),t.max=Math.max(t.max,r)}getMinMax(t,e){const n=this._cachedMeta,i=n._parsed,s=n._sorted&&t===n.iScale,r=i.length,o=this._getOtherScale(t),a=((t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:fg(n,!0),values:null})(e,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:h}=function(t){const{min:e,max:n,minDefined:i,maxDefined:s}=t.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:s?n:Number.POSITIVE_INFINITY}}(o);let u,d;function p(){d=i[u];const e=d[o.axis];return!Cd(d[t.axis])||c>e||h<e}for(u=0;u<r&&(p()||(this.updateRangeFromParsed(l,t,d,a),!s));++u);if(s)for(u=r-1;u>=0;--u)if(!p()){this.updateRangeFromParsed(l,t,d,a);break}return l}getAllParsedValues(t){const e=this._cachedMeta._parsed,n=[];let i,s,r;for(i=0,s=e.length;i<s;++i)r=e[i][t.axis],Cd(r)&&n.push(r);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,n=e.iScale,i=e.vScale,s=this.getParsed(t);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=function(t){let e,n,i,s;return kd(t)?(e=t.top,n=t.right,i=t.bottom,s=t.left):e=n=i=s=t,{top:e,right:n,bottom:i,left:s,disabled:!1===t}}(Td(this.options.clip,function(t,e,n){if(!1===n)return!1;const i=pg(t,n),s=pg(e,n);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,n=this._cachedMeta,i=n.data||[],s=e.chartArea,r=[],o=this._drawStart||0,a=this._drawCount||i.length-o,l=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(t,s,o,a),c=o;c<o+a;++c){const e=i[c];e.hidden||(e.active&&l?r.push(e):e.draw(t,s))}for(c=0;c<r.length;++c)r[c].draw(t,s)}getStyle(t,e){const n=e?"active":"default";return void 0===t&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,e,n){const i=this.getDataset();let s;if(t>=0&&t<this._cachedMeta.data.length){const e=this._cachedMeta.data[t];s=e.$context||(e.$context=function(t,e,n){return mf(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}(this.getContext(),t,e)),s.parsed=this.getParsed(t),s.raw=i.data[t],s.index=s.dataIndex=t}else s=this.$context||(this.$context=function(t,e){return mf(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!e,s.mode=n,s}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",n){const i="active"===e,s=this._cachedDataOpts,r=t+"-"+e,o=s[r],a=this.enableOptionSharing&&Vd(n);if(o)return kg(o,a);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,t),h=i?[`${t}Hover`,"hover",t,""]:[t,""],u=l.getOptionScopes(this.getDataset(),c),d=Object.keys(Bp.elements[t]),p=l.resolveNamedOptions(u,d,(()=>this.getContext(n,i,e)),h);return p.$shared&&(p.$shared=a,s[r]=Object.freeze(kg(p,a))),p}_resolveAnimations(t,e,n){const i=this.chart,s=this._cachedDataOpts,r=`animation-${e}`,o=s[r];if(o)return o;let a;if(!1!==i.options.animation){const i=this.chart.config,s=i.datasetAnimationScopeKeys(this._type,e),r=i.getOptionScopes(this.getDataset(),s);a=i.createResolver(r,this.getContext(t,n,e))}const l=new dg(i,a&&a.animations);return a&&a._cacheable&&(s[r]=Object.freeze(l)),l}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||xg(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const n=this.resolveDataElementOptions(t,e),i=this._sharedOptions,s=this.getSharedOptions(n),r=this.includeOptions(e,s)||s!==i;return this.updateSharedOptions(s,e,n),{sharedOptions:s,includeOptions:r}}updateElement(t,e,n,i){xg(i)?Object.assign(t,n):this._resolveAnimations(e,i).update(t,n)}updateSharedOptions(t,e,n){t&&!xg(e)&&this._resolveAnimations(void 0,e).update(t,n)}_setStyle(t,e,n,i){t.active=i;const s=this.getStyle(e,i);this._resolveAnimations(e,n,i).update(t,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(t,e,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,e,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,n=this._cachedMeta.data;for(const[t,e,n]of this._syncList)this[t](e,n);this._syncList=[];const i=n.length,s=e.length,r=Math.min(s,i);r&&this.parse(0,r),s>i?this._insertElements(i,s-i,t):s<i&&this._removeElements(s,i-s)}_insertElements(t,e,n=!0){const i=this._cachedMeta,s=i.data,r=t+e;let o;const a=t=>{for(t.length+=e,o=t.length-1;o>=r;o--)t[o]=t[o-e]};for(a(s),o=t;o<r;++o)s[o]=new this.dataElementType;this._parsing&&a(i._parsed),this.parse(t,e),n&&this.updateElements(s,t,e,"reset")}updateElements(t,e,n,i){}_removeElements(t,e){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(t,e);n._stacked&&wg(n,i)}n.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,n,i]=t;this[e](n,i)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Ig(t){const e=t.iScale,n=function(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let i=[];for(let e=0,s=n.length;e<s;e++)i=i.concat(n[e].controller.getAllParsedValues(t));t._cache.$bar=yp(i.sort(((t,e)=>t-e)))}return t._cache.$bar}(e,t.type);let i,s,r,o,a=e._length;const l=()=>{32767!==r&&-32768!==r&&(Vd(o)&&(a=Math.min(a,Math.abs(r-o)||a)),o=r)};for(i=0,s=n.length;i<s;++i)r=e.getPixelForValue(n[i]),l();for(o=void 0,i=0,s=e.ticks.length;i<s;++i)r=e.getPixelForTick(i),l();return a}function Tg(t,e,n,i){return xd(t)?function(t,e,n,i){const s=n.parse(t[0],i),r=n.parse(t[1],i),o=Math.min(s,r),a=Math.max(s,r);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[n.axis]=c,e._custom={barStart:l,barEnd:c,start:s,end:r,min:o,max:a}}(t,e,n,i):e[n.axis]=n.parse(t,i),e}function Sg(t,e,n,i){const s=t.iScale,r=t.vScale,o=s.getLabels(),a=s===r,l=[];let c,h,u,d;for(c=n,h=n+i;c<h;++c)d=e[c],u={},u[s.axis]=a||s.parse(o[c],c),l.push(Tg(d,u,r,c));return l}function Eg(t){return t&&void 0!==t.barStart&&void 0!==t.barEnd}function Pg(t,e,n,i){let s=e.borderSkipped;const r={};if(!s)return void(t.borderSkipped=r);if(!0===s)return void(t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:o,end:a,reverse:l,top:c,bottom:h}=function(t){let e,n,i,s,r;return t.horizontal?(e=t.base>t.x,n="left",i="right"):(e=t.base<t.y,n="bottom",i="top"),e?(s="end",r="start"):(s="start",r="end"),{start:n,end:i,reverse:e,top:s,bottom:r}}(t);"middle"===s&&n&&(t.enableBorderRadius=!0,(n._top||0)===i?s=c:(n._bottom||0)===i?s=h:(r[Mg(h,o,a,l)]=!0,s=c)),r[Mg(s,o,a,l)]=!0,t.borderSkipped=r}function Mg(t,e,n,i){var s,r,o;return i?(o=n,t=Rg(t=(s=t)===(r=e)?o:s===o?r:s,n,e)):t=Rg(t,e,n),t}function Rg(t,e,n){return"start"===t?e:"end"===t?n:t}function Og(t,{inflateAmount:e},n){t.inflateAmount="auto"===e?1===n?.33:0:e}class Ag extends Cg{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>"spacing"!==t,_indexable:t=>"spacing"!==t&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:i}}=t.legend.options;return e.labels.map(((e,s)=>{const r=t.getDatasetMeta(0).controller.getStyle(s);return{text:e,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,fontColor:i,lineWidth:r.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(s),index:s}}))}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}}}};constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const n=this.getDataset().data,i=this._cachedMeta;if(!1===this._parsing)i._parsed=n;else{let s,r,o=t=>+n[t];if(kd(n[t])){const{key:t="value"}=this._parsing;o=e=>+zd(n[e],t)}for(s=t,r=t+e;s<r;++s)i._parsed[s]=o(s)}}_getRotation(){return ip(this.options.rotation-90)}_getCircumference(){return ip(this.options.circumference)}_getRotationExtents(){let t=Hd,e=-Hd;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,s=i._getRotation(),r=i._getCircumference();t=Math.min(t,s),e=Math.max(e,s+r)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:n}=e,i=this._cachedMeta,s=i.data,r=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,o=Math.max((Math.min(n.width,n.height)-r)/2,0),a=Math.min((c=o,"string"==typeof(l=this.options.cutout)&&l.endsWith("%")?parseFloat(l)/100:+l/c),1);var l,c;const h=this._getRingWeight(this.index),{circumference:u,rotation:d}=this._getRotationExtents(),{ratioX:p,ratioY:f,offsetX:g,offsetY:m}=function(t,e,n){let i=1,s=1,r=0,o=0;if(e<Hd){const a=t,l=a+e,c=Math.cos(a),h=Math.sin(a),u=Math.cos(l),d=Math.sin(l),p=(t,e,i)=>hp(t,a,l,!0)?1:Math.max(e,e*n,i,i*n),f=(t,e,i)=>hp(t,a,l,!0)?-1:Math.min(e,e*n,i,i*n),g=p(0,c,u),m=p(Yd,h,d),_=f(Bd,c,u),y=f(Bd+Yd,h,d);i=(g-_)/2,s=(m-y)/2,r=-(g+_)/2,o=-(m+y)/2}return{ratioX:i,ratioY:s,offsetX:r,offsetY:o}}(d,u,a),_=(n.width-r)/p,y=(n.height-r)/f,v=Math.max(Math.min(_,y)/2,0),b=Sd(this.options.radius,v),w=(b-Math.max(b*a,0))/this._getVisibleDatasetWeightTotal();this.offsetX=g*b,this.offsetY=m*b,i.total=this.calculateTotal(),this.outerRadius=b-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*h,0),this.updateElements(s,0,s.length,t)}_circumference(t,e){const n=this.options,i=this._cachedMeta,s=this._getCircumference();return e&&n.animation.animateRotate||!this.chart.getDataVisibility(t)||null===i._parsed[t]||i.data[t].hidden?0:this.calculateCircumference(i._parsed[t]*s/Hd)}updateElements(t,e,n,i){const s="reset"===i,r=this.chart,o=r.chartArea,a=r.options.animation,l=(o.left+o.right)/2,c=(o.top+o.bottom)/2,h=s&&a.animateScale,u=h?0:this.innerRadius,d=h?0:this.outerRadius,{sharedOptions:p,includeOptions:f}=this._getSharedOptions(e,i);let g,m=this._getRotation();for(g=0;g<e;++g)m+=this._circumference(g,s);for(g=e;g<e+n;++g){const e=this._circumference(g,s),n=t[g],r={x:l+this.offsetX,y:c+this.offsetY,startAngle:m,endAngle:m+e,circumference:e,outerRadius:d,innerRadius:u};f&&(r.options=p||this.resolveDataElementOptions(g,n.active?"active":i)),m+=e,this.updateElement(n,g,r,i)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let n,i=0;for(n=0;n<e.length;n++){const s=t._parsed[n];null===s||isNaN(s)||!this.chart.getDataVisibility(n)||e[n].hidden||(i+=Math.abs(s))}return i}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?Hd*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,i=n.data.labels||[],s=Np(e._parsed[t],n.options.locale);return{label:i[t]||"",value:s}}getMaxBorderWidth(t){let e=0;const n=this.chart;let i,s,r,o,a;if(!t)for(i=0,s=n.data.datasets.length;i<s;++i)if(n.isDatasetVisible(i)){r=n.getDatasetMeta(i),t=r.data,o=r.controller;break}if(!t)return 0;for(i=0,s=t.length;i<s;++i)a=o.resolveDataElementOptions(i),"inner"!==a.borderAlign&&(e=Math.max(e,a.borderWidth||0,a.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let n=0,i=t.length;n<i;++n){const t=this.resolveDataElementOptions(n);e=Math.max(e,t.offset||0,t.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let n=0;n<t;++n)this.chart.isDatasetVisible(n)&&(e+=this._getRingWeight(n));return e}_getRingWeight(t){return Math.max(Td(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class Dg extends Cg{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:n,color:i}}=t.legend.options;return e.labels.map(((e,s)=>{const r=t.getDatasetMeta(0).controller.getStyle(s);return{text:e,fillStyle:r.backgroundColor,strokeStyle:r.borderColor,fontColor:i,lineWidth:r.borderWidth,pointStyle:n,hidden:!t.getDataVisibility(s),index:s}}))}return[]}},onClick(t,e,n){n.chart.toggleDataVisibility(e.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart,i=n.data.labels||[],s=Np(e._parsed[t].r,n.options.locale);return{label:i[t]||"",value:s}}parseObjectData(t,e,n,i){return Mf.bind(this)(t,e,n,i)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach(((t,n)=>{const i=this.getParsed(n).r;!isNaN(i)&&this.chart.getDataVisibility(n)&&(i<e.min&&(e.min=i),i>e.max&&(e.max=i))})),e}_updateRadius(){const t=this.chart,e=t.chartArea,n=t.options,i=Math.min(e.right-e.left,e.bottom-e.top),s=Math.max(i/2,0),r=(s-Math.max(n.cutoutPercentage?s/100*n.cutoutPercentage:1,0))/t.getVisibleDatasetCount();this.outerRadius=s-r*this.index,this.innerRadius=this.outerRadius-r}updateElements(t,e,n,i){const s="reset"===i,r=this.chart,o=r.options.animation,a=this._cachedMeta.rScale,l=a.xCenter,c=a.yCenter,h=a.getIndexAngle(0)-.5*Bd;let u,d=h;const p=360/this.countVisibleElements();for(u=0;u<e;++u)d+=this._computeAngle(u,i,p);for(u=e;u<e+n;u++){const e=t[u];let n=d,f=d+this._computeAngle(u,i,p),g=r.getDataVisibility(u)?a.getDistanceFromCenterForValue(this.getParsed(u).r):0;d=f,s&&(o.animateScale&&(g=0),o.animateRotate&&(n=f=h));const m={x:l,y:c,innerRadius:0,outerRadius:g,startAngle:n,endAngle:f,options:this.resolveDataElementOptions(u,e.active?"active":i)};this.updateElement(e,u,m,i)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach(((t,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&e++})),e}_computeAngle(t,e,n){return this.chart.getDataVisibility(t)?ip(this.resolveDataElementOptions(t,e).angle||n):0}}var Ng=Object.freeze({__proto__:null,BarController:class extends Cg{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,n,i){return Sg(t,e,n,i)}parseArrayData(t,e,n,i){return Sg(t,e,n,i)}parseObjectData(t,e,n,i){const{iScale:s,vScale:r}=t,{xAxisKey:o="x",yAxisKey:a="y"}=this._parsing,l="x"===s.axis?o:a,c="x"===r.axis?o:a,h=[];let u,d,p,f;for(u=n,d=n+i;u<d;++u)f=e[u],p={},p[s.axis]=s.parse(zd(f,l),u),h.push(Tg(zd(f,c),p,r,u));return h}updateRangeFromParsed(t,e,n,i){super.updateRangeFromParsed(t,e,n,i);const s=n._custom;s&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,s.min),t.max=Math.max(t.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:n,vScale:i}=e,s=this.getParsed(t),r=s._custom,o=Eg(r)?"["+r.start+", "+r.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize(),this._cachedMeta.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,n,i){const s="reset"===i,{index:r,_cachedMeta:{vScale:o}}=this,a=o.getBasePixel(),l=o.isHorizontal(),c=this._getRuler(),{sharedOptions:h,includeOptions:u}=this._getSharedOptions(e,i);for(let d=e;d<e+n;d++){const e=this.getParsed(d),n=s||wd(e[o.axis])?{base:a,head:a}:this._calculateBarValuePixels(d),p=this._calculateBarIndexPixels(d,c),f=(e._stacks||{})[o.axis],g={horizontal:l,base:n.base,enableBorderRadius:!f||Eg(e._custom)||r===f._top||r===f._bottom,x:l?n.head:p.center,y:l?p.center:n.head,height:l?p.size:Math.abs(n.size),width:l?Math.abs(n.size):p.size};u&&(g.options=h||this.resolveDataElementOptions(d,t[d].active?"active":i));const m=g.options||t[d].options;Pg(g,m,f,r),Og(g,m,c.ratio),this.updateElement(t[d],d,g,i)}}_getStacks(t,e){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter((t=>t.controller.options.grouped)),s=n.options.stacked,r=[],o=t=>{const n=t.controller.getParsed(e),i=n&&n[t.vScale.axis];if(wd(i)||isNaN(i))return!0};for(const n of i)if((void 0===e||!o(n))&&((!1===s||-1===r.indexOf(n.stack)||void 0===s&&void 0===n.stack)&&r.push(n.stack),n.index===t))break;return r.length||r.push(void 0),r}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,e,n){const i=this._getStacks(t,n),s=void 0!==e?i.indexOf(e):-1;return-1===s?i.length-1:s}_getRuler(){const t=this.options,e=this._cachedMeta,n=e.iScale,i=[];let s,r;for(s=0,r=e.data.length;s<r;++s)i.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));const o=t.barThickness;return{min:o||Ig(e),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:n,index:i},options:{base:s,minBarLength:r}}=this,o=s||0,a=this.getParsed(t),l=a._custom,c=Eg(l);let h,u,d=a[e.axis],p=0,f=n?this.applyStack(e,a,n):d;f!==d&&(p=f-d,f=d),c&&(d=l.barStart,f=l.barEnd-l.barStart,0!==d&&Qd(d)!==Qd(l.barEnd)&&(p=0),p+=d);const g=wd(s)||c?p:s;let m=e.getPixelForValue(g);if(h=this.chart.getDataVisibility(t)?e.getPixelForValue(p+f):m,u=h-m,Math.abs(u)<r){u=function(t,e,n){return 0!==t?Qd(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}(u,e,o)*r,d===o&&(m-=u/2);const t=e.getPixelForDecimal(0),s=e.getPixelForDecimal(1),l=Math.min(t,s),p=Math.max(t,s);m=Math.max(Math.min(m,p),l),h=m+u,n&&!c&&(a._stacks[e.axis]._visualValues[i]=e.getValueForPixel(h)-e.getValueForPixel(m))}if(m===e.getPixelForValue(o)){const t=Qd(u)*e.getLineWidthForValue(o)/2;m+=t,u-=t}return{size:u,base:m,head:h,center:h+u/2}}_calculateBarIndexPixels(t,e){const n=e.scale,i=this.options,s=i.skipNull,r=Td(i.maxBarThickness,1/0);let o,a;if(e.grouped){const n=s?this._getStackCount(t):e.stackCount,l="flex"===i.barThickness?function(t,e,n,i){const s=e.pixels,r=s[t];let o=t>0?s[t-1]:null,a=t<s.length-1?s[t+1]:null;const l=n.categoryPercentage;null===o&&(o=r-(null===a?e.end-e.start:a-r)),null===a&&(a=r+r-o);const c=r-(r-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/i,ratio:n.barPercentage,start:c}}(t,e,i,n):function(t,e,n,i){const s=n.barThickness;let r,o;return wd(s)?(r=e.min*n.categoryPercentage,o=n.barPercentage):(r=s*i,o=1),{chunk:r/i,ratio:o,start:e.pixels[t]-r/2}}(t,e,i,n),c=this._getStackIndex(this.index,this._cachedMeta.stack,s?t:void 0);o=l.start+l.chunk*c+l.chunk/2,a=Math.min(r,l.chunk*l.ratio)}else o=n.getPixelForValue(this.getParsed(t)[n.axis],t),a=Math.min(r,e.min*e.ratio);return{base:o-a/2,head:o+a/2,center:o,size:a}}draw(){const t=this._cachedMeta,e=t.vScale,n=t.data,i=n.length;let s=0;for(;s<i;++s)null===this.getParsed(s)[e.axis]||n[s].hidden||n[s].draw(this._ctx)}},BubbleController:class extends Cg{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,n,i){const s=super.parsePrimitiveData(t,e,n,i);for(let t=0;t<s.length;t++)s[t]._custom=this.resolveDataElementOptions(t+n).radius;return s}parseArrayData(t,e,n,i){const s=super.parseArrayData(t,e,n,i);for(let t=0;t<s.length;t++){const i=e[n+t];s[t]._custom=Td(i[2],this.resolveDataElementOptions(t+n).radius)}return s}parseObjectData(t,e,n,i){const s=super.parseObjectData(t,e,n,i);for(let t=0;t<s.length;t++){const i=e[n+t];s[t]._custom=Td(i&&i.r&&+i.r,this.resolveDataElementOptions(t+n).radius)}return s}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,n=this.chart.data.labels||[],{xScale:i,yScale:s}=e,r=this.getParsed(t),o=i.getLabelForValue(r.x),a=s.getLabelForValue(r.y),l=r._custom;return{label:n[t]||"",value:"("+o+", "+a+(l?", "+l:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,n,i){const s="reset"===i,{iScale:r,vScale:o}=this._cachedMeta,{sharedOptions:a,includeOptions:l}=this._getSharedOptions(e,i),c=r.axis,h=o.axis;for(let u=e;u<e+n;u++){const e=t[u],n=!s&&this.getParsed(u),d={},p=d[c]=s?r.getPixelForDecimal(.5):r.getPixelForValue(n[c]),f=d[h]=s?o.getBasePixel():o.getPixelForValue(n[h]);d.skip=isNaN(p)||isNaN(f),l&&(d.options=a||this.resolveDataElementOptions(u,e.active?"active":i),s&&(d.options.radius=0)),this.updateElement(e,u,d,i)}}resolveDataElementOptions(t,e){const n=this.getParsed(t);let i=super.resolveDataElementOptions(t,e);i.$shared&&(i=Object.assign({},i,{$shared:!1}));const s=i.radius;return"active"!==e&&(i.radius=0),i.radius+=Td(n&&n._custom,s),i}},DoughnutController:Ag,LineController:class extends Cg{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:n,data:i=[],_dataset:s}=e,r=this.chart._animationsDisabled;let{start:o,count:a}=kp(e,i,r);this._drawStart=o,this._drawCount=a,Cp(e)&&(o=0,a=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=i;const l=this.resolveDatasetElementOptions(t);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!r,options:l},t),this.updateElements(i,o,a,t)}updateElements(t,e,n,i){const s="reset"===i,{iScale:r,vScale:o,_stacked:a,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:h}=this._getSharedOptions(e,i),u=r.axis,d=o.axis,{spanGaps:p,segment:f}=this.options,g=ep(p)?p:Number.POSITIVE_INFINITY,m=this.chart._animationsDisabled||s||"none"===i,_=e+n,y=t.length;let v=e>0&&this.getParsed(e-1);for(let n=0;n<y;++n){const p=t[n],y=m?p:{};if(n<e||n>=_){y.skip=!0;continue}const b=this.getParsed(n),w=wd(b[d]),x=y[u]=r.getPixelForValue(b[u],n),k=y[d]=s||w?o.getBasePixel():o.getPixelForValue(a?this.applyStack(o,b,a):b[d],n);y.skip=isNaN(x)||isNaN(k)||w,y.stop=n>0&&Math.abs(b[u]-v[u])>g,f&&(y.parsed=b,y.raw=l.data[n]),h&&(y.options=c||this.resolveDataElementOptions(n,p.active?"active":i)),m||this.updateElement(p,n,y,i),v=b}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,n=e.options&&e.options.borderWidth||0,i=t.data||[];if(!i.length)return n;const s=i[0].size(this.resolveDataElementOptions(0)),r=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,s,r)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}},PieController:class extends Ag{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}},PolarAreaController:Dg,RadarController:class extends Cg{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const e=this._cachedMeta.vScale,n=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(n[e.axis])}}parseObjectData(t,e,n,i){return Mf.bind(this)(t,e,n,i)}update(t){const e=this._cachedMeta,n=e.dataset,i=e.data||[],s=e.iScale.getLabels();if(n.points=i,"resize"!==t){const e=this.resolveDatasetElementOptions(t);this.options.showLine||(e.borderWidth=0);const r={_loop:!0,_fullLoop:s.length===i.length,options:e};this.updateElement(n,void 0,r,t)}this.updateElements(i,0,i.length,t)}updateElements(t,e,n,i){const s=this._cachedMeta.rScale,r="reset"===i;for(let o=e;o<e+n;o++){const e=t[o],n=this.resolveDataElementOptions(o,e.active?"active":i),a=s.getPointPositionForValue(o,this.getParsed(o).r),l=r?s.xCenter:a.x,c=r?s.yCenter:a.y,h={x:l,y:c,angle:a.angle,skip:isNaN(l)||isNaN(c),options:n};this.updateElement(e,o,h,i)}}},ScatterController:class extends Cg{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const e=this._cachedMeta,n=this.chart.data.labels||[],{xScale:i,yScale:s}=e,r=this.getParsed(t),o=i.getLabelForValue(r.x),a=s.getLabelForValue(r.y);return{label:n[t]||"",value:"("+o+", "+a+")"}}update(t){const e=this._cachedMeta,{data:n=[]}=e,i=this.chart._animationsDisabled;let{start:s,count:r}=kp(e,n,i);if(this._drawStart=s,this._drawCount=r,Cp(e)&&(s=0,r=n.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:s,_dataset:r}=e;s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!r._decimated,s.points=n;const o=this.resolveDatasetElementOptions(t);o.segment=this.options.segment,this.updateElement(s,void 0,{animated:!i,options:o},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(n,s,r,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,n,i){const s="reset"===i,{iScale:r,vScale:o,_stacked:a,_dataset:l}=this._cachedMeta,c=this.resolveDataElementOptions(e,i),h=this.getSharedOptions(c),u=this.includeOptions(i,h),d=r.axis,p=o.axis,{spanGaps:f,segment:g}=this.options,m=ep(f)?f:Number.POSITIVE_INFINITY,_=this.chart._animationsDisabled||s||"none"===i;let y=e>0&&this.getParsed(e-1);for(let c=e;c<e+n;++c){const e=t[c],n=this.getParsed(c),f=_?e:{},v=wd(n[p]),b=f[d]=r.getPixelForValue(n[d],c),w=f[p]=s||v?o.getBasePixel():o.getPixelForValue(a?this.applyStack(o,n,a):n[p],c);f.skip=isNaN(b)||isNaN(w)||v,f.stop=c>0&&Math.abs(n[d]-y[d])>m,g&&(f.parsed=n,f.raw=l.data[c]),u&&(f.options=h||this.resolveDataElementOptions(c,e.active?"active":i)),_||this.updateElement(e,c,f,i),y=n}this.updateSharedOptions(h,i,c)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let t=0;for(let n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}const n=t.dataset,i=n.options&&n.options.borderWidth||0;if(!e.length)return i;const s=e[0].size(this.resolveDataElementOptions(0)),r=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(i,s,r)/2}}});function Lg(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Fg{static override(t){Object.assign(Fg.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return Lg()}parse(){return Lg()}format(){return Lg()}add(){return Lg()}diff(){return Lg()}startOf(){return Lg()}endOf(){return Lg()}}var zg=Fg;function jg(t,e,n,i){const{controller:s,data:r,_sorted:o}=t,a=s._cachedMeta.iScale;if(a&&e===a.axis&&"r"!==e&&o&&r.length){const t=a._reversePixels?gp:fp;if(!i)return t(r,e,n);if(s._sharedOptions){const i=r[0],s="function"==typeof i.getRange&&i.getRange(e);if(s){const i=t(r,e,n-s),o=t(r,e,n+s);return{lo:i.lo,hi:o.hi}}}}return{lo:0,hi:r.length-1}}function Vg(t,e,n,i,s){const r=t.getSortedVisibleDatasetMetas(),o=n[e];for(let t=0,n=r.length;t<n;++t){const{index:n,data:a}=r[t],{lo:l,hi:c}=jg(r[t],e,o,s);for(let t=l;t<=c;++t){const e=a[t];e.skip||i(e,n,t)}}}function Ug(t,e,n,i,s){const r=[];return s||t.isPointInArea(e)?(Vg(t,n,e,(function(n,o,a){(s||Jp(n,t.chartArea,0))&&n.inRange(e.x,e.y,i)&&r.push({element:n,datasetIndex:o,index:a})}),!0),r):r}function Wg(t,e,n,i,s,r){return r||t.isPointInArea(e)?"r"!==n||i?function(t,e,n,i,s,r){let o=[];const a=function(t){const e=-1!==t.indexOf("x"),n=-1!==t.indexOf("y");return function(t,i){const s=e?Math.abs(t.x-i.x):0,r=n?Math.abs(t.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(r,2))}}(n);let l=Number.POSITIVE_INFINITY;return Vg(t,n,e,(function(n,c,h){const u=n.inRange(e.x,e.y,s);if(i&&!u)return;const d=n.getCenterPoint(s);if(!r&&!t.isPointInArea(d)&&!u)return;const p=a(e,d);p<l?(o=[{element:n,datasetIndex:c,index:h}],l=p):p===l&&o.push({element:n,datasetIndex:c,index:h})})),o}(t,e,n,i,s,r):function(t,e,n,i){let s=[];return Vg(t,n,e,(function(t,n,r){const{startAngle:o,endAngle:a}=t.getProps(["startAngle","endAngle"],i),{angle:l}=op(t,{x:e.x,y:e.y});hp(l,o,a)&&s.push({element:t,datasetIndex:n,index:r})})),s}(t,e,n,s):[]}function Bg(t,e,n,i,s){const r=[],o="x"===n?"inXRange":"inYRange";let a=!1;return Vg(t,n,e,((t,i,l)=>{t[o](e[n],s)&&(r.push({element:t,datasetIndex:i,index:l}),a=a||t.inRange(e.x,e.y,s))})),i&&!a?[]:r}var Hg={evaluateInteractionItems:Vg,modes:{index(t,e,n,i){const s=Hf(e,t),r=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?Ug(t,s,r,i,o):Wg(t,s,r,!1,i,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach((t=>{const e=a[0].index,n=t.data[e];n&&!n.skip&&l.push({element:n,datasetIndex:t.index,index:e})})),l):[]},dataset(t,e,n,i){const s=Hf(e,t),r=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?Ug(t,s,r,i,o):Wg(t,s,r,!1,i,o);if(a.length>0){const e=a[0].datasetIndex,n=t.getDatasetMeta(e).data;a=[];for(let t=0;t<n.length;++t)a.push({element:n[t],datasetIndex:e,index:t})}return a},point:(t,e,n,i)=>Ug(t,Hf(e,t),n.axis||"xy",i,n.includeInvisible||!1),nearest(t,e,n,i){const s=Hf(e,t),r=n.axis||"xy",o=n.includeInvisible||!1;return Wg(t,s,r,n.intersect,i,o)},x:(t,e,n,i)=>Bg(t,Hf(e,t),"x",n.intersect,i),y:(t,e,n,i)=>Bg(t,Hf(e,t),"y",n.intersect,i)}};const qg=["left","top","right","bottom"];function $g(t,e){return t.filter((t=>t.pos===e))}function Kg(t,e){return t.filter((t=>-1===qg.indexOf(t.pos)&&t.box.axis===e))}function Yg(t,e){return t.sort(((t,n)=>{const i=e?n:t,s=e?t:n;return i.weight===s.weight?i.index-s.index:i.weight-s.weight}))}function Gg(t,e,n,i){return Math.max(t[n],e[n])+Math.max(t[i],e[i])}function Jg(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function Xg(t,e,n,i){const{pos:s,box:r}=n,o=t.maxPadding;if(!kd(s)){n.size&&(t[s]-=n.size);const e=i[n.stack]||{size:0,count:1};e.size=Math.max(e.size,n.horizontal?r.height:r.width),n.size=e.size/e.count,t[s]+=n.size}r.getPadding&&Jg(o,r.getPadding());const a=Math.max(0,e.outerWidth-Gg(o,t,"left","right")),l=Math.max(0,e.outerHeight-Gg(o,t,"top","bottom")),c=a!==t.w,h=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:c,other:h}:{same:h,other:c}}function Qg(t,e){const n=e.maxPadding;return function(t){const i={left:0,top:0,right:0,bottom:0};return t.forEach((t=>{i[t]=Math.max(e[t],n[t])})),i}(t?["left","right"]:["top","bottom"])}function Zg(t,e,n,i){const s=[];let r,o,a,l,c,h;for(r=0,o=t.length,c=0;r<o;++r){a=t[r],l=a.box,l.update(a.width||e.w,a.height||e.h,Qg(a.horizontal,e));const{same:o,other:u}=Xg(e,n,a,i);c|=o&&s.length,h=h||u,l.fullSize||s.push(a)}return c&&Zg(s,e,n,i)||h}function tm(t,e,n,i,s){t.top=n,t.left=e,t.right=e+i,t.bottom=n+s,t.width=i,t.height=s}function em(t,e,n,i){const s=n.padding;let{x:r,y:o}=e;for(const a of t){const t=a.box,l=i[a.stack]||{count:1,placed:0,weight:1},c=a.stackWeight/l.weight||1;if(a.horizontal){const i=e.w*c,r=l.size||t.height;Vd(l.start)&&(o=l.start),t.fullSize?tm(t,s.left,o,n.outerWidth-s.right-s.left,r):tm(t,e.left+l.placed,o,i,r),l.start=o,l.placed+=i,o=t.bottom}else{const i=e.h*c,o=l.size||t.width;Vd(l.start)&&(r=l.start),t.fullSize?tm(t,r,s.top,o,n.outerHeight-s.bottom-s.top):tm(t,r,e.top+l.placed,o,i),l.start=r,l.placed+=i,r=t.right}}e.x=r,e.y=o}var nm={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;-1!==n&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,i){if(!t)return;const s=pf(t.options.layout.padding),r=Math.max(e-s.width,0),o=Math.max(n-s.height,0),a=function(t){const e=function(t){const e=[];let n,i,s,r,o,a;for(n=0,i=(t||[]).length;n<i;++n)s=t[n],({position:r,options:{stack:o,stackWeight:a=1}}=s),e.push({index:n,box:s,pos:r,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&r+o,stackWeight:a});return e}(t),n=Yg(e.filter((t=>t.box.fullSize)),!0),i=Yg($g(e,"left"),!0),s=Yg($g(e,"right")),r=Yg($g(e,"top"),!0),o=Yg($g(e,"bottom")),a=Kg(e,"x"),l=Kg(e,"y");return{fullSize:n,leftAndTop:i.concat(r),rightAndBottom:s.concat(l).concat(o).concat(a),chartArea:$g(e,"chartArea"),vertical:i.concat(s).concat(l),horizontal:r.concat(o).concat(a)}}(t.boxes),l=a.vertical,c=a.horizontal;Pd(t.boxes,(t=>{"function"==typeof t.beforeLayout&&t.beforeLayout()}));const h=l.reduce(((t,e)=>e.box.options&&!1===e.box.options.display?t:t+1),0)||1,u=Object.freeze({outerWidth:e,outerHeight:n,padding:s,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/h,hBoxMaxHeight:o/2}),d=Object.assign({},s);Jg(d,pf(i));const p=Object.assign({maxPadding:d,w:r,h:o,x:s.left,y:s.top},s),f=function(t,e){const n=function(t){const e={};for(const n of t){const{stack:t,pos:i,stackWeight:s}=n;if(!t||!qg.includes(i))continue;const r=e[t]||(e[t]={count:0,placed:0,weight:0,size:0});r.count++,r.weight+=s}return e}(t),{vBoxMaxWidth:i,hBoxMaxHeight:s}=e;let r,o,a;for(r=0,o=t.length;r<o;++r){a=t[r];const{fullSize:o}=a.box,l=n[a.stack],c=l&&a.stackWeight/l.weight;a.horizontal?(a.width=c?c*i:o&&e.availableWidth,a.height=s):(a.width=i,a.height=c?c*s:o&&e.availableHeight)}return n}(l.concat(c),u);Zg(a.fullSize,p,u,f),Zg(l,p,u,f),Zg(c,p,u,f)&&Zg(l,p,u,f),function(t){const e=t.maxPadding;function n(n){const i=Math.max(e[n]-t[n],0);return t[n]+=i,i}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}(p),em(a.leftAndTop,p,u,f),p.x+=p.w,p.y+=p.h,em(a.rightAndBottom,p,u,f),t.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Pd(a.chartArea,(e=>{const n=e.box;Object.assign(n,t.chartArea),n.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})}))}};class im{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,n){}removeEventListener(t,e,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,n,i){return e=Math.max(0,e||t.width),n=n||t.height,{width:e,height:Math.max(0,i?Math.floor(e/i):n)}}isAttached(t){return!0}updateConfig(t){}}class sm extends im{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const rm="$chartjs",om={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},am=t=>null===t||""===t,lm=!!Kf&&{passive:!0};function cm(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,lm)}function hm(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function um(t,e,n){const i=t.canvas,s=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||hm(n.addedNodes,i),e=e&&!hm(n.removedNodes,i);e&&n()}));return s.observe(document,{childList:!0,subtree:!0}),s}function dm(t,e,n){const i=t.canvas,s=new MutationObserver((t=>{let e=!1;for(const n of t)e=e||hm(n.removedNodes,i),e=e&&!hm(n.addedNodes,i);e&&n()}));return s.observe(document,{childList:!0,subtree:!0}),s}const pm=new Map;let fm=0;function gm(){const t=window.devicePixelRatio;t!==fm&&(fm=t,pm.forEach(((e,n)=>{n.currentDevicePixelRatio!==t&&e()})))}function mm(t,e,n){const i=t.canvas,s=i&&zf(i);if(!s)return;const r=bp(((t,e)=>{const i=s.clientWidth;n(t,e),i<s.clientWidth&&n()}),window),o=new ResizeObserver((t=>{const e=t[0],n=e.contentRect.width,i=e.contentRect.height;0===n&&0===i||r(n,i)}));return o.observe(s),function(t,e){pm.size||window.addEventListener("resize",gm),pm.set(t,e)}(t,r),o}function _m(t,e,n){n&&n.disconnect(),"resize"===e&&function(t){pm.delete(t),pm.size||window.removeEventListener("resize",gm)}(t)}function ym(t,e,n){const i=t.canvas,s=bp((e=>{null!==t.ctx&&n(function(t,e){const n=om[t.type]||t.type,{x:i,y:s}=Hf(t,e);return{type:n,chart:e,native:t,x:void 0!==i?i:null,y:void 0!==s?s:null}}(e,t))}),t);return function(t,e,n){t&&t.addEventListener(e,n,lm)}(i,e,s),s}class vm extends im{acquireContext(t,e){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(function(t,e){const n=t.style,i=t.getAttribute("height"),s=t.getAttribute("width");if(t[rm]={initial:{height:i,width:s,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",am(s)){const e=Yf(t,"width");void 0!==e&&(t.width=e)}if(am(i))if(""===t.style.height)t.height=t.width/(e||2);else{const e=Yf(t,"height");void 0!==e&&(t.height=e)}}(t,e),n):null}releaseContext(t){const e=t.canvas;if(!e[rm])return!1;const n=e[rm].initial;["height","width"].forEach((t=>{const i=n[t];wd(i)?e.removeAttribute(t):e.setAttribute(t,i)}));const i=n.style||{};return Object.keys(i).forEach((t=>{e.style[t]=i[t]})),e.width=e.width,delete e[rm],!0}addEventListener(t,e,n){this.removeEventListener(t,e);const i=t.$proxies||(t.$proxies={}),s={attach:um,detach:dm,resize:mm}[e]||ym;i[e]=s(t,e,n)}removeEventListener(t,e){const n=t.$proxies||(t.$proxies={}),i=n[e];i&&(({attach:_m,detach:_m,resize:_m}[e]||cm)(t,e,i),n[e]=void 0)}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,n,i){return function(t,e,n,i){const s=Vf(t),r=Wf(s,"margin"),o=jf(s.maxWidth,t,"clientWidth")||$d,a=jf(s.maxHeight,t,"clientHeight")||$d,l=function(t,e,n){let i,s;if(void 0===e||void 0===n){const r=t&&zf(t);if(r){const t=r.getBoundingClientRect(),o=Vf(r),a=Wf(o,"border","width"),l=Wf(o,"padding");e=t.width-l.width-a.width,n=t.height-l.height-a.height,i=jf(o.maxWidth,r,"clientWidth"),s=jf(o.maxHeight,r,"clientHeight")}else e=t.clientWidth,n=t.clientHeight}return{width:e,height:n,maxWidth:i||$d,maxHeight:s||$d}}(t,e,n);let{width:c,height:h}=l;if("content-box"===s.boxSizing){const t=Wf(s,"border","width"),e=Wf(s,"padding");c-=e.width+t.width,h-=e.height+t.height}return c=Math.max(0,c-r.width),h=Math.max(0,i?c/i:h-r.height),c=qf(Math.min(c,o,l.maxWidth)),h=qf(Math.min(h,a,l.maxHeight)),c&&!h&&(h=qf(c/2)),(void 0!==e||void 0!==n)&&i&&l.height&&h>l.height&&(h=l.height,c=qf(Math.floor(h*i))),{width:c,height:h}}(t,e,n,i)}isAttached(t){const e=t&&zf(t);return!(!e||!e.isConnected)}}class bm{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}hasValue(){return ep(this.x)&&ep(this.y)}getProps(t,e){const n=this.$animations;if(!e||!n)return this;const i={};return t.forEach((t=>{i[t]=n[t]&&n[t].active()?n[t]._to:this[t]})),i}}function wm(t,e,n,i,s){const r=Td(i,0),o=Math.min(Td(s,t.length),t.length);let a,l,c,h=0;for(n=Math.ceil(n),s&&(a=s-i,n=a/Math.floor(a/n)),c=r;c<0;)h++,c=Math.round(r+h*n);for(l=Math.max(r,0);l<o;l++)l===c&&(e.push(t[l]),h++,c=Math.round(r+h*n))}const xm=(t,e,n)=>"top"===e||"left"===e?t[e]+n:t[e]-n,km=(t,e)=>Math.min(e||t,t);function Cm(t,e){const n=[],i=t.length/e,s=t.length;let r=0;for(;r<s;r+=i)n.push(t[Math.floor(r)]);return n}function Im(t,e,n){const i=t.ticks.length,s=Math.min(e,i-1),r=t._startPixel,o=t._endPixel,a=1e-6;let l,c=t.getPixelForTick(s);if(!(n&&(l=1===i?Math.max(c-r,o-c):0===e?(t.getPixelForTick(1)-c)/2:(c-t.getPixelForTick(s-1))/2,c+=s<e?l:-l,c<r-a||c>o+a)))return c}function Tm(t){return t.drawTicks?t.tickLength:0}function Sm(t,e){if(!t.display)return 0;const n=ff(t.font,e),i=pf(t.padding);return(xd(t.text)?t.text.length:1)*n.lineHeight+i.height}function Em(t,e,n){let i=wp(t);return(n&&"right"!==e||!n&&"right"===e)&&(i=(t=>"left"===t?"right":"right"===t?"left":t)(i)),i}class Pm extends bm{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:n,_suggestedMax:i}=this;return t=Id(t,Number.POSITIVE_INFINITY),e=Id(e,Number.NEGATIVE_INFINITY),n=Id(n,Number.POSITIVE_INFINITY),i=Id(i,Number.NEGATIVE_INFINITY),{min:Id(t,n),max:Id(e,i),minDefined:Cd(t),maxDefined:Cd(e)}}getMinMax(t){let e,{min:n,max:i,minDefined:s,maxDefined:r}=this.getUserBounds();if(s&&r)return{min:n,max:i};const o=this.getMatchingVisibleMetas();for(let a=0,l=o.length;a<l;++a)e=o[a].controller.getMinMax(this,t),s||(n=Math.min(n,e.min)),r||(i=Math.max(i,e.max));return n=r&&n>i?i:n,i=s&&n>i?n:i,{min:Id(n,Id(i,n)),max:Id(i,Id(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Ed(this.options.beforeUpdate,[this])}update(t,e,n){const{beginAtZero:i,grace:s,ticks:r}=this.options,o=r.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(t,e,n){const{min:i,max:s}=t,r=Sd(e,(s-i)/2),o=(t,e)=>n&&0===t?0:t+e;return{min:o(i,-Math.abs(r)),max:o(s,r)}}(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const a=o<this.ticks.length;this._convertTicksToLabels(a?Cm(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),r.display&&(r.autoSkip||"auto"===r.source)&&(this.ticks=function(t,e){const n=t.options.ticks,i=function(t){const e=t.options.offset,n=t._tickSize(),i=t._length/n+(e?0:1),s=t._maxLength/n;return Math.floor(Math.min(i,s))}(t),s=Math.min(n.maxTicksLimit||i,i),r=n.major.enabled?function(t){const e=[];let n,i;for(n=0,i=t.length;n<i;n++)t[n].major&&e.push(n);return e}(e):[],o=r.length,a=r[0],l=r[o-1],c=[];if(o>s)return function(t,e,n,i){let s,r=0,o=n[0];for(i=Math.ceil(i),s=0;s<t.length;s++)s===o&&(e.push(t[s]),r++,o=n[r*i])}(e,c,r,o/s),c;const h=function(t,e,n){const i=function(t){const e=t.length;let n,i;if(e<2)return!1;for(i=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==i)return!1;return i}(t),s=e.length/n;if(!i)return Math.max(s,1);const r=function(t){const e=[],n=Math.sqrt(t);let i;for(i=1;i<n;i++)t%i==0&&(e.push(i),e.push(t/i));return n===(0|n)&&e.push(n),e.sort(((t,e)=>t-e)).pop(),e}(i);for(let t=0,e=r.length-1;t<e;t++){const e=r[t];if(e>s)return e}return Math.max(s,1)}(r,e,s);if(o>0){let t,n;const i=o>1?Math.round((l-a)/(o-1)):null;for(wm(e,c,h,wd(i)?0:a-i,a),t=0,n=o-1;t<n;t++)wm(e,c,h,r[t],r[t+1]);return wm(e,c,h,l,wd(i)?e.length:l+i),c}return wm(e,c,h),c}(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),a&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t,e,n=this.options.reverse;this.isHorizontal()?(t=this.left,e=this.right):(t=this.top,e=this.bottom,n=!n),this._startPixel=t,this._endPixel=e,this._reversePixels=n,this._length=e-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Ed(this.options.afterUpdate,[this])}beforeSetDimensions(){Ed(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Ed(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Ed(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Ed(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let n,i,s;for(n=0,i=t.length;n<i;n++)s=t[n],s.label=Ed(e.callback,[s.value,n,t],this)}afterTickToLabelConversion(){Ed(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Ed(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,n=km(this.ticks.length,t.ticks.maxTicksLimit),i=e.minRotation||0,s=e.maxRotation;let r,o,a,l=i;if(!this._isVisible()||!e.display||i>=s||n<=1||!this.isHorizontal())return void(this.labelRotation=i);const c=this._getLabelSizes(),h=c.widest.width,u=c.highest.height,d=up(this.chart.width-h,0,this.maxWidth);r=t.offset?this.maxWidth/n:d/(n-1),h+6>r&&(r=d/(n-(t.offset?.5:1)),o=this.maxHeight-Tm(t.grid)-e.padding-Sm(t.title,this.chart.options.font),a=Math.sqrt(h*h+u*u),l=sp(Math.min(Math.asin(up((c.highest.height+6)/r,-1,1)),Math.asin(up(o/a,-1,1))-Math.asin(up(u/a,-1,1)))),l=Math.max(i,Math.min(s,l))),this.labelRotation=l}afterCalculateLabelRotation(){Ed(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Ed(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:n,title:i,grid:s}}=this,r=this._isVisible(),o=this.isHorizontal();if(r){const r=Sm(i,e.options.font);if(o?(t.width=this.maxWidth,t.height=Tm(s)+r):(t.height=this.maxHeight,t.width=Tm(s)+r),n.display&&this.ticks.length){const{first:e,last:i,widest:s,highest:r}=this._getLabelSizes(),a=2*n.padding,l=ip(this.labelRotation),c=Math.cos(l),h=Math.sin(l);if(o){const e=n.mirror?0:h*s.width+c*r.height;t.height=Math.min(this.maxHeight,t.height+e+a)}else{const e=n.mirror?0:c*s.width+h*r.height;t.width=Math.min(this.maxWidth,t.width+e+a)}this._calculatePadding(e,i,h,c)}}this._handleMargins(),o?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,n,i){const{ticks:{align:s,padding:r},position:o}=this.options,a=0!==this.labelRotation,l="top"!==o&&"x"===this.axis;if(this.isHorizontal()){const o=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,u=0;a?l?(h=i*t.width,u=n*e.height):(h=n*t.height,u=i*e.width):"start"===s?u=e.width:"end"===s?h=t.width:"inner"!==s&&(h=t.width/2,u=e.width/2),this.paddingLeft=Math.max((h-o+r)*this.width/(this.width-o),0),this.paddingRight=Math.max((u-c+r)*this.width/(this.width-c),0)}else{let n=e.height/2,i=t.height/2;"start"===s?(n=0,i=t.height):"end"===s&&(n=e.height,i=0),this.paddingTop=n+r,this.paddingBottom=i+r}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Ed(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return"top"===e||"bottom"===e||"x"===t}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){let e,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(t),e=0,n=t.length;e<n;e++)wd(t[e].label)&&(t.splice(e,1),n--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let n=this.ticks;e<n.length&&(n=Cm(n,e)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,n){const{ctx:i,_longestTextCache:s}=this,r=[],o=[],a=Math.floor(e/km(e,n));let l,c,h,u,d,p,f,g,m,_,y,v=0,b=0;for(l=0;l<e;l+=a){if(u=t[l].label,d=this._resolveTickFontOptions(l),i.font=p=d.string,f=s[p]=s[p]||{data:{},gc:[]},g=d.lineHeight,m=_=0,wd(u)||xd(u)){if(xd(u))for(c=0,h=u.length;c<h;++c)y=u[c],wd(y)||xd(y)||(m=Hp(i,f.data,f.gc,m,y),_+=g)}else m=Hp(i,f.data,f.gc,m,u),_=g;r.push(m),o.push(_),v=Math.max(m,v),b=Math.max(_,b)}!function(t,e){Pd(t,(t=>{const n=t.gc,i=n.length/2;let s;if(i>e){for(s=0;s<i;++s)delete t.data[n[s]];n.splice(0,i)}}))}(s,e);const w=r.indexOf(v),x=o.indexOf(b),k=t=>({width:r[t]||0,height:o[t]||0});return{first:k(0),last:k(e-1),widest:k(w),highest:k(x),widths:r,heights:o}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return up(this._alignToPixels?$p(this.chart,e,0):e,-32768,32767)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const n=e[t];return n.$context||(n.$context=function(t,e,n){return mf(t,{tick:n,index:e,type:"tick"})}(this.getContext(),t,n))}return this.$context||(this.$context=mf(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const t=this.options.ticks,e=ip(this.labelRotation),n=Math.abs(Math.cos(e)),i=Math.abs(Math.sin(e)),s=this._getLabelSizes(),r=t.autoSkipPadding||0,o=s?s.widest.width+r:0,a=s?s.highest.height+r:0;return this.isHorizontal()?a*n>o*i?o/n:a/i:a*i<o*n?a/n:o/i}_isVisible(){const t=this.options.display;return"auto"!==t?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,n=this.chart,i=this.options,{grid:s,position:r,border:o}=i,a=s.offset,l=this.isHorizontal(),c=this.ticks.length+(a?1:0),h=Tm(s),u=[],d=o.setContext(this.getContext()),p=d.display?d.width:0,f=p/2,g=function(t){return $p(n,t,p)};let m,_,y,v,b,w,x,k,C,I,T,S;if("top"===r)m=g(this.bottom),w=this.bottom-h,k=m-f,I=g(t.top)+f,S=t.bottom;else if("bottom"===r)m=g(this.top),I=t.top,S=g(t.bottom)-f,w=m+f,k=this.top+h;else if("left"===r)m=g(this.right),b=this.right-h,x=m-f,C=g(t.left)+f,T=t.right;else if("right"===r)m=g(this.left),C=t.left,T=g(t.right)-f,b=m+f,x=this.left+h;else if("x"===e){if("center"===r)m=g((t.top+t.bottom)/2+.5);else if(kd(r)){const t=Object.keys(r)[0],e=r[t];m=g(this.chart.scales[t].getPixelForValue(e))}I=t.top,S=t.bottom,w=m+f,k=w+h}else if("y"===e){if("center"===r)m=g((t.left+t.right)/2);else if(kd(r)){const t=Object.keys(r)[0],e=r[t];m=g(this.chart.scales[t].getPixelForValue(e))}b=m-f,x=b-h,C=t.left,T=t.right}const E=Td(i.ticks.maxTicksLimit,c),P=Math.max(1,Math.ceil(c/E));for(_=0;_<c;_+=P){const t=this.getContext(_),e=s.setContext(t),i=o.setContext(t),r=e.lineWidth,c=e.color,h=i.dash||[],d=i.dashOffset,p=e.tickWidth,f=e.tickColor,g=e.tickBorderDash||[],m=e.tickBorderDashOffset;y=Im(this,_,a),void 0!==y&&(v=$p(n,y,r),l?b=x=C=T=v:w=k=I=S=v,u.push({tx1:b,ty1:w,tx2:x,ty2:k,x1:C,y1:I,x2:T,y2:S,width:r,color:c,borderDash:h,borderDashOffset:d,tickWidth:p,tickColor:f,tickBorderDash:g,tickBorderDashOffset:m}))}return this._ticksLength=c,this._borderValue=m,u}_computeLabelItems(t){const e=this.axis,n=this.options,{position:i,ticks:s}=n,r=this.isHorizontal(),o=this.ticks,{align:a,crossAlign:l,padding:c,mirror:h}=s,u=Tm(n.grid),d=u+c,p=h?-c:d,f=-ip(this.labelRotation),g=[];let m,_,y,v,b,w,x,k,C,I,T,S,E="middle";if("top"===i)w=this.bottom-p,x=this._getXAxisLabelAlignment();else if("bottom"===i)w=this.top+p,x=this._getXAxisLabelAlignment();else if("left"===i){const t=this._getYAxisLabelAlignment(u);x=t.textAlign,b=t.x}else if("right"===i){const t=this._getYAxisLabelAlignment(u);x=t.textAlign,b=t.x}else if("x"===e){if("center"===i)w=(t.top+t.bottom)/2+d;else if(kd(i)){const t=Object.keys(i)[0],e=i[t];w=this.chart.scales[t].getPixelForValue(e)+d}x=this._getXAxisLabelAlignment()}else if("y"===e){if("center"===i)b=(t.left+t.right)/2-d;else if(kd(i)){const t=Object.keys(i)[0],e=i[t];b=this.chart.scales[t].getPixelForValue(e)}x=this._getYAxisLabelAlignment(u).textAlign}"y"===e&&("start"===a?E="top":"end"===a&&(E="bottom"));const P=this._getLabelSizes();for(m=0,_=o.length;m<_;++m){y=o[m],v=y.label;const t=s.setContext(this.getContext(m));k=this.getPixelForTick(m)+s.labelOffset,C=this._resolveTickFontOptions(m),I=C.lineHeight,T=xd(v)?v.length:1;const e=T/2,n=t.color,a=t.textStrokeColor,c=t.textStrokeWidth;let u,d=x;if(r?(b=k,"inner"===x&&(d=m===_-1?this.options.reverse?"left":"right":0===m?this.options.reverse?"right":"left":"center"),S="top"===i?"near"===l||0!==f?-T*I+I/2:"center"===l?-P.highest.height/2-e*I+I:-P.highest.height+I/2:"near"===l||0!==f?I/2:"center"===l?P.highest.height/2-e*I:P.highest.height-T*I,h&&(S*=-1),0===f||t.showLabelBackdrop||(b+=I/2*Math.sin(f))):(w=k,S=(1-T)*I/2),t.showLabelBackdrop){const e=pf(t.backdropPadding),n=P.heights[m],i=P.widths[m];let s=S-e.top,r=0-e.left;switch(E){case"middle":s-=n/2;break;case"bottom":s-=n}switch(x){case"center":r-=i/2;break;case"right":r-=i;break;case"inner":m===_-1?r-=i:m>0&&(r-=i/2)}u={left:r,top:s,width:i+e.width,height:n+e.height,color:t.backdropColor}}g.push({label:v,font:C,textOffset:S,options:{rotation:f,color:n,strokeColor:a,strokeWidth:c,textAlign:d,textBaseline:E,translation:[b,w],backdrop:u}})}return g}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-ip(this.labelRotation))return"top"===t?"left":"right";let n="center";return"start"===e.align?n="left":"end"===e.align?n="right":"inner"===e.align&&(n="inner"),n}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:n,mirror:i,padding:s}}=this.options,r=t+s,o=this._getLabelSizes().widest.width;let a,l;return"left"===e?i?(l=this.right+s,"near"===n?a="left":"center"===n?(a="center",l+=o/2):(a="right",l+=o)):(l=this.right-r,"near"===n?a="right":"center"===n?(a="center",l-=o/2):(a="left",l=this.left)):"right"===e?i?(l=this.left+s,"near"===n?a="right":"center"===n?(a="center",l-=o/2):(a="left",l-=o)):(l=this.left+r,"near"===n?a="left":"center"===n?(a="center",l+=o/2):(a="right",l=this.right)):a="right",{textAlign:a,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;return"left"===e||"right"===e?{top:0,left:this.left,bottom:t.height,right:this.right}:"top"===e||"bottom"===e?{top:this.top,left:0,bottom:this.bottom,right:t.width}:void 0}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:n,top:i,width:s,height:r}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(n,i,s,r),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const n=this.ticks.findIndex((e=>e.value===t));return n>=0?e.setContext(this.getContext(n)).lineWidth:0}drawGrid(t){const e=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let s,r;const o=(t,e,i)=>{i.width&&i.color&&(n.save(),n.lineWidth=i.width,n.strokeStyle=i.color,n.setLineDash(i.borderDash||[]),n.lineDashOffset=i.borderDashOffset,n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(e.x,e.y),n.stroke(),n.restore())};if(e.display)for(s=0,r=i.length;s<r;++s){const t=i[s];e.drawOnChartArea&&o({x:t.x1,y:t.y1},{x:t.x2,y:t.y2},t),e.drawTicks&&o({x:t.tx1,y:t.ty1},{x:t.tx2,y:t.ty2},{color:t.tickColor,width:t.tickWidth,borderDash:t.tickBorderDash,borderDashOffset:t.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:n,grid:i}}=this,s=n.setContext(this.getContext()),r=n.display?s.width:0;if(!r)return;const o=i.setContext(this.getContext(0)).lineWidth,a=this._borderValue;let l,c,h,u;this.isHorizontal()?(l=$p(t,this.left,r)-r/2,c=$p(t,this.right,o)+o/2,h=u=a):(h=$p(t,this.top,r)-r/2,u=$p(t,this.bottom,o)+o/2,l=c=a),e.save(),e.lineWidth=s.width,e.strokeStyle=s.color,e.beginPath(),e.moveTo(l,h),e.lineTo(c,u),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const e=this.ctx,n=this._computeLabelArea();n&&Xp(e,n);const i=this.getLabelItems(t);for(const t of i){const n=t.options,i=t.font;sf(e,t.label,0,t.textOffset,i,n)}n&&Qp(e)}drawTitle(){const{ctx:t,options:{position:e,title:n,reverse:i}}=this;if(!n.display)return;const s=ff(n.font),r=pf(n.padding),o=n.align;let a=s.lineHeight/2;"bottom"===e||"center"===e||kd(e)?(a+=r.bottom,xd(n.text)&&(a+=s.lineHeight*(n.text.length-1))):a+=r.top;const{titleX:l,titleY:c,maxWidth:h,rotation:u}=function(t,e,n,i){const{top:s,left:r,bottom:o,right:a,chart:l}=t,{chartArea:c,scales:h}=l;let u,d,p,f=0;const g=o-s,m=a-r;if(t.isHorizontal()){if(d=xp(i,r,a),kd(n)){const t=Object.keys(n)[0],i=n[t];p=h[t].getPixelForValue(i)+g-e}else p="center"===n?(c.bottom+c.top)/2+g-e:xm(t,n,e);u=a-r}else{if(kd(n)){const t=Object.keys(n)[0],i=n[t];d=h[t].getPixelForValue(i)-m+e}else d="center"===n?(c.left+c.right)/2-m+e:xm(t,n,e);p=xp(i,o,s),f="left"===n?-Yd:Yd}return{titleX:d,titleY:p,maxWidth:u,rotation:f}}(this,a,e,o);sf(t,n.text,0,0,s,{color:n.color,maxWidth:h,rotation:u,textAlign:Em(o,e,i),textBaseline:"middle",translation:[l,c]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,n=Td(t.grid&&t.grid.z,-1),i=Td(t.border&&t.border.z,0);return this._isVisible()&&this.draw===Pm.prototype.draw?[{z:n,draw:t=>{this.drawBackground(),this.drawGrid(t),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:e,draw:t=>{this.drawLabels(t)}}]:[{z:e,draw:t=>{this.draw(t)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let s,r;for(s=0,r=e.length;s<r;++s){const r=e[s];r[n]!==this.id||t&&r.type!==t||i.push(r)}return i}_resolveTickFontOptions(t){return ff(this.options.ticks.setContext(this.getContext(t)).font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Mm{constructor(t,e,n){this.type=t,this.scope=e,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let n;(function(t){return"id"in t&&"defaults"in t})(e)&&(n=this.register(e));const i=this.items,s=t.id,r=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in i||(i[s]=t,function(t,e,n){const i=Dd(Object.create(null),[n?Bp.get(n):{},Bp.get(e),t.defaults]);Bp.set(e,i),t.defaultRoutes&&function(t,e){Object.keys(e).forEach((n=>{const i=n.split("."),s=i.pop(),r=[t].concat(i).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");Bp.route(r,s,l,a)}))}(e,t.defaultRoutes),t.descriptors&&Bp.describe(e,t.descriptors)}(t,r,n),this.override&&Bp.override(t.id,t.overrides)),r}get(t){return this.items[t]}unregister(t){const e=this.items,n=t.id,i=this.scope;n in e&&delete e[n],i&&n in Bp[i]&&(delete Bp[i][n],this.override&&delete zp[n])}}class Rm{constructor(){this.controllers=new Mm(Cg,"datasets",!0),this.elements=new Mm(bm,"elements"),this.plugins=new Mm(Object,"plugins"),this.scales=new Mm(Pm,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,n){[...e].forEach((e=>{const i=n||this._getRegistryForType(e);n||i.isForType(e)||i===this.plugins&&e.id?this._exec(t,i,e):Pd(e,(e=>{const i=n||this._getRegistryForType(e);this._exec(t,i,e)}))}))}_exec(t,e,n){const i=jd(t);Ed(n["before"+i],[],n),e[t](n),Ed(n["after"+i],[],n)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const n=this._typedRegistries[e];if(n.isForType(t))return n}return this.plugins}_get(t,e,n){const i=e.get(t);if(void 0===i)throw new Error('"'+t+'" is not a registered '+n+".");return i}}var Om=new Rm;class Am{constructor(){this._init=[]}notify(t,e,n,i){"beforeInit"===e&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const s=i?this._descriptors(t).filter(i):this._descriptors(t),r=this._notify(s,t,e,n);return"afterDestroy"===e&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall")),r}_notify(t,e,n,i){i=i||{};for(const s of t){const t=s.plugin;if(!1===Ed(t[n],[e,i,s.options],t)&&i.cancelable)return!1}return!0}invalidate(){wd(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const n=t&&t.config,i=Td(n.options&&n.options.plugins,{}),s=function(t){const e={},n=[],i=Object.keys(Om.plugins.items);for(let t=0;t<i.length;t++)n.push(Om.getPlugin(i[t]));const s=t.plugins||[];for(let t=0;t<s.length;t++){const i=s[t];-1===n.indexOf(i)&&(n.push(i),e[i.id]=!0)}return{plugins:n,localIds:e}}(n);return!1!==i||e?function(t,{plugins:e,localIds:n},i,s){const r=[],o=t.getContext();for(const a of e){const e=a.id,l=Dm(i[e],s);null!==l&&r.push({plugin:a,options:Nm(t.config,{plugin:a,local:n[e]},l,o)})}return r}(t,s,i,e):[]}_notifyStateChanges(t){const e=this._oldCache||[],n=this._cache,i=(t,e)=>t.filter((t=>!e.some((e=>t.plugin.id===e.plugin.id))));this._notify(i(e,n),t,"stop"),this._notify(i(n,e),t,"start")}}function Dm(t,e){return e||!1!==t?!0===t?{}:t:null}function Nm(t,{plugin:e,local:n},i,s){const r=t.pluginScopeKeys(e),o=t.getOptionScopes(i,r);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Lm(t,e){const n=Bp.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function Fm(t){if("x"===t||"y"===t||"r"===t)return t}function zm(t,...e){if(Fm(t))return t;for(const i of e){const e=i.axis||("top"===(n=i.position)||"bottom"===n?"x":"left"===n||"right"===n?"y":void 0)||t.length>1&&Fm(t[0].toLowerCase());if(e)return e}var n;throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function jm(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function Vm(t){const e=t.options||(t.options={});e.plugins=Td(e.plugins,{}),e.scales=function(t,e){const n=zp[t.type]||{scales:{}},i=e.scales||{},s=Lm(t.type,e),r=Object.create(null);return Object.keys(i).forEach((e=>{const o=i[e];if(!kd(o))return console.error(`Invalid scale configuration for scale: ${e}`);if(o._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${e}`);const a=zm(e,o,function(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter((e=>e.xAxisID===t||e.yAxisID===t));if(n.length)return jm(t,"x",n[0])||jm(t,"y",n[0])}return{}}(e,t),Bp.scales[o.type]),l=function(t,e){return t===e?"_index_":"_value_"}(a,s),c=n.scales||{};r[e]=Nd(Object.create(null),[{axis:a},o,c[a],c[l]])})),t.data.datasets.forEach((n=>{const s=n.type||t.type,o=n.indexAxis||Lm(s,e),a=(zp[s]||{}).scales||{};Object.keys(a).forEach((t=>{const e=function(t,e){let n=t;return"_index_"===t?n=e:"_value_"===t&&(n="x"===e?"y":"x"),n}(t,o),s=n[e+"AxisID"]||e;r[s]=r[s]||Object.create(null),Nd(r[s],[{axis:e},i[s],a[t]])}))})),Object.keys(r).forEach((t=>{const e=r[t];Nd(e,[Bp.scales[e.type],Bp.scale])})),r}(t,e)}function Um(t){return(t=t||{}).datasets=t.datasets||[],t.labels=t.labels||[],t}const Wm=new Map,Bm=new Set;function Hm(t,e){let n=Wm.get(t);return n||(n=e(),Wm.set(t,n),Bm.add(n)),n}const qm=(t,e,n)=>{const i=zd(e,n);void 0!==i&&t.add(i)};class $m{constructor(t){this._config=function(t){return(t=t||{}).data=Um(t.data),Vm(t),t}(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=Um(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Vm(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Hm(t,(()=>[[`datasets.${t}`,""]]))}datasetAnimationScopeKeys(t,e){return Hm(`${t}.transition.${e}`,(()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]]))}datasetElementScopeKeys(t,e){return Hm(`${t}-${e}`,(()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]]))}pluginScopeKeys(t){const e=t.id;return Hm(`${this.type}-plugin-${e}`,(()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]]))}_cachedScopes(t,e){const n=this._scopeCache;let i=n.get(t);return i&&!e||(i=new Map,n.set(t,i)),i}getOptionScopes(t,e,n){const{options:i,type:s}=this,r=this._cachedScopes(t,n),o=r.get(e);if(o)return o;const a=new Set;e.forEach((e=>{t&&(a.add(t),e.forEach((e=>qm(a,t,e)))),e.forEach((t=>qm(a,i,t))),e.forEach((t=>qm(a,zp[s]||{},t))),e.forEach((t=>qm(a,Bp,t))),e.forEach((t=>qm(a,jp,t)))}));const l=Array.from(a);return 0===l.length&&l.push(Object.create(null)),Bm.has(e)&&r.set(e,l),l}chartOptionScopes(){const{options:t,type:e}=this;return[t,zp[e]||{},Bp.datasets[e]||{},{type:e},Bp,jp]}resolveNamedOptions(t,e,n,i=[""]){const s={$shared:!0},{resolver:r,subPrefixes:o}=Km(this._resolverCache,t,i);let a=r;(function(t,e){const{isScriptable:n,isIndexable:i}=vf(t);for(const s of e){const e=n(s),r=i(s),o=(r||e)&&t[s];if(e&&(Ud(o)||Ym(o))||r&&xd(o))return!0}return!1})(r,e)&&(s.$shared=!1,a=yf(r,n=Ud(n)?n():n,this.createResolver(t,n,o)));for(const t of e)s[t]=a[t];return s}createResolver(t,e,n=[""],i){const{resolver:s}=Km(this._resolverCache,t,n);return kd(e)?yf(s,e,void 0,i):s}}function Km(t,e,n){let i=t.get(e);i||(i=new Map,t.set(e,i));const s=n.join();let r=i.get(s);return r||(r={resolver:_f(e,n),subPrefixes:n.filter((t=>!t.toLowerCase().includes("hover")))},i.set(s,r)),r}const Ym=t=>kd(t)&&Object.getOwnPropertyNames(t).some((e=>Ud(t[e]))),Gm=["top","bottom","left","right","chartArea"];function Jm(t,e){return"top"===t||"bottom"===t||-1===Gm.indexOf(t)&&"x"===e}function Xm(t,e){return function(n,i){return n[t]===i[t]?n[e]-i[e]:n[t]-i[t]}}function Qm(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Ed(n&&n.onComplete,[t],e)}function Zm(t){const e=t.chart,n=e.options.animation;Ed(n&&n.onProgress,[t],e)}function t_(t){return Ff()&&"string"==typeof t?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const e_={},n_=t=>{const e=t_(t);return Object.values(e_).filter((t=>t.canvas===e)).pop()};function i_(t,e,n){const i=Object.keys(t);for(const s of i){const i=+s;if(i>=e){const r=t[s];delete t[s],(n>0||i>e)&&(t[i+n]=r)}}}function s_(t,e,n){return t.options.clip?t[n]:e[n]}class r_{static defaults=Bp;static instances=e_;static overrides=zp;static registry=Om;static version="4.4.3";static getChart=n_;static register(...t){Om.add(...t),o_()}static unregister(...t){Om.remove(...t),o_()}constructor(t,e){const n=this.config=new $m(e),i=t_(t),s=n_(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const r=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(t){return!Ff()||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas?sm:vm}(i)),this.platform.updateConfig(n);const o=this.platform.acquireContext(i,r.aspectRatio),a=o&&o.canvas,l=a&&a.height,c=a&&a.width;this.id=bd(),this.ctx=o,this.canvas=a,this.width=c,this.height=l,this._options=r,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Am,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(t,e){let n;return function(...i){return e?(clearTimeout(n),n=setTimeout(t,e,i)):t.apply(this,i),e}}((t=>this.update(t)),r.resizeDelay||0),this._dataChanges=[],e_[this.id]=this,o&&a?(lg.listen(this,"complete",Qm),lg.listen(this,"progress",Zm),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:n,height:i,_aspectRatio:s}=this;return wd(t)?e&&s?s:i?n/i:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return Om}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():$f(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Kp(this.canvas,this.ctx),this}stop(){return lg.stop(this),this}resize(t,e){lg.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const n=this.options,i=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,r=this.platform.getMaximumSize(i,t,e,s),o=n.devicePixelRatio||this.platform.getDevicePixelRatio(),a=this.width?"resize":"attach";this.width=r.width,this.height=r.height,this._aspectRatio=this.aspectRatio,$f(this,o,!0)&&(this.notifyPlugins("resize",{size:r}),Ed(n.onResize,[this,r],this),this.attached&&this._doResize(a)&&this.render())}ensureScalesHaveIDs(){Pd(this.options.scales||{},((t,e)=>{t.id=e}))}buildOrUpdateScales(){const t=this.options,e=t.scales,n=this.scales,i=Object.keys(n).reduce(((t,e)=>(t[e]=!1,t)),{});let s=[];e&&(s=s.concat(Object.keys(e).map((t=>{const n=e[t],i=zm(t,n),s="r"===i,r="x"===i;return{options:n,dposition:s?"chartArea":r?"bottom":"left",dtype:s?"radialLinear":r?"category":"linear"}})))),Pd(s,(e=>{const s=e.options,r=s.id,o=zm(r,s),a=Td(s.type,e.dtype);void 0!==s.position&&Jm(s.position,o)===Jm(e.dposition)||(s.position=e.dposition),i[r]=!0;let l=null;r in n&&n[r].type===a?l=n[r]:(l=new(Om.getScale(a))({id:r,type:a,ctx:this.ctx,chart:this}),n[l.id]=l),l.init(s,t)})),Pd(i,((t,e)=>{t||delete n[e]})),Pd(n,(t=>{nm.configure(this,t,t.options),nm.addBox(this,t)}))}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,n=t.length;if(t.sort(((t,e)=>t.index-e.index)),n>e){for(let t=e;t<n;++t)this._destroyDatasetMeta(t);t.splice(e,n-e)}this._sortedMetasets=t.slice(0).sort(Xm("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach(((t,n)=>{0===e.filter((e=>e===t._dataset)).length&&this._destroyDatasetMeta(n)}))}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=e.length;n<i;n++){const i=e[n];let s=this.getDatasetMeta(n);const r=i.type||this.config.type;if(s.type&&s.type!==r&&(this._destroyDatasetMeta(n),s=this.getDatasetMeta(n)),s.type=r,s.indexAxis=i.indexAxis||Lm(r,this.options),s.order=i.order||0,s.index=n,s.label=""+i.label,s.visible=this.isDatasetVisible(n),s.controller)s.controller.updateIndex(n),s.controller.linkScales();else{const e=Om.getController(r),{datasetElementType:i,dataElementType:o}=Bp.datasets[r];Object.assign(e,{dataElementType:Om.getElement(o),datasetElementType:i&&Om.getElement(i)}),s.controller=new e(this,n),t.push(s.controller)}}return this._updateMetasets(),t}_resetElements(){Pd(this.data.datasets,((t,e)=>{this.getDatasetMeta(e).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const n=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0}))return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let r=0;for(let t=0,e=this.data.datasets.length;t<e;t++){const{controller:e}=this.getDatasetMeta(t),n=!i&&-1===s.indexOf(e);e.buildOrUpdateElements(n),r=Math.max(+e.getMaxOverflow(),r)}r=this._minPadding=n.layout.autoPadding?r:0,this._updateLayout(r),i||Pd(s,(t=>{t.reset()})),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Xm("z","_idx"));const{_active:o,_lastEvent:a}=this;a?this._eventHandler(a,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Pd(this.scales,(t=>{nm.removeBox(this,t)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),n=new Set(t.events);Wd(e,n)&&!!this._responsiveListeners===t.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:s}of e)i_(t,i,"_removeElements"===n?-s:s)}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,n=e=>new Set(t.filter((t=>t[0]===e)).map(((t,e)=>e+","+t.splice(1).join(",")))),i=n(0);for(let t=1;t<e;t++)if(!Wd(i,n(t)))return;return Array.from(i).map((t=>t.split(","))).map((t=>({method:t[1],start:+t[2],count:+t[3]})))}_updateLayout(t){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;nm.update(this,this.width,this.height,t);const e=this.chartArea,n=e.width<=0||e.height<=0;this._layers=[],Pd(this.boxes,(t=>{n&&"chartArea"===t.position||(t.configure&&t.configure(),this._layers.push(...t._layers()))}),this),this._layers.forEach(((t,e)=>{t._idx=e})),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})){for(let t=0,e=this.data.datasets.length;t<e;++t)this.getDatasetMeta(t).controller.configure();for(let e=0,n=this.data.datasets.length;e<n;++e)this._updateDataset(e,Ud(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const n=this.getDatasetMeta(t),i={meta:n,index:t,mode:e,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",i)&&(n.controller._update(e),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(lg.has(this)?this.attached&&!lg.running(this)&&lg.start(this):(this.draw(),Qm({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:t,height:e}=this._resizeBeforeDraw;this._resize(t,e),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,n=[];let i,s;for(i=0,s=e.length;i<s;++i){const s=e[i];t&&!s.visible||n.push(s)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,n=t._clip,i=!n.disabled,s=function(t,e){const{xScale:n,yScale:i}=t;return n&&i?{left:s_(n,e,"left"),right:s_(n,e,"right"),top:s_(i,e,"top"),bottom:s_(i,e,"bottom")}:e}(t,this.chartArea),r={meta:t,index:t.index,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetDraw",r)&&(i&&Xp(e,{left:!1===n.left?0:s.left-n.left,right:!1===n.right?this.width:s.right+n.right,top:!1===n.top?0:s.top-n.top,bottom:!1===n.bottom?this.height:s.bottom+n.bottom}),t.controller.draw(),i&&Qp(e),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(t){return Jp(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,n,i){const s=Hg.modes[e];return"function"==typeof s?s(this,t,n,i):[]}getDatasetMeta(t){const e=this.data.datasets[t],n=this._metasets;let i=n.filter((t=>t&&t._dataset===e)).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=mf(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const n=this.getDatasetMeta(t);return"boolean"==typeof n.hidden?!n.hidden:!e.hidden}setDatasetVisibility(t,e){this.getDatasetMeta(t).hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,n){const i=n?"show":"hide",s=this.getDatasetMeta(t),r=s.controller._resolveAnimations(void 0,i);Vd(e)?(s.data[e].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),r.update(s,{visible:n}),this.update((e=>e.datasetIndex===t?i:void 0)))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),lg.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Kp(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete e_[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(t,e,n)=>{t.offsetX=e,t.offsetY=n,this._eventHandler(t)};Pd(this.options.events,(t=>n(t,i)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,n=(n,i)=>{e.addEventListener(this,n,i),t[n]=i},i=(n,i)=>{t[n]&&(e.removeEventListener(this,n,i),delete t[n])},s=(t,e)=>{this.canvas&&this.resize(t,e)};let r;const o=()=>{i("attach",o),this.attached=!0,this.resize(),n("resize",s),n("detach",r)};r=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),n("attach",o)},e.isAttached(this.canvas)?o():r()}unbindEvents(){Pd(this._listeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._listeners={},Pd(this._responsiveListeners,((t,e)=>{this.platform.removeEventListener(this,e,t)})),this._responsiveListeners=void 0}updateHoverStyle(t,e,n){const i=n?"set":"remove";let s,r,o,a;for("dataset"===e&&(s=this.getDatasetMeta(t[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),o=0,a=t.length;o<a;++o){r=t[o];const e=r&&this.getDatasetMeta(r.datasetIndex).controller;e&&e[i+"HoverStyle"](r.element,r.datasetIndex,r.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],n=t.map((({datasetIndex:t,index:e})=>{const n=this.getDatasetMeta(t);if(!n)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:n.data[e],index:e}}));!Md(n,e)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,e))}notifyPlugins(t,e,n){return this._plugins.notify(this,t,e,n)}isPluginEnabled(t){return 1===this._plugins._cache.filter((e=>e.plugin.id===t)).length}_updateHoverStyles(t,e,n){const i=this.options.hover,s=(t,e)=>t.filter((t=>!e.some((e=>t.datasetIndex===e.datasetIndex&&t.index===e.index)))),r=s(e,t),o=n?t:s(t,e);r.length&&this.updateHoverStyle(r,i.mode,!1),o.length&&i.mode&&this.updateHoverStyle(o,i.mode,!0)}_eventHandler(t,e){const n={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},i=e=>(e.options.events||this.options.events).includes(t.native.type);if(!1===this.notifyPlugins("beforeEvent",n,i))return;const s=this._handleEvent(t,e,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(s||n.changed)&&this.render(),this}_handleEvent(t,e,n){const{_active:i=[],options:s}=this,r=e,o=this._getActiveElements(t,i,n,r),a=function(t){return"mouseup"===t.type||"click"===t.type||"contextmenu"===t.type}(t),l=function(t,e,n,i){return n&&"mouseout"!==t.type?i?e:t:null}(t,this._lastEvent,n,a);n&&(this._lastEvent=null,Ed(s.onHover,[t,o,this],this),a&&Ed(s.onClick,[t,o,this],this));const c=!Md(o,i);return(c||e)&&(this._active=o,this._updateHoverStyles(o,i,e)),this._lastEvent=l,c}_getActiveElements(t,e,n,i){if("mouseout"===t.type)return[];if(!n)return e;const s=this.options.hover;return this.getElementsAtEventForMode(t,s.mode,s,i)}}function o_(){return Pd(r_.instances,(t=>t._plugins.invalidate()))}function a_(t,e,n,i){return{x:n+t*Math.cos(e),y:i+t*Math.sin(e)}}function l_(t,e,n,i,s,r){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:h}=e,u=Math.max(e.outerRadius+i+n-c,0),d=h>0?h+i+n+c:0;let p=0;const f=s-l;if(i){const t=((h>0?h-i:0)+(u>0?u-i:0))/2;p=(f-(0!==t?f*t/(t+i):f))/2}const g=(f-Math.max(.001,f*u-n/Bd)/u)/2,m=l+g+p,_=s-g-p,{outerStart:y,outerEnd:v,innerStart:b,innerEnd:w}=function(t,e,n,i){const s=hf(t.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]),r=(n-e)/2,o=Math.min(r,i*e/2),a=t=>{const e=(n-Math.min(r,t))*i/2;return up(t,0,Math.min(r,e))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:up(s.innerStart,0,o),innerEnd:up(s.innerEnd,0,o)}}(e,d,u,_-m),x=u-y,k=u-v,C=m+y/x,I=_-v/k,T=d+b,S=d+w,E=m+b/T,P=_-w/S;if(t.beginPath(),r){const e=(C+I)/2;if(t.arc(o,a,u,C,e),t.arc(o,a,u,e,I),v>0){const e=a_(k,I,o,a);t.arc(e.x,e.y,v,I,_+Yd)}const n=a_(S,_,o,a);if(t.lineTo(n.x,n.y),w>0){const e=a_(S,P,o,a);t.arc(e.x,e.y,w,_+Yd,P+Math.PI)}const i=(_-w/d+(m+b/d))/2;if(t.arc(o,a,d,_-w/d,i,!0),t.arc(o,a,d,i,m+b/d,!0),b>0){const e=a_(T,E,o,a);t.arc(e.x,e.y,b,E+Math.PI,m-Yd)}const s=a_(x,m,o,a);if(t.lineTo(s.x,s.y),y>0){const e=a_(x,C,o,a);t.arc(e.x,e.y,y,m-Yd,C)}}else{t.moveTo(o,a);const e=Math.cos(C)*u+o,n=Math.sin(C)*u+a;t.lineTo(e,n);const i=Math.cos(I)*u+o,s=Math.sin(I)*u+a;t.lineTo(i,s)}t.closePath()}function c_(t,e,n=e){t.lineCap=Td(n.borderCapStyle,e.borderCapStyle),t.setLineDash(Td(n.borderDash,e.borderDash)),t.lineDashOffset=Td(n.borderDashOffset,e.borderDashOffset),t.lineJoin=Td(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Td(n.borderWidth,e.borderWidth),t.strokeStyle=Td(n.borderColor,e.borderColor)}function h_(t,e,n){t.lineTo(n.x,n.y)}function u_(t,e,n={}){const i=t.length,{start:s=0,end:r=i-1}=n,{start:o,end:a}=e,l=Math.max(s,o),c=Math.min(r,a),h=s<o&&r<o||s>a&&r>a;return{count:i,start:l,loop:e.loop,ilen:c<l&&!h?i+c-l:c-l}}function d_(t,e,n,i){const{points:s,options:r}=e,{count:o,start:a,loop:l,ilen:c}=u_(s,n,i),h=function(t){return t.stepped?Zp:t.tension||"monotone"===t.cubicInterpolationMode?tf:h_}(r);let u,d,p,{move:f=!0,reverse:g}=i||{};for(u=0;u<=c;++u)d=s[(a+(g?c-u:u))%o],d.skip||(f?(t.moveTo(d.x,d.y),f=!1):h(t,p,d,g,r.stepped),p=d);return l&&(d=s[(a+(g?c:0))%o],h(t,p,d,g,r.stepped)),!!l}function p_(t,e,n,i){const s=e.points,{count:r,start:o,ilen:a}=u_(s,n,i),{move:l=!0,reverse:c}=i||{};let h,u,d,p,f,g,m=0,_=0;const y=t=>(o+(c?a-t:t))%r,v=()=>{p!==f&&(t.lineTo(m,f),t.lineTo(m,p),t.lineTo(m,g))};for(l&&(u=s[y(0)],t.moveTo(u.x,u.y)),h=0;h<=a;++h){if(u=s[y(h)],u.skip)continue;const e=u.x,n=u.y,i=0|e;i===d?(n<p?p=n:n>f&&(f=n),m=(_*m+e)/++_):(v(),t.lineTo(e,n),d=i,_=0,p=f=n),g=n}v()}function f_(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return t._decimated||t._loop||e.tension||"monotone"===e.cubicInterpolationMode||e.stepped||n?d_:p_}const g_="function"==typeof Path2D;class m_ extends bm{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t&&"fill"!==t};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;Lf(this._points,n,t,i,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(t,e){const n=t.points,i=t.options.spanGaps,s=n.length;if(!s)return[];const r=!!t._loop,{start:o,end:a}=function(t,e,n,i){let s=0,r=e-1;if(n&&!i)for(;s<e&&!t[s].skip;)s++;for(;s<e&&t[s].skip;)s++;for(s%=e,n&&(r+=s);r>s&&t[r%e].skip;)r--;return r%=e,{start:s,end:r}}(n,s,r,i);return function(t,e,n,i){return i&&i.setContext&&n?function(t,e,n,i){const s=t._chart.getContext(),r=rg(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=n.length,c=[];let h=r,u=e[0].start,d=u;function p(t,e,i,s){const r=a?-1:1;if(t!==e){for(t+=l;n[t%l].skip;)t-=r;for(;n[e%l].skip;)e+=r;t%l!=e%l&&(c.push({start:t%l,end:e%l,loop:i,style:s}),h=s,u=e%l)}}for(const t of e){u=a?u:t.start;let e,r=n[u%l];for(d=u+1;d<=t.end;d++){const a=n[d%l];e=rg(i.setContext(mf(s,{type:"segment",p0:r,p1:a,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:o}))),og(e,h)&&p(u,d-1,t.loop,h),r=a,h=e}u<d-1&&p(u,d-1,t.loop,h)}return c}(t,e,n,i):e}(t,!0===i?[{start:o,end:a,loop:r}]:function(t,e,n,i){const s=t.length,r=[];let o,a=e,l=t[e];for(o=e+1;o<=n;++o){const n=t[o%s];n.skip||n.stop?l.skip||(i=!1,r.push({start:e%s,end:(o-1)%s,loop:i}),e=a=n.stop?o:null):(a=o,l.skip&&(e=o)),l=n}return null!==a&&r.push({start:e%s,end:a%s,loop:i}),r}(n,o,a<o?a+s:a,!!t._fullLoop&&0===o&&a===s-1),n,e)}(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,n=t.length;return n&&e[t[n-1].end]}interpolate(t,e){const n=this.options,i=t[e],s=this.points,r=sg(this,{property:e,start:i,end:i});if(!r.length)return;const o=[],a=function(t){return t.stepped?Jf:t.tension||"monotone"===t.cubicInterpolationMode?Xf:Gf}(n);let l,c;for(l=0,c=r.length;l<c;++l){const{start:c,end:h}=r[l],u=s[c],d=s[h];if(u===d){o.push(u);continue}const p=a(u,d,Math.abs((i-u[e])/(d[e]-u[e])),n.stepped);p[e]=t[e],o.push(p)}return 1===o.length?o[0]:o}pathSegment(t,e,n){return f_(this)(t,this,e,n)}path(t,e,n){const i=this.segments,s=f_(this);let r=this._loop;e=e||0,n=n||this.points.length-e;for(const o of i)r&=s(t,this,o,{start:e,end:e+n-1});return!!r}draw(t,e,n,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(t.save(),function(t,e,n,i){g_&&!e.options.segment?function(t,e,n,i){let s=e._path;s||(s=e._path=new Path2D,e.path(s,n,i)&&s.closePath()),c_(t,e.options),t.stroke(s)}(t,e,n,i):function(t,e,n,i){const{segments:s,options:r}=e,o=f_(e);for(const a of s)c_(t,r,a.style),t.beginPath(),o(t,e,a,{start:n,end:n+i-1})&&t.closePath(),t.stroke()}(t,e,n,i)}(t,this,n,i),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function __(t,e,n,i){const s=t.options,{[n]:r}=t.getProps([n],i);return Math.abs(e-r)<s.radius+s.hitRadius}function y_(t,e){const{x:n,y:i,base:s,width:r,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,c,h,u;return t.horizontal?(u=o/2,a=Math.min(n,s),l=Math.max(n,s),c=i-u,h=i+u):(u=r/2,a=n-u,l=n+u,c=Math.min(i,s),h=Math.max(i,s)),{left:a,top:c,right:l,bottom:h}}function v_(t,e,n,i){return t?0:up(e,n,i)}function b_(t,e,n,i){const s=null===e,r=null===n,o=t&&!(s&&r)&&y_(t,i);return o&&(s||dp(e,o.left,o.right))&&(r||dp(n,o.top,o.bottom))}function w_(t,e){t.rect(e.x,e.y,e.w,e.h)}function x_(t,e,n={}){const i=t.x!==n.x?-e:0,s=t.y!==n.y?-e:0,r=(t.x+t.w!==n.x+n.w?e:0)-i,o=(t.y+t.h!==n.y+n.h?e:0)-s;return{x:t.x+i,y:t.y+s,w:t.w+r,h:t.h+o,radius:t.radius}}var k_=Object.freeze({__proto__:null,ArcElement:class extends bm{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>"borderDash"!==t};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,n){const i=this.getProps(["x","y"],n),{angle:s,distance:r}=op(i,{x:t,y:e}),{startAngle:o,endAngle:a,innerRadius:l,outerRadius:c,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),u=(this.options.spacing+this.options.borderWidth)/2,d=Td(h,a-o)>=Hd||hp(s,o,a),p=dp(r,l+u,c+u);return d&&p}getCenterPoint(t){const{x:e,y:n,startAngle:i,endAngle:s,innerRadius:r,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:a,spacing:l}=this.options,c=(i+s)/2,h=(r+o+l+a)/2;return{x:e+Math.cos(c)*h,y:n+Math.sin(c)*h}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:n}=this,i=(e.offset||0)/4,s=(e.spacing||0)/2,r=e.circular;if(this.pixelMargin="inner"===e.borderAlign?.33:0,this.fullCircles=n>Hd?Math.floor(n/Hd):0,0===n||this.innerRadius<0||this.outerRadius<0)return;t.save();const o=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(o)*i,Math.sin(o)*i);const a=i*(1-Math.sin(Math.min(Bd,n||0)));t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,function(t,e,n,i,s){const{fullCircles:r,startAngle:o,circumference:a}=e;let l=e.endAngle;if(r){l_(t,e,n,i,l,s);for(let e=0;e<r;++e)t.fill();isNaN(a)||(l=o+(a%Hd||Hd))}l_(t,e,n,i,l,s),t.fill()}(t,this,a,s,r),function(t,e,n,i,s){const{fullCircles:r,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:h,borderDash:u,borderDashOffset:d}=l,p="inner"===l.borderAlign;if(!c)return;t.setLineDash(u||[]),t.lineDashOffset=d,p?(t.lineWidth=2*c,t.lineJoin=h||"round"):(t.lineWidth=c,t.lineJoin=h||"bevel");let f=e.endAngle;if(r){l_(t,e,n,i,f,s);for(let e=0;e<r;++e)t.stroke();isNaN(a)||(f=o+(a%Hd||Hd))}p&&function(t,e,n){const{startAngle:i,pixelMargin:s,x:r,y:o,outerRadius:a,innerRadius:l}=e;let c=s/a;t.beginPath(),t.arc(r,o,a,i-c,n+c),l>s?(c=s/l,t.arc(r,o,l,n+c,i-c,!0)):t.arc(r,o,s,n+Yd,i-Yd),t.closePath(),t.clip()}(t,e,f),r||(l_(t,e,n,i,f,s),t.stroke())}(t,this,a,s,r),t.restore()}},BarElement:class extends bm{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:n,backgroundColor:i}}=this,{inner:s,outer:r}=function(t){const e=y_(t),n=e.right-e.left,i=e.bottom-e.top,s=function(t,e,n){const i=t.options.borderWidth,s=t.borderSkipped,r=uf(i);return{t:v_(s.top,r.top,0,n),r:v_(s.right,r.right,0,e),b:v_(s.bottom,r.bottom,0,n),l:v_(s.left,r.left,0,e)}}(t,n/2,i/2),r=function(t,e,n){const{enableBorderRadius:i}=t.getProps(["enableBorderRadius"]),s=t.options.borderRadius,r=df(s),o=Math.min(e,n),a=t.borderSkipped,l=i||kd(s);return{topLeft:v_(!l||a.top||a.left,r.topLeft,0,o),topRight:v_(!l||a.top||a.right,r.topRight,0,o),bottomLeft:v_(!l||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:v_(!l||a.bottom||a.right,r.bottomRight,0,o)}}(t,n/2,i/2);return{outer:{x:e.left,y:e.top,w:n,h:i,radius:r},inner:{x:e.left+s.l,y:e.top+s.t,w:n-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,r.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(s.b,s.r))}}}}(this),o=(a=r.radius).topLeft||a.topRight||a.bottomLeft||a.bottomRight?rf:w_;var a;t.save(),r.w===s.w&&r.h===s.h||(t.beginPath(),o(t,x_(r,e,s)),t.clip(),o(t,x_(s,-e,r)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),o(t,x_(s,e)),t.fillStyle=i,t.fill(),t.restore()}inRange(t,e,n){return b_(this,t,e,n)}inXRange(t,e){return b_(this,t,null,e)}inYRange(t,e){return b_(this,null,t,e)}getCenterPoint(t){const{x:e,y:n,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],t);return{x:s?(e+i)/2:e,y:s?n:(n+i)/2}}getRange(t){return"x"===t?this.width/2:this.height/2}},LineElement:m_,PointElement:class extends bm{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,n){const i=this.options,{x:s,y:r}=this.getProps(["x","y"],n);return Math.pow(t-s,2)+Math.pow(e-r,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(t,e){return __(this,t,"x",e)}inYRange(t,e){return __(this,t,"y",e)}getCenterPoint(t){const{x:e,y:n}=this.getProps(["x","y"],t);return{x:e,y:n}}size(t){let e=(t=t||this.options||{}).radius||0;return e=Math.max(e,e&&t.hoverRadius||0),2*(e+(e&&t.borderWidth||0))}draw(t,e){const n=this.options;this.skip||n.radius<.1||!Jp(this,e,this.size(n)/2)||(t.strokeStyle=n.borderColor,t.lineWidth=n.borderWidth,t.fillStyle=n.backgroundColor,Yp(t,n,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}});const C_=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],I_=C_.map((t=>t.replace("rgb(","rgba(").replace(")",", 0.5)")));function T_(t){return C_[t%C_.length]}function S_(t){return I_[t%I_.length]}function E_(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}var P_={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,n){if(!n.enabled)return;const{data:{datasets:i},options:s}=t.config,{elements:r}=s;if(!n.forceOverride&&(E_(i)||(o=s)&&(o.borderColor||o.backgroundColor)||r&&E_(r)))return;var o;const a=function(t){let e=0;return(n,i)=>{const s=t.getDatasetMeta(i).controller;s instanceof Ag?e=function(t,e){return t.backgroundColor=t.data.map((()=>T_(e++))),e}(n,e):s instanceof Dg?e=function(t,e){return t.backgroundColor=t.data.map((()=>S_(e++))),e}(n,e):s&&(e=function(t,e){return t.borderColor=T_(e),t.backgroundColor=S_(e),++e}(n,e))}}(t);i.forEach(a)}};function M_(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function R_(t){t.data.datasets.forEach((t=>{M_(t)}))}var O_={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,n)=>{if(!n.enabled)return void R_(t);const i=t.width;t.data.datasets.forEach(((e,s)=>{const{_data:r,indexAxis:o}=e,a=t.getDatasetMeta(s),l=r||e.data;if("y"===gf([o,t.options.indexAxis]))return;if(!a.controller.supportsDecimation)return;const c=t.scales[a.xAxisID];if("linear"!==c.type&&"time"!==c.type)return;if(t.options.parsing)return;let h,{start:u,count:d}=function(t,e){const n=e.length;let i,s=0;const{iScale:r}=t,{min:o,max:a,minDefined:l,maxDefined:c}=r.getUserBounds();return l&&(s=up(fp(e,r.axis,o).lo,0,n-1)),i=c?up(fp(e,r.axis,a).hi+1,s,n)-s:n-s,{start:s,count:i}}(a,l);if(d<=(n.threshold||4*i))M_(e);else{switch(wd(r)&&(e._data=l,delete e.data,Object.defineProperty(e,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(t){this._data=t}})),n.algorithm){case"lttb":h=function(t,e,n,i,s){const r=s.samples||i;if(r>=n)return t.slice(e,e+n);const o=[],a=(n-2)/(r-2);let l=0;const c=e+n-1;let h,u,d,p,f,g=e;for(o[l++]=t[g],h=0;h<r-2;h++){let i,s=0,r=0;const c=Math.floor((h+1)*a)+1+e,m=Math.min(Math.floor((h+2)*a)+1,n)+e,_=m-c;for(i=c;i<m;i++)s+=t[i].x,r+=t[i].y;s/=_,r/=_;const y=Math.floor(h*a)+1+e,v=Math.min(Math.floor((h+1)*a)+1,n)+e,{x:b,y:w}=t[g];for(d=p=-1,i=y;i<v;i++)p=.5*Math.abs((b-s)*(t[i].y-w)-(b-t[i].x)*(r-w)),p>d&&(d=p,u=t[i],f=i);o[l++]=u,g=f}return o[l++]=t[c],o}(l,u,d,i,n);break;case"min-max":h=function(t,e,n,i){let s,r,o,a,l,c,h,u,d,p,f=0,g=0;const m=[],_=e+n-1,y=t[e].x,v=t[_].x-y;for(s=e;s<e+n;++s){r=t[s],o=(r.x-y)/v*i,a=r.y;const e=0|o;if(e===l)a<d?(d=a,c=s):a>p&&(p=a,h=s),f=(g*f+r.x)/++g;else{const n=s-1;if(!wd(c)&&!wd(h)){const e=Math.min(c,h),i=Math.max(c,h);e!==u&&e!==n&&m.push({...t[e],x:f}),i!==u&&i!==n&&m.push({...t[i],x:f})}s>0&&n!==u&&m.push(t[n]),m.push(r),l=e,g=0,d=p=a,c=h=u=s}}return m}(l,u,d,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}e._decimated=h}}))},destroy(t){R_(t)}};function A_(t,e,n,i){if(i)return;let s=e[t],r=n[t];return"angle"===t&&(s=cp(s),r=cp(r)),{property:t,start:s,end:r}}function D_(t,e,n){for(;e>t;e--){const t=n[e];if(!isNaN(t.x)&&!isNaN(t.y))break}return e}function N_(t,e,n,i){return t&&e?i(t[n],e[n]):t?t[n]:e?e[n]:0}function L_(t,e){let n=[],i=!1;return xd(t)?(i=!0,n=t):n=function(t,e){const{x:n=null,y:i=null}=t||{},s=e.points,r=[];return e.segments.forEach((({start:t,end:e})=>{e=D_(t,e,s);const o=s[t],a=s[e];null!==i?(r.push({x:o.x,y:i}),r.push({x:a.x,y:i})):null!==n&&(r.push({x:n,y:o.y}),r.push({x:n,y:a.y}))})),r}(t,e),n.length?new m_({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function F_(t){return t&&!1!==t.fill}function z_(t,e,n){let i=t[e].fill;const s=[e];let r;if(!n)return i;for(;!1!==i&&-1===s.indexOf(i);){if(!Cd(i))return i;if(r=t[i],!r)return!1;if(r.visible)return i;s.push(i),i=r.fill}return!1}function j_(t,e,n){const i=function(t){const e=t.options,n=e.fill;let i=Td(n&&n.target,n);return void 0===i&&(i=!!e.backgroundColor),!1!==i&&null!==i&&(!0===i?"origin":i)}(t);if(kd(i))return!isNaN(i.value)&&i;let s=parseFloat(i);return Cd(s)&&Math.floor(s)===s?function(t,e,n,i){return"-"!==t&&"+"!==t||(n=e+n),!(n===e||n<0||n>=i)&&n}(i[0],e,s,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function V_(t,e,n){const i=[];for(let s=0;s<n.length;s++){const r=n[s],{first:o,last:a,point:l}=U_(r,e,"x");if(!(!l||o&&a))if(o)i.unshift(l);else if(t.push(l),!a)break}t.push(...i)}function U_(t,e,n){const i=t.interpolate(e,n);if(!i)return{};const s=i[n],r=t.segments,o=t.points;let a=!1,l=!1;for(let t=0;t<r.length;t++){const e=r[t],i=o[e.start][n],c=o[e.end][n];if(dp(s,i,c)){a=s===i,l=s===c;break}}return{first:a,last:l,point:i}}class W_{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,n){const{x:i,y:s,radius:r}=this;return e=e||{start:0,end:Hd},t.arc(i,s,r,e.end,e.start,!0),!n.bounds}interpolate(t){const{x:e,y:n,radius:i}=this,s=t.angle;return{x:e+Math.cos(s)*i,y:n+Math.sin(s)*i,angle:s}}}function B_(t,e,n){const i=function(t){const{chart:e,fill:n,line:i}=t;if(Cd(n))return function(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}(e,n);if("stack"===n)return function(t){const{scale:e,index:n,line:i}=t,s=[],r=i.segments,o=i.points,a=function(t,e){const n=[],i=t.getMatchingVisibleMetas("line");for(let t=0;t<i.length;t++){const s=i[t];if(s.index===e)break;s.hidden||n.unshift(s.dataset)}return n}(e,n);a.push(L_({x:null,y:e.bottom},i));for(let t=0;t<r.length;t++){const e=r[t];for(let t=e.start;t<=e.end;t++)V_(s,o[t],a)}return new m_({points:s,options:{}})}(t);if("shape"===n)return!0;const s=function(t){return(t.scale||{}).getPointPositionForValue?function(t){const{scale:e,fill:n}=t,i=e.options,s=e.getLabels().length,r=i.reverse?e.max:e.min,o=function(t,e,n){let i;return i="start"===t?n:"end"===t?e.options.reverse?e.min:e.max:kd(t)?t.value:e.getBaseValue(),i}(n,e,r),a=[];if(i.grid.circular){const t=e.getPointPositionForValue(0,r);return new W_({x:t.x,y:t.y,radius:e.getDistanceFromCenterForValue(o)})}for(let t=0;t<s;++t)a.push(e.getPointPositionForValue(t,o));return a}(t):function(t){const{scale:e={},fill:n}=t,i=function(t,e){let n=null;return"start"===t?n=e.bottom:"end"===t?n=e.top:kd(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}(n,e);if(Cd(i)){const t=e.isHorizontal();return{x:t?i:null,y:t?null:i}}return null}(t)}(t);return s instanceof W_?s:L_(s,i)}(e),{line:s,scale:r,axis:o}=e,a=s.options,l=a.fill,c=a.backgroundColor,{above:h=c,below:u=c}=l||{};i&&s.points.length&&(Xp(t,n),function(t,e){const{line:n,target:i,above:s,below:r,area:o,scale:a}=e,l=n._loop?"angle":e.axis;t.save(),"x"===l&&r!==s&&(H_(t,i,o.top),q_(t,{line:n,target:i,color:s,scale:a,property:l}),t.restore(),t.save(),H_(t,i,o.bottom)),q_(t,{line:n,target:i,color:r,scale:a,property:l}),t.restore()}(t,{line:s,target:i,above:h,below:u,area:n,scale:r,axis:o}),Qp(t))}function H_(t,e,n){const{segments:i,points:s}=e;let r=!0,o=!1;t.beginPath();for(const a of i){const{start:i,end:l}=a,c=s[i],h=s[D_(i,l,s)];r?(t.moveTo(c.x,c.y),r=!1):(t.lineTo(c.x,n),t.lineTo(c.x,c.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(h.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function q_(t,e){const{line:n,target:i,property:s,color:r,scale:o}=e,a=function(t,e,n){const i=t.segments,s=t.points,r=e.points,o=[];for(const t of i){let{start:i,end:a}=t;a=D_(i,a,s);const l=A_(n,s[i],s[a],t.loop);if(!e.segments){o.push({source:t,target:l,start:s[i],end:s[a]});continue}const c=sg(e,l);for(const e of c){const i=A_(n,r[e.start],r[e.end],e.loop),a=ig(t,s,i);for(const t of a)o.push({source:t,target:e,start:{[n]:N_(l,i,"start",Math.max)},end:{[n]:N_(l,i,"end",Math.min)}})}}return o}(n,i,s);for(const{source:e,target:l,start:c,end:h}of a){const{style:{backgroundColor:a=r}={}}=e,u=!0!==i;t.save(),t.fillStyle=a,$_(t,o,u&&A_(s,c,h)),t.beginPath();const d=!!n.pathSegment(t,e);let p;if(u){d?t.closePath():K_(t,i,h,s);const e=!!i.pathSegment(t,l,{move:d,reverse:!0});p=d&&e,p||K_(t,i,c,s)}t.closePath(),t.fill(p?"evenodd":"nonzero"),t.restore()}}function $_(t,e,n){const{top:i,bottom:s}=e.chart.chartArea,{property:r,start:o,end:a}=n||{};"x"===r&&(t.beginPath(),t.rect(o,i,a-o,s-i),t.clip())}function K_(t,e,n,i){const s=e.interpolate(n,i);s&&t.lineTo(s.x,s.y)}var Y_={id:"filler",afterDatasetsUpdate(t,e,n){const i=(t.data.datasets||[]).length,s=[];let r,o,a,l;for(o=0;o<i;++o)r=t.getDatasetMeta(o),a=r.dataset,l=null,a&&a.options&&a instanceof m_&&(l={visible:t.isDatasetVisible(o),index:o,fill:j_(a,o,i),chart:t,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=l,s.push(l);for(o=0;o<i;++o)l=s[o],l&&!1!==l.fill&&(l.fill=z_(s,o,n.propagate))},beforeDraw(t,e,n){const i="beforeDraw"===n.drawTime,s=t.getSortedVisibleDatasetMetas(),r=t.chartArea;for(let e=s.length-1;e>=0;--e){const n=s[e].$filler;n&&(n.line.updateControlPoints(r,n.axis),i&&n.fill&&B_(t.ctx,n,r))}},beforeDatasetsDraw(t,e,n){if("beforeDatasetsDraw"!==n.drawTime)return;const i=t.getSortedVisibleDatasetMetas();for(let e=i.length-1;e>=0;--e){const n=i[e].$filler;F_(n)&&B_(t.ctx,n,t.chartArea)}},beforeDatasetDraw(t,e,n){const i=e.meta.$filler;F_(i)&&"beforeDatasetDraw"===n.drawTime&&B_(t.ctx,i,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const G_=(t,e)=>{let{boxHeight:n=e,boxWidth:i=e}=t;return t.usePointStyle&&(n=Math.min(n,e),i=t.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(e,n)}};class J_ extends bm{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,n){this.maxWidth=t,this.maxHeight=e,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=Ed(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter((e=>t.filter(e,this.chart.data)))),t.sort&&(e=e.sort(((e,n)=>t.sort(e,n,this.chart.data)))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display)return void(this.width=this.height=0);const n=t.labels,i=ff(n.font),s=i.size,r=this._computeTitleHeight(),{boxWidth:o,itemHeight:a}=G_(n,s);let l,c;e.font=i.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(r,s,o,a)+10):(c=this.maxHeight,l=this._fitCols(r,i,o,a)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(c,t.maxHeight||this.maxHeight)}_fitRows(t,e,n,i){const{ctx:s,maxWidth:r,options:{labels:{padding:o}}}=this,a=this.legendHitBoxes=[],l=this.lineWidths=[0],c=i+o;let h=t;s.textAlign="left",s.textBaseline="middle";let u=-1,d=-c;return this.legendItems.forEach(((t,p)=>{const f=n+e/2+s.measureText(t.text).width;(0===p||l[l.length-1]+f+2*o>r)&&(h+=c,l[l.length-(p>0?0:1)]=0,d+=c,u++),a[p]={left:0,top:d,row:u,width:f,height:i},l[l.length-1]+=f+o})),h}_fitCols(t,e,n,i){const{ctx:s,maxHeight:r,options:{labels:{padding:o}}}=this,a=this.legendHitBoxes=[],l=this.columnSizes=[],c=r-t;let h=o,u=0,d=0,p=0,f=0;return this.legendItems.forEach(((t,r)=>{const{itemWidth:g,itemHeight:m}=function(t,e,n,i,s){const r=function(t,e,n,i){let s=t.text;return s&&"string"!=typeof s&&(s=s.reduce(((t,e)=>t.length>e.length?t:e))),e+n.size/2+i.measureText(s).width}(i,t,e,n),o=function(t,e,n){let i=t;return"string"!=typeof e.text&&(i=X_(e,n)),i}(s,i,e.lineHeight);return{itemWidth:r,itemHeight:o}}(n,e,s,t,i);r>0&&d+m+2*o>c&&(h+=u+o,l.push({width:u,height:d}),p+=u+o,f++,u=d=0),a[r]={left:p,top:d,col:f,width:g,height:m},u=Math.max(u,g),d+=m+o})),h+=u,l.push({width:u,height:d}),h}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:n,labels:{padding:i},rtl:s}}=this,r=Qf(s,this.left,this.width);if(this.isHorizontal()){let s=0,o=xp(n,this.left+i,this.right-this.lineWidths[s]);for(const a of e)s!==a.row&&(s=a.row,o=xp(n,this.left+i,this.right-this.lineWidths[s])),a.top+=this.top+t+i,a.left=r.leftForLtr(r.x(o),a.width),o+=a.width+i}else{let s=0,o=xp(n,this.top+t+i,this.bottom-this.columnSizes[s].height);for(const a of e)a.col!==s&&(s=a.col,o=xp(n,this.top+t+i,this.bottom-this.columnSizes[s].height)),a.top=o,a.left+=this.left+i,a.left=r.leftForLtr(r.x(a.left),a.width),o+=a.height+i}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const t=this.ctx;Xp(t,this),this._draw(),Qp(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:n,ctx:i}=this,{align:s,labels:r}=t,o=Bp.color,a=Qf(t.rtl,this.left,this.width),l=ff(r.font),{padding:c}=r,h=l.size,u=h/2;let d;this.drawTitle(),i.textAlign=a.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=l.string;const{boxWidth:p,boxHeight:f,itemHeight:g}=G_(r,h),m=this.isHorizontal(),_=this._computeTitleHeight();d=m?{x:xp(s,this.left+c,this.right-n[0]),y:this.top+c+_,line:0}:{x:this.left+c,y:xp(s,this.top+_+c,this.bottom-e[0].height),line:0},Zf(this.ctx,t.textDirection);const y=g+c;this.legendItems.forEach(((v,b)=>{i.strokeStyle=v.fontColor,i.fillStyle=v.fontColor;const w=i.measureText(v.text).width,x=a.textAlign(v.textAlign||(v.textAlign=r.textAlign)),k=p+u+w;let C=d.x,I=d.y;if(a.setWidth(this.width),m?b>0&&C+k+c>this.right&&(I=d.y+=y,d.line++,C=d.x=xp(s,this.left+c,this.right-n[d.line])):b>0&&I+y>this.bottom&&(C=d.x=C+e[d.line].width+c,d.line++,I=d.y=xp(s,this.top+_+c,this.bottom-e[d.line].height)),function(t,e,n){if(isNaN(p)||p<=0||isNaN(f)||f<0)return;i.save();const s=Td(n.lineWidth,1);if(i.fillStyle=Td(n.fillStyle,o),i.lineCap=Td(n.lineCap,"butt"),i.lineDashOffset=Td(n.lineDashOffset,0),i.lineJoin=Td(n.lineJoin,"miter"),i.lineWidth=s,i.strokeStyle=Td(n.strokeStyle,o),i.setLineDash(Td(n.lineDash,[])),r.usePointStyle){const o={radius:f*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:s},l=a.xPlus(t,p/2);Gp(i,o,l,e+u,r.pointStyleWidth&&p)}else{const r=e+Math.max((h-f)/2,0),o=a.leftForLtr(t,p),l=df(n.borderRadius);i.beginPath(),Object.values(l).some((t=>0!==t))?rf(i,{x:o,y:r,w:p,h:f,radius:l}):i.rect(o,r,p,f),i.fill(),0!==s&&i.stroke()}i.restore()}(a.x(C),I,v),C=((t,e,n,i)=>t===(i?"left":"right")?n:"center"===t?(e+n)/2:e)(x,C+p+u,m?C+k:this.right,t.rtl),function(t,e,n){sf(i,n.text,t,e+g/2,l,{strikethrough:n.hidden,textAlign:a.textAlign(n.textAlign)})}(a.x(C),I,v),m)d.x+=k+c;else if("string"!=typeof v.text){const t=l.lineHeight;d.y+=X_(v,t)+c}else d.y+=y})),tg(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,n=ff(e.font),i=pf(e.padding);if(!e.display)return;const s=Qf(t.rtl,this.left,this.width),r=this.ctx,o=e.position,a=n.size/2,l=i.top+a;let c,h=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),c=this.top+l,h=xp(t.align,h,this.right-u);else{const e=this.columnSizes.reduce(((t,e)=>Math.max(t,e.height)),0);c=l+xp(t.align,this.top,this.bottom-e-t.labels.padding-this._computeTitleHeight())}const d=xp(o,h,h+u);r.textAlign=s.textAlign(wp(o)),r.textBaseline="middle",r.strokeStyle=e.color,r.fillStyle=e.color,r.font=n.string,sf(r,e.text,d,c,n)}_computeTitleHeight(){const t=this.options.title,e=ff(t.font),n=pf(t.padding);return t.display?e.lineHeight+n.height:0}_getLegendItemAt(t,e){let n,i,s;if(dp(t,this.left,this.right)&&dp(e,this.top,this.bottom))for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(i=s[n],dp(t,i.left,i.left+i.width)&&dp(e,i.top,i.top+i.height))return this.legendItems[n];return null}handleEvent(t){const e=this.options;if(!function(t,e){return!("mousemove"!==t&&"mouseout"!==t||!e.onHover&&!e.onLeave)||!(!e.onClick||"click"!==t&&"mouseup"!==t)}(t.type,e))return;const n=this._getLegendItemAt(t.x,t.y);if("mousemove"===t.type||"mouseout"===t.type){const r=this._hoveredItem,o=(s=n,null!==(i=r)&&null!==s&&i.datasetIndex===s.datasetIndex&&i.index===s.index);r&&!o&&Ed(e.onLeave,[t,r,this],this),this._hoveredItem=n,n&&!o&&Ed(e.onHover,[t,n,this],this)}else n&&Ed(e.onClick,[t,n,this],this);var i,s}}function X_(t,e){return e*(t.text?t.text.length:0)}var Q_={id:"legend",_element:J_,start(t,e,n){const i=t.legend=new J_({ctx:t.ctx,options:n,chart:t});nm.configure(t,i,n),nm.addBox(t,i)},stop(t){nm.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const i=t.legend;nm.configure(t,i,n),i.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const i=e.datasetIndex,s=n.chart;s.isDatasetVisible(i)?(s.hide(i),e.hidden=!0):(s.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:s,color:r,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map((t=>{const l=t.controller.getStyle(n?0:void 0),c=pf(l.borderWidth);return{text:e[t.index].label,fillStyle:l.backgroundColor,fontColor:r,hidden:!t.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:i||l.pointStyle,rotation:l.rotation,textAlign:s||l.textAlign,borderRadius:o&&(a||l.borderRadius),datasetIndex:t.index}}),this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class Z_ extends bm{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const n=this.options;if(this.left=0,this.top=0,!n.display)return void(this.width=this.height=this.right=this.bottom=0);this.width=this.right=t,this.height=this.bottom=e;const i=xd(n.text)?n.text.length:1;this._padding=pf(n.padding);const s=i*ff(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const t=this.options.position;return"top"===t||"bottom"===t}_drawArgs(t){const{top:e,left:n,bottom:i,right:s,options:r}=this,o=r.align;let a,l,c,h=0;return this.isHorizontal()?(l=xp(o,n,s),c=e+t,a=s-n):("left"===r.position?(l=n+t,c=xp(o,i,e),h=-.5*Bd):(l=s-t,c=xp(o,e,i),h=.5*Bd),a=i-e),{titleX:l,titleY:c,maxWidth:a,rotation:h}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const n=ff(e.font),i=n.lineHeight/2+this._padding.top,{titleX:s,titleY:r,maxWidth:o,rotation:a}=this._drawArgs(i);sf(t,e.text,0,0,n,{color:e.color,maxWidth:o,rotation:a,textAlign:wp(e.align),textBaseline:"middle",translation:[s,r]})}}var ty={id:"title",_element:Z_,start(t,e,n){!function(t,e){const n=new Z_({ctx:t.ctx,options:e,chart:t});nm.configure(t,n,e),nm.addBox(t,n),t.titleBlock=n}(t,n)},stop(t){const e=t.titleBlock;nm.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const i=t.titleBlock;nm.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ey=new WeakMap;var ny={id:"subtitle",start(t,e,n){const i=new Z_({ctx:t.ctx,options:n,chart:t});nm.configure(t,i,n),nm.addBox(t,i),ey.set(t,i)},stop(t){nm.removeBox(t,ey.get(t)),ey.delete(t)},beforeUpdate(t,e,n){const i=ey.get(t);nm.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const iy={average(t){if(!t.length)return!1;let e,n,i=new Set,s=0,r=0;for(e=0,n=t.length;e<n;++e){const n=t[e].element;if(n&&n.hasValue()){const t=n.tooltipPosition();i.add(t.x),s+=t.y,++r}}return{x:[...i].reduce(((t,e)=>t+e))/i.size,y:s/r}},nearest(t,e){if(!t.length)return!1;let n,i,s,r=e.x,o=e.y,a=Number.POSITIVE_INFINITY;for(n=0,i=t.length;n<i;++n){const i=t[n].element;if(i&&i.hasValue()){const t=ap(e,i.getCenterPoint());t<a&&(a=t,s=i)}}if(s){const t=s.tooltipPosition();r=t.x,o=t.y}return{x:r,y:o}}};function sy(t,e){return e&&(xd(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function ry(t){return("string"==typeof t||t instanceof String)&&t.indexOf("\n")>-1?t.split("\n"):t}function oy(t,e){const{element:n,datasetIndex:i,index:s}=e,r=t.getDatasetMeta(i).controller,{label:o,value:a}=r.getLabelAndValue(s);return{chart:t,label:o,parsed:r.getParsed(s),raw:t.data.datasets[i].data[s],formattedValue:a,dataset:r.getDataset(),dataIndex:s,datasetIndex:i,element:n}}function ay(t,e){const n=t.chart.ctx,{body:i,footer:s,title:r}=t,{boxWidth:o,boxHeight:a}=e,l=ff(e.bodyFont),c=ff(e.titleFont),h=ff(e.footerFont),u=r.length,d=s.length,p=i.length,f=pf(e.padding);let g=f.height,m=0,_=i.reduce(((t,e)=>t+e.before.length+e.lines.length+e.after.length),0);_+=t.beforeBody.length+t.afterBody.length,u&&(g+=u*c.lineHeight+(u-1)*e.titleSpacing+e.titleMarginBottom),_&&(g+=p*(e.displayColors?Math.max(a,l.lineHeight):l.lineHeight)+(_-p)*l.lineHeight+(_-1)*e.bodySpacing),d&&(g+=e.footerMarginTop+d*h.lineHeight+(d-1)*e.footerSpacing);let y=0;const v=function(t){m=Math.max(m,n.measureText(t).width+y)};return n.save(),n.font=c.string,Pd(t.title,v),n.font=l.string,Pd(t.beforeBody.concat(t.afterBody),v),y=e.displayColors?o+2+e.boxPadding:0,Pd(i,(t=>{Pd(t.before,v),Pd(t.lines,v),Pd(t.after,v)})),y=0,n.font=h.string,Pd(t.footer,v),n.restore(),m+=f.width,{width:m,height:g}}function ly(t,e,n,i){const{x:s,width:r}=n,{width:o,chartArea:{left:a,right:l}}=t;let c="center";return"center"===i?c=s<=(a+l)/2?"left":"right":s<=r/2?c="left":s>=o-r/2&&(c="right"),function(t,e,n,i){const{x:s,width:r}=i,o=n.caretSize+n.caretPadding;return"left"===t&&s+r+o>e.width||"right"===t&&s-r-o<0||void 0}(c,t,e,n)&&(c="center"),c}function cy(t,e,n){const i=n.yAlign||e.yAlign||function(t,e){const{y:n,height:i}=e;return n<i/2?"top":n>t.height-i/2?"bottom":"center"}(t,n);return{xAlign:n.xAlign||e.xAlign||ly(t,e,n,i),yAlign:i}}function hy(t,e,n,i){const{caretSize:s,caretPadding:r,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,c=s+r,{topLeft:h,topRight:u,bottomLeft:d,bottomRight:p}=df(o);let f=function(t,e){let{x:n,width:i}=t;return"right"===e?n-=i:"center"===e&&(n-=i/2),n}(e,a);const g=function(t,e,n){let{y:i,height:s}=t;return"top"===e?i+=n:i-="bottom"===e?s+n:s/2,i}(e,l,c);return"center"===l?"left"===a?f+=c:"right"===a&&(f-=c):"left"===a?f-=Math.max(h,d)+s:"right"===a&&(f+=Math.max(u,p)+s),{x:up(f,0,i.width-e.width),y:up(g,0,i.height-e.height)}}function uy(t,e,n){const i=pf(n.padding);return"center"===e?t.x+t.width/2:"right"===e?t.x+t.width-i.right:t.x+i.left}function dy(t){return sy([],ry(t))}function py(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const fy={beforeTitle:vd,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,i=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return n[e.dataIndex]}return""},afterTitle:vd,beforeBody:vd,beforeLabel:vd,label(t){if(this&&this.options&&"dataset"===this.options.mode)return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return wd(n)||(e+=n),e},labelColor(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const e=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:vd,afterBody:vd,beforeFooter:vd,footer:vd,afterFooter:vd};function gy(t,e,n,i){const s=t[e].call(n,i);return void 0===s?fy[e].call(n,i):s}class my extends bm{static positioners=iy;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&e.options.animation&&n.animations,s=new dg(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=mf(this.chart.getContext(),{tooltip:this,tooltipItems:this._tooltipItems,type:"tooltip"}))}getTitle(t,e){const{callbacks:n}=e,i=gy(n,"beforeTitle",this,t),s=gy(n,"title",this,t),r=gy(n,"afterTitle",this,t);let o=[];return o=sy(o,ry(i)),o=sy(o,ry(s)),o=sy(o,ry(r)),o}getBeforeBody(t,e){return dy(gy(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:n}=e,i=[];return Pd(t,(t=>{const e={before:[],lines:[],after:[]},s=py(n,t);sy(e.before,ry(gy(s,"beforeLabel",this,t))),sy(e.lines,gy(s,"label",this,t)),sy(e.after,ry(gy(s,"afterLabel",this,t))),i.push(e)})),i}getAfterBody(t,e){return dy(gy(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:n}=e,i=gy(n,"beforeFooter",this,t),s=gy(n,"footer",this,t),r=gy(n,"afterFooter",this,t);let o=[];return o=sy(o,ry(i)),o=sy(o,ry(s)),o=sy(o,ry(r)),o}_createItems(t){const e=this._active,n=this.chart.data,i=[],s=[],r=[];let o,a,l=[];for(o=0,a=e.length;o<a;++o)l.push(oy(this.chart,e[o]));return t.filter&&(l=l.filter(((e,i,s)=>t.filter(e,i,s,n)))),t.itemSort&&(l=l.sort(((e,i)=>t.itemSort(e,i,n)))),Pd(l,(e=>{const n=py(t.callbacks,e);i.push(gy(n,"labelColor",this,e)),s.push(gy(n,"labelPointStyle",this,e)),r.push(gy(n,"labelTextColor",this,e))})),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=r,this.dataPoints=l,l}update(t,e){const n=this.options.setContext(this.getContext()),i=this._active;let s,r=[];if(i.length){const t=iy[n.position].call(this,i,this._eventPosition);r=this._createItems(n),this.title=this.getTitle(r,n),this.beforeBody=this.getBeforeBody(r,n),this.body=this.getBody(r,n),this.afterBody=this.getAfterBody(r,n),this.footer=this.getFooter(r,n);const e=this._size=ay(this,n),o=Object.assign({},t,e),a=cy(this.chart,n,o),l=hy(n,o,a,this.chart);this.xAlign=a.xAlign,this.yAlign=a.yAlign,s={opacity:1,x:l.x,y:l.y,width:e.width,height:e.height,caretX:t.x,caretY:t.y}}else 0!==this.opacity&&(s={opacity:0});this._tooltipItems=r,this.$context=void 0,s&&this._resolveAnimations().update(this,s),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,n,i){const s=this.getCaretPosition(t,n,i);e.lineTo(s.x1,s.y1),e.lineTo(s.x2,s.y2),e.lineTo(s.x3,s.y3)}getCaretPosition(t,e,n){const{xAlign:i,yAlign:s}=this,{caretSize:r,cornerRadius:o}=n,{topLeft:a,topRight:l,bottomLeft:c,bottomRight:h}=df(o),{x:u,y:d}=t,{width:p,height:f}=e;let g,m,_,y,v,b;return"center"===s?(v=d+f/2,"left"===i?(g=u,m=g-r,y=v+r,b=v-r):(g=u+p,m=g+r,y=v-r,b=v+r),_=g):(m="left"===i?u+Math.max(a,c)+r:"right"===i?u+p-Math.max(l,h)-r:this.caretX,"top"===s?(y=d,v=y-r,g=m-r,_=m+r):(y=d+f,v=y+r,g=m+r,_=m-r),b=y),{x1:g,x2:m,x3:_,y1:y,y2:v,y3:b}}drawTitle(t,e,n){const i=this.title,s=i.length;let r,o,a;if(s){const l=Qf(n.rtl,this.x,this.width);for(t.x=uy(this,n.titleAlign,n),e.textAlign=l.textAlign(n.titleAlign),e.textBaseline="middle",r=ff(n.titleFont),o=n.titleSpacing,e.fillStyle=n.titleColor,e.font=r.string,a=0;a<s;++a)e.fillText(i[a],l.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+o,a+1===s&&(t.y+=n.titleMarginBottom-o)}}_drawColorBox(t,e,n,i,s){const r=this.labelColors[n],o=this.labelPointStyles[n],{boxHeight:a,boxWidth:l}=s,c=ff(s.bodyFont),h=uy(this,"left",s),u=i.x(h),d=a<c.lineHeight?(c.lineHeight-a)/2:0,p=e.y+d;if(s.usePointStyle){const e={radius:Math.min(l,a)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},n=i.leftForLtr(u,l)+l/2,c=p+a/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,Yp(t,e,n,c),t.strokeStyle=r.borderColor,t.fillStyle=r.backgroundColor,Yp(t,e,n,c)}else{t.lineWidth=kd(r.borderWidth)?Math.max(...Object.values(r.borderWidth)):r.borderWidth||1,t.strokeStyle=r.borderColor,t.setLineDash(r.borderDash||[]),t.lineDashOffset=r.borderDashOffset||0;const e=i.leftForLtr(u,l),n=i.leftForLtr(i.xPlus(u,1),l-2),o=df(r.borderRadius);Object.values(o).some((t=>0!==t))?(t.beginPath(),t.fillStyle=s.multiKeyBackground,rf(t,{x:e,y:p,w:l,h:a,radius:o}),t.fill(),t.stroke(),t.fillStyle=r.backgroundColor,t.beginPath(),rf(t,{x:n,y:p+1,w:l-2,h:a-2,radius:o}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(e,p,l,a),t.strokeRect(e,p,l,a),t.fillStyle=r.backgroundColor,t.fillRect(n,p+1,l-2,a-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,e,n){const{body:i}=this,{bodySpacing:s,bodyAlign:r,displayColors:o,boxHeight:a,boxWidth:l,boxPadding:c}=n,h=ff(n.bodyFont);let u=h.lineHeight,d=0;const p=Qf(n.rtl,this.x,this.width),f=function(n){e.fillText(n,p.x(t.x+d),t.y+u/2),t.y+=u+s},g=p.textAlign(r);let m,_,y,v,b,w,x;for(e.textAlign=r,e.textBaseline="middle",e.font=h.string,t.x=uy(this,g,n),e.fillStyle=n.bodyColor,Pd(this.beforeBody,f),d=o&&"right"!==g?"center"===r?l/2+c:l+2+c:0,v=0,w=i.length;v<w;++v){for(m=i[v],_=this.labelTextColors[v],e.fillStyle=_,Pd(m.before,f),y=m.lines,o&&y.length&&(this._drawColorBox(e,t,v,p,n),u=Math.max(h.lineHeight,a)),b=0,x=y.length;b<x;++b)f(y[b]),u=h.lineHeight;Pd(m.after,f)}d=0,u=h.lineHeight,Pd(this.afterBody,f),t.y-=s}drawFooter(t,e,n){const i=this.footer,s=i.length;let r,o;if(s){const a=Qf(n.rtl,this.x,this.width);for(t.x=uy(this,n.footerAlign,n),t.y+=n.footerMarginTop,e.textAlign=a.textAlign(n.footerAlign),e.textBaseline="middle",r=ff(n.footerFont),e.fillStyle=n.footerColor,e.font=r.string,o=0;o<s;++o)e.fillText(i[o],a.x(t.x),t.y+r.lineHeight/2),t.y+=r.lineHeight+n.footerSpacing}}drawBackground(t,e,n,i){const{xAlign:s,yAlign:r}=this,{x:o,y:a}=t,{width:l,height:c}=n,{topLeft:h,topRight:u,bottomLeft:d,bottomRight:p}=df(i.cornerRadius);e.fillStyle=i.backgroundColor,e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.beginPath(),e.moveTo(o+h,a),"top"===r&&this.drawCaret(t,e,n,i),e.lineTo(o+l-u,a),e.quadraticCurveTo(o+l,a,o+l,a+u),"center"===r&&"right"===s&&this.drawCaret(t,e,n,i),e.lineTo(o+l,a+c-p),e.quadraticCurveTo(o+l,a+c,o+l-p,a+c),"bottom"===r&&this.drawCaret(t,e,n,i),e.lineTo(o+d,a+c),e.quadraticCurveTo(o,a+c,o,a+c-d),"center"===r&&"left"===s&&this.drawCaret(t,e,n,i),e.lineTo(o,a+h),e.quadraticCurveTo(o,a,o+h,a),e.closePath(),e.fill(),i.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,n=this.$animations,i=n&&n.x,s=n&&n.y;if(i||s){const n=iy[t.position].call(this,this._active,this._eventPosition);if(!n)return;const r=this._size=ay(this,t),o=Object.assign({},n,this._size),a=cy(e,t,o),l=hy(t,o,a,e);i._to===l.x&&s._to===l.y||(this.xAlign=a.xAlign,this.yAlign=a.yAlign,this.width=r.width,this.height=r.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(e);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const r=pf(e.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&o&&(t.save(),t.globalAlpha=n,this.drawBackground(s,t,i,e),Zf(t,e.textDirection),s.y+=r.top,this.drawTitle(s,t,e),this.drawBody(s,t,e),this.drawFooter(s,t,e),tg(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const n=this._active,i=t.map((({datasetIndex:t,index:e})=>{const n=this.chart.getDatasetMeta(t);if(!n)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:n.data[e],index:e}})),s=!Md(n,i),r=this._positionChanged(i,e);(s||r)&&(this._active=i,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,n=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],r=this._getActiveElements(t,s,e,n),o=this._positionChanged(r,t),a=e||!Md(r,s)||o;return a&&(this._active=r,(i.enabled||i.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),a}_getActiveElements(t,e,n,i){const s=this.options;if("mouseout"===t.type)return[];if(!i)return e.filter((t=>this.chart.data.datasets[t.datasetIndex]&&void 0!==this.chart.getDatasetMeta(t.datasetIndex).controller.getParsed(t.index)));const r=this.chart.getElementsAtEventForMode(t,s.mode,s,n);return s.reverse&&r.reverse(),r}_positionChanged(t,e){const{caretX:n,caretY:i,options:s}=this,r=iy[s.position].call(this,t,e);return!1!==r&&(n!==r.x||i!==r.y)}}var _y={id:"tooltip",_element:my,positioners:iy,afterInit(t,e,n){n&&(t.tooltip=new my({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(!1===t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0}))return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:fy},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>"filter"!==t&&"itemSort"!==t&&"external"!==t,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},yy=Object.freeze({__proto__:null,Colors:P_,Decimation:O_,Filler:Y_,Legend:Q_,SubTitle:ny,Title:ty,Tooltip:_y});function vy(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}function by(t,e,{horizontal:n,minRotation:i}){const s=ip(i),r=(n?Math.sin(s):Math.cos(s))||.001,o=.75*e*(""+t).length;return Math.min(e/r,o)}class wy extends Pm{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return wd(t)||("number"==typeof t||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this;const r=t=>i=e?i:t,o=t=>s=n?s:t;if(t){const t=Qd(i),e=Qd(s);t<0&&e<0?o(0):t>0&&e>0&&r(0)}if(i===s){let e=0===s?1:Math.abs(.05*s);o(s+e),t||r(i-e)}this.min=i,this.max=s}getTickLimit(){const t=this.options.ticks;let e,{maxTicksLimit:n,stepSize:i}=t;return i?(e=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,e>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${e} ticks. Limiting to 1000.`),e=1e3)):(e=this.computeTickLimit(),n=n||11),n&&(e=Math.min(n,e)),e}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i=function(t,e){const n=[],{bounds:i,step:s,min:r,max:o,precision:a,count:l,maxTicks:c,maxDigits:h,includeBounds:u}=t,d=s||1,p=c-1,{min:f,max:g}=e,m=!wd(r),_=!wd(o),y=!wd(l),v=(g-f)/(h+1);let b,w,x,k,C=tp((g-f)/p/d)*d;if(C<1e-14&&!m&&!_)return[{value:f},{value:g}];k=Math.ceil(g/C)-Math.floor(f/C),k>p&&(C=tp(k*C/p/d)*d),wd(a)||(b=Math.pow(10,a),C=Math.ceil(C*b)/b),"ticks"===i?(w=Math.floor(f/C)*C,x=Math.ceil(g/C)*C):(w=f,x=g),m&&_&&s&&function(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}((o-r)/s,C/1e3)?(k=Math.round(Math.min((o-r)/C,c)),C=(o-r)/k,w=r,x=o):y?(w=m?r:w,x=_?o:x,k=l-1,C=(x-w)/k):(k=(x-w)/C,k=Zd(k,Math.round(k),C/1e3)?Math.round(k):Math.ceil(k));const I=Math.max(rp(C),rp(w));b=Math.pow(10,wd(a)?I:a),w=Math.round(w*b)/b,x=Math.round(x*b)/b;let T=0;for(m&&(u&&w!==r?(n.push({value:r}),w<r&&T++,Zd(Math.round((w+T*C)*b)/b,r,by(r,v,t))&&T++):w<r&&T++);T<k;++T){const t=Math.round((w+T*C)*b)/b;if(_&&t>o)break;n.push({value:t})}return _&&u&&x!==o?n.length&&Zd(n[n.length-1].value,o,by(o,v,t))?n[n.length-1].value=o:n.push({value:o}):_&&x!==o||n.push({value:x}),n}({maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:!1!==e.includeBounds},this._range||this);return"ticks"===t.bounds&&np(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}configure(){const t=this.ticks;let e=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const i=(n-e)/Math.max(t.length-1,1)/2;e-=i,n+=i}this._startValue=e,this._endValue=n,this._valueRange=n-e}getLabelForValue(t){return Np(t,this.chart.options.locale,this.options.ticks.format)}}class xy extends wy{static id="linear";static defaults={ticks:{callback:Fp.formatters.numeric}};determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=Cd(t)?t:0,this.max=Cd(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,n=ip(this.options.ticks.minRotation),i=(t?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,s.lineHeight/i))}getPixelForValue(t){return null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const ky=t=>Math.floor(Xd(t)),Cy=(t,e)=>Math.pow(10,ky(t)+e);function Iy(t){return 1==t/Math.pow(10,ky(t))}function Ty(t,e,n){const i=Math.pow(10,n),s=Math.floor(t/i);return Math.ceil(e/i)-s}class Sy extends Pm{static id="logarithmic";static defaults={ticks:{callback:Fp.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const n=wy.prototype.parse.apply(this,[t,e]);if(0!==n)return Cd(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=Cd(t)?Math.max(0,t):null,this.max=Cd(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Cd(this._userMin)&&(this.min=t===Cy(this.min,0)?Cy(this.min,-1):Cy(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let n=this.min,i=this.max;const s=e=>n=t?n:e,r=t=>i=e?i:t;n===i&&(n<=0?(s(1),r(10)):(s(Cy(n,-1)),r(Cy(i,1)))),n<=0&&s(Cy(i,-1)),i<=0&&r(Cy(n,1)),this.min=n,this.max=i}buildTicks(){const t=this.options,e=function(t,{min:e,max:n}){e=Id(t.min,e);const i=[],s=ky(e);let r=function(t,e){let n=ky(e-t);for(;Ty(t,e,n)>10;)n++;for(;Ty(t,e,n)<10;)n--;return Math.min(n,ky(t))}(e,n),o=r<0?Math.pow(10,Math.abs(r)):1;const a=Math.pow(10,r),l=s>r?Math.pow(10,s):0,c=Math.round((e-l)*o)/o,h=Math.floor((e-l)/a/10)*a*10;let u=Math.floor((c-h)/Math.pow(10,r)),d=Id(t.min,Math.round((l+h+u*Math.pow(10,r))*o)/o);for(;d<n;)i.push({value:d,major:Iy(d),significand:u}),u>=10?u=u<15?15:20:u++,u>=20&&(r++,u=2,o=r>=0?1:o),d=Math.round((l+h+u*Math.pow(10,r))*o)/o;const p=Id(t.max,d);return i.push({value:p,major:Iy(p),significand:u}),i}({min:this._userMin,max:this._userMax},this);return"ticks"===t.bounds&&np(e,this,"value"),t.reverse?(e.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),e}getLabelForValue(t){return void 0===t?"0":Np(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=Xd(t),this._valueRange=Xd(this.max)-Xd(t)}getPixelForValue(t){return void 0!==t&&0!==t||(t=this.min),null===t||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(Xd(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function Ey(t){const e=t.ticks;if(e.display&&t.display){const t=pf(e.backdropPadding);return Td(e.font&&e.font.size,Bp.font.size)+t.height}return 0}function Py(t,e,n,i,s){return t===i||t===s?{start:e-n/2,end:e+n/2}:t<i||t>s?{start:e-n,end:e}:{start:e,end:e+n}}function My(t,e,n,i,s){const r=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n));let a=0,l=0;i.start<e.l?(a=(e.l-i.start)/r,t.l=Math.min(t.l,e.l-a)):i.end>e.r&&(a=(i.end-e.r)/r,t.r=Math.max(t.r,e.r+a)),s.start<e.t?(l=(e.t-s.start)/o,t.t=Math.min(t.t,e.t-l)):s.end>e.b&&(l=(s.end-e.b)/o,t.b=Math.max(t.b,e.b+l))}function Ry(t,e,n){const i=t.drawingArea,{extra:s,additionalAngle:r,padding:o,size:a}=n,l=t.getPointPosition(e,i+s+o,r),c=Math.round(sp(cp(l.angle+Yd))),h=function(t,e,n){return 90===n||270===n?t-=e/2:(n>270||n<90)&&(t-=e),t}(l.y,a.h,c),u=function(t){return 0===t||180===t?"center":t<180?"left":"right"}(c),d=(p=l.x,f=a.w,"right"===(g=u)?p-=f:"center"===g&&(p-=f/2),p);var p,f,g;return{visible:!0,x:l.x,y:h,textAlign:u,left:d,top:h,right:d+a.w,bottom:h+a.h}}function Oy(t,e){if(!e)return!0;const{left:n,top:i,right:s,bottom:r}=t;return!(Jp({x:n,y:i},e)||Jp({x:n,y:r},e)||Jp({x:s,y:i},e)||Jp({x:s,y:r},e))}function Ay(t,e,n){const{left:i,top:s,right:r,bottom:o}=n,{backdropColor:a}=e;if(!wd(a)){const n=df(e.borderRadius),l=pf(e.backdropPadding);t.fillStyle=a;const c=i-l.left,h=s-l.top,u=r-i+l.width,d=o-s+l.height;Object.values(n).some((t=>0!==t))?(t.beginPath(),rf(t,{x:c,y:h,w:u,h:d,radius:n}),t.fill()):t.fillRect(c,h,u,d)}}function Dy(t,e,n,i){const{ctx:s}=t;if(n)s.arc(t.xCenter,t.yCenter,e,0,Hd);else{let n=t.getPointPosition(0,e);s.moveTo(n.x,n.y);for(let r=1;r<i;r++)n=t.getPointPosition(r,e),s.lineTo(n.x,n.y)}}class Ny extends wy{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Fp.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:t=>t,padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=pf(Ey(this.options)/2),e=this.width=this.maxWidth-t.width,n=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+n/2+t.top),this.drawingArea=Math.floor(Math.min(e,n)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=Cd(t)&&!isNaN(t)?t:0,this.max=Cd(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Ey(this.options))}generateTickLabels(t){wy.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map(((t,e)=>{const n=Ed(this.options.pointLabels.callback,[t,e],this);return n||0===n?n:""})).filter(((t,e)=>this.chart.getDataVisibility(e)))}fit(){const t=this.options;t.display&&t.pointLabels.display?function(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),i=[],s=[],r=t._pointLabels.length,o=t.options.pointLabels,a=o.centerPointLabels?Bd/r:0;for(let u=0;u<r;u++){const r=o.setContext(t.getPointLabelContext(u));s[u]=r.padding;const d=t.getPointPosition(u,t.drawingArea+s[u],a),p=ff(r.font),f=(l=t.ctx,c=p,h=xd(h=t._pointLabels[u])?h:[h],{w:qp(l,c.string,h),h:h.length*c.lineHeight});i[u]=f;const g=cp(t.getIndexAngle(u)+a),m=Math.round(sp(g));My(n,e,g,Py(m,d.x,f.w,0,180),Py(m,d.y,f.h,90,270))}var l,c,h;t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=function(t,e,n){const i=[],s=t._pointLabels.length,r=t.options,{centerPointLabels:o,display:a}=r.pointLabels,l={extra:Ey(r)/2,additionalAngle:o?Bd/s:0};let c;for(let r=0;r<s;r++){l.padding=n[r],l.size=e[r];const s=Ry(t,r,l);i.push(s),"auto"===a&&(s.visible=Oy(s,c),s.visible&&(c=s))}return i}(t,i,s)}(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,n,i){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((n-i)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,n,i))}getIndexAngle(t){return cp(t*(Hd/(this._pointLabels.length||1))+ip(this.options.startAngle||0))}getDistanceFromCenterForValue(t){if(wd(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(wd(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const n=e[t];return function(t,e,n){return mf(t,{label:n,index:e,type:"pointLabel"})}(this.getContext(),t,n)}}getPointPosition(t,e,n=0){const i=this.getIndexAngle(t)-Yd+n;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter,angle:i}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:n,right:i,bottom:s}=this._pointLabelItems[t];return{left:e,top:n,right:i,bottom:s}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const n=this.ctx;n.save(),n.beginPath(),Dy(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),n.closePath(),n.fillStyle=t,n.fill(),n.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:n,grid:i,border:s}=e,r=this._pointLabels.length;let o,a,l;if(e.pointLabels.display&&function(t,e){const{ctx:n,options:{pointLabels:i}}=t;for(let s=e-1;s>=0;s--){const e=t._pointLabelItems[s];if(!e.visible)continue;const r=i.setContext(t.getPointLabelContext(s));Ay(n,r,e);const o=ff(r.font),{x:a,y:l,textAlign:c}=e;sf(n,t._pointLabels[s],a,l+o.lineHeight/2,o,{color:r.color,textAlign:c,textBaseline:"middle"})}}(this,r),i.display&&this.ticks.forEach(((t,e)=>{if(0!==e||0===e&&this.min<0){a=this.getDistanceFromCenterForValue(t.value);const n=this.getContext(e),o=i.setContext(n),l=s.setContext(n);!function(t,e,n,i,s){const r=t.ctx,o=e.circular,{color:a,lineWidth:l}=e;!o&&!i||!a||!l||n<0||(r.save(),r.strokeStyle=a,r.lineWidth=l,r.setLineDash(s.dash),r.lineDashOffset=s.dashOffset,r.beginPath(),Dy(t,n,o,i),r.closePath(),r.stroke(),r.restore())}(this,o,a,r,l)}})),n.display){for(t.save(),o=r-1;o>=0;o--){const i=n.setContext(this.getPointLabelContext(o)),{color:s,lineWidth:r}=i;r&&s&&(t.lineWidth=r,t.strokeStyle=s,t.setLineDash(i.borderDash),t.lineDashOffset=i.borderDashOffset,a=this.getDistanceFromCenterForValue(e.ticks.reverse?this.min:this.max),l=this.getPointPosition(o,a),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,n=e.ticks;if(!n.display)return;const i=this.getIndexAngle(0);let s,r;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(i),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach(((i,o)=>{if(0===o&&this.min>=0&&!e.reverse)return;const a=n.setContext(this.getContext(o)),l=ff(a.font);if(s=this.getDistanceFromCenterForValue(this.ticks[o].value),a.showLabelBackdrop){t.font=l.string,r=t.measureText(i.label).width,t.fillStyle=a.backdropColor;const e=pf(a.backdropPadding);t.fillRect(-r/2-e.left,-s-l.size/2-e.top,r+e.width,l.size+e.height)}sf(t,i.label,0,-s,l,{color:a.color,strokeColor:a.textStrokeColor,strokeWidth:a.textStrokeWidth})})),t.restore()}drawTitle(){}}const Ly={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Fy=Object.keys(Ly);function zy(t,e){return t-e}function jy(t,e){if(wd(e))return null;const n=t._adapter,{parser:i,round:s,isoWeekday:r}=t._parseOpts;let o=e;return"function"==typeof i&&(o=i(o)),Cd(o)||(o="string"==typeof i?n.parse(o,i):n.parse(o)),null===o?null:(s&&(o="week"!==s||!ep(r)&&!0!==r?n.startOf(o,s):n.startOf(o,"isoWeek",r)),+o)}function Vy(t,e,n,i){const s=Fy.length;for(let r=Fy.indexOf(t);r<s-1;++r){const t=Ly[Fy[r]],s=t.steps?t.steps:Number.MAX_SAFE_INTEGER;if(t.common&&Math.ceil((n-e)/(s*t.size))<=i)return Fy[r]}return Fy[s-1]}function Uy(t,e,n){if(n){if(n.length){const{lo:i,hi:s}=pp(n,e);t[n[i]>=e?n[i]:n[s]]=!0}}else t[e]=!0}function Wy(t,e,n){const i=[],s={},r=e.length;let o,a;for(o=0;o<r;++o)a=e[o],s[a]=o,i.push({value:a,major:!1});return 0!==r&&n?function(t,e,n,i){const s=t._adapter,r=+s.startOf(e[0].value,i),o=e[e.length-1].value;let a,l;for(a=r;a<=o;a=+s.add(a,1,i))l=n[a],l>=0&&(e[l].major=!0);return e}(t,i,s,n):i}class By extends Pm{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const n=t.time||(t.time={}),i=this._adapter=new zg(t.adapters.date);i.init(e),Nd(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return void 0===t?null:jy(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,n=t.time.unit||"day";let{min:i,max:s,minDefined:r,maxDefined:o}=this.getUserBounds();function a(t){r||isNaN(t.min)||(i=Math.min(i,t.min)),o||isNaN(t.max)||(s=Math.max(s,t.max))}r&&o||(a(this._getLabelBounds()),"ticks"===t.bounds&&"labels"===t.ticks.source||a(this.getMinMax(!1))),i=Cd(i)&&!isNaN(i)?i:+e.startOf(Date.now(),n),s=Cd(s)&&!isNaN(s)?s:+e.endOf(Date.now(),n)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],n=t[t.length-1]),{min:e,max:n}}buildTicks(){const t=this.options,e=t.time,n=t.ticks,i="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===t.bounds&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,r=function(t,e,n){let i=0,s=t.length;for(;i<s&&t[i]<e;)i++;for(;s>i&&t[s-1]>n;)s--;return i>0||s<t.length?t.slice(i,s):t}(i,s,this.max);return this._unit=e.unit||(n.autoSkip?Vy(e.minUnit,this.min,this.max,this._getLabelCapacity(s)):function(t,e,n,i,s){for(let r=Fy.length-1;r>=Fy.indexOf(n);r--){const n=Fy[r];if(Ly[n].common&&t._adapter.diff(s,i,n)>=e-1)return n}return Fy[n?Fy.indexOf(n):0]}(this,r.length,e.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(t){for(let e=Fy.indexOf(t)+1,n=Fy.length;e<n;++e)if(Ly[Fy[e]].common)return Fy[e]}(this._unit):void 0,this.initOffsets(i),t.reverse&&r.reverse(),Wy(this,r,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((t=>+t.value)))}initOffsets(t=[]){let e,n,i=0,s=0;this.options.offset&&t.length&&(e=this.getDecimalForValue(t[0]),i=1===t.length?1-e:(this.getDecimalForValue(t[1])-e)/2,n=this.getDecimalForValue(t[t.length-1]),s=1===t.length?n:(n-this.getDecimalForValue(t[t.length-2]))/2);const r=t.length<3?.5:.25;i=up(i,0,r),s=up(s,0,r),this._offsets={start:i,end:s,factor:1/(i+1+s)}}_generate(){const t=this._adapter,e=this.min,n=this.max,i=this.options,s=i.time,r=s.unit||Vy(s.minUnit,e,n,this._getLabelCapacity(e)),o=Td(i.ticks.stepSize,1),a="week"===r&&s.isoWeekday,l=ep(a)||!0===a,c={};let h,u,d=e;if(l&&(d=+t.startOf(d,"isoWeek",a)),d=+t.startOf(d,l?"day":r),t.diff(n,e,r)>1e5*o)throw new Error(e+" and "+n+" are too far apart with stepSize of "+o+" "+r);const p="data"===i.ticks.source&&this.getDataTimestamps();for(h=d,u=0;h<n;h=+t.add(h,o,r),u++)Uy(c,h,p);return h!==n&&"ticks"!==i.bounds&&1!==u||Uy(c,h,p),Object.keys(c).sort(zy).map((t=>+t))}getLabelForValue(t){const e=this._adapter,n=this.options.time;return n.tooltipFormat?e.format(t,n.tooltipFormat):e.format(t,n.displayFormats.datetime)}format(t,e){const n=this.options.time.displayFormats,i=this._unit,s=e||n[i];return this._adapter.format(t,s)}_tickFormatFunction(t,e,n,i){const s=this.options,r=s.ticks.callback;if(r)return Ed(r,[t,e,n],this);const o=s.time.displayFormats,a=this._unit,l=this._majorUnit,c=a&&o[a],h=l&&o[l],u=n[e],d=l&&h&&u&&u.major;return this._adapter.format(t,i||(d?h:c))}generateTickLabels(t){let e,n,i;for(e=0,n=t.length;e<n;++e)i=t[e],i.label=this._tickFormatFunction(i.value,e,t)}getDecimalForValue(t){return null===t?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+n)*e.factor)}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,n=this.ctx.measureText(t).width,i=ip(this.isHorizontal()?e.maxRotation:e.minRotation),s=Math.cos(i),r=Math.sin(i),o=this._resolveTickFontOptions(0).size;return{w:n*s+o*r,h:n*r+o*s}}_getLabelCapacity(t){const e=this.options.time,n=e.displayFormats,i=n[e.unit]||n.millisecond,s=this._tickFormatFunction(t,0,Wy(this,[t],this._majorUnit),i),r=this._getLabelSize(s),o=Math.floor(this.isHorizontal()?this.width/r.w:this.height/r.h)-1;return o>0?o:1}getDataTimestamps(){let t,e,n=this._cache.data||[];if(n.length)return n;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,e=i.length;t<e;++t)n=n.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const t=this._cache.labels||[];let e,n;if(t.length)return t;const i=this.getLabels();for(e=0,n=i.length;e<n;++e)t.push(jy(this,i[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return yp(t.sort(zy))}}function Hy(t,e,n){let i,s,r,o,a=0,l=t.length-1;n?(e>=t[a].pos&&e<=t[l].pos&&({lo:a,hi:l}=fp(t,"pos",e)),({pos:i,time:r}=t[a]),({pos:s,time:o}=t[l])):(e>=t[a].time&&e<=t[l].time&&({lo:a,hi:l}=fp(t,"time",e)),({time:i,pos:r}=t[a]),({time:s,pos:o}=t[l]));const c=s-i;return c?r+(o-r)*(e-i)/c:r}var qy=Object.freeze({__proto__:null,CategoryScale:class extends Pm{static id="category";static defaults={ticks:{callback:vy}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const t=this.getLabels();for(const{index:n,label:i}of e)t[n]===i&&t.splice(n,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(wd(t))return null;const n=this.getLabels();return((t,e)=>null===t?null:up(Math.round(t),0,e))(e=isFinite(e)&&n[e]===t?e:function(t,e,n,i){const s=t.indexOf(e);return-1===s?((t,e,n,i)=>("string"==typeof e?(n=t.push(e)-1,i.unshift({index:n,label:e})):isNaN(e)&&(n=null),n))(t,e,n,i):s!==t.lastIndexOf(e)?n:s}(n,t,Td(e,t),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);"ticks"===this.options.bounds&&(t||(n=0),e||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const t=this.min,e=this.max,n=this.options.offset,i=[];let s=this.getLabels();s=0===t&&e===s.length-1?s:s.slice(t,e+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let n=t;n<=e;n++)i.push({value:n});return i}getLabelForValue(t){return vy.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return"number"!=typeof t&&(t=this.parse(t)),null===t?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}},LinearScale:xy,LogarithmicScale:Sy,RadialLinearScale:Ny,TimeScale:By,TimeSeriesScale:class extends By{static id="timeseries";static defaults=By.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=Hy(e,this.min),this._tableRange=Hy(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:n}=this,i=[],s=[];let r,o,a,l,c;for(r=0,o=t.length;r<o;++r)l=t[r],l>=e&&l<=n&&i.push(l);if(i.length<2)return[{time:e,pos:0},{time:n,pos:1}];for(r=0,o=i.length;r<o;++r)c=i[r+1],a=i[r-1],l=i[r],Math.round((c+a)/2)!==l&&s.push({time:l,pos:r/(o-1)});return s}_generate(){const t=this.min,e=this.max;let n=super.getDataTimestamps();return n.includes(t)&&n.length||n.splice(0,0,t),n.includes(e)&&1!==n.length||n.push(e),n.sort(((t,e)=>t-e))}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),n=this.getLabelTimestamps();return t=e.length&&n.length?this.normalize(e.concat(n)):e.length?e:n,t=this._cache.all=t,t}getDecimalForValue(t){return(Hy(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,n=this.getDecimalForPixel(t)/e.factor-e.end;return Hy(this._table,n*this._tableRange+this._minPos,!0)}}});const $y=[Ng,k_,yy,qy];function Ky(t){return Ky="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ky(t)}function Yy(){Yy=function(){return e};var t,e={},n=Object.prototype,i=n.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",l=r.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function h(t,e,n,i){var r=e&&e.prototype instanceof _?e:_,o=Object.create(r.prototype),a=new M(i||[]);return s(o,"_invoke",{value:T(t,n,a)}),o}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function _(){}function y(){}function v(){}var b={};c(b,o,(function(){return this}));var w=Object.getPrototypeOf,x=w&&w(w(R([])));x&&x!==n&&i.call(x,o)&&(b=x);var k=v.prototype=_.prototype=Object.create(b);function C(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function I(t,e){function n(s,r,o,a){var l=u(t[s],t,r);if("throw"!==l.type){var c=l.arg,h=c.value;return h&&"object"==Ky(h)&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,a)}),(function(t){n("throw",t,o,a)})):e.resolve(h).then((function(t){c.value=t,o(c)}),(function(t){return n("throw",t,o,a)}))}a(l.arg)}var r;s(this,"_invoke",{value:function(t,i){function s(){return new e((function(e,s){n(t,i,e,s)}))}return r=r?r.then(s,s):s()}})}function T(e,n,i){var s=d;return function(r,o){if(s===f)throw Error("Generator is already running");if(s===g){if("throw"===r)throw o;return{value:t,done:!0}}for(i.method=r,i.arg=o;;){var a=i.delegate;if(a){var l=S(a,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(s===d)throw s=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);s=f;var c=u(e,n,i);if("normal"===c.type){if(s=i.done?g:p,c.arg===m)continue;return{value:c.arg,done:i.done}}"throw"===c.type&&(s=g,i.method="throw",i.arg=c.arg)}}}function S(e,n){var i=n.method,s=e.iterator[i];if(s===t)return n.delegate=null,"throw"===i&&e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method)||"return"!==i&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var r=u(s,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,m;var o=r.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function M(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function R(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,r=function n(){for(;++s<e.length;)if(i.call(e,s))return n.value=e[s],n.done=!1,n;return n.value=t,n.done=!0,n};return r.next=r}}throw new TypeError(Ky(e)+" is not iterable")}return y.prototype=v,s(k,"constructor",{value:v,configurable:!0}),s(v,"constructor",{value:y,configurable:!0}),y.displayName=c(v,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,c(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},C(I.prototype),c(I.prototype,a,(function(){return this})),e.AsyncIterator=I,e.async=function(t,n,i,s,r){void 0===r&&(r=Promise);var o=new I(h(t,n,i,s),r);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},C(k),c(k,l,"Generator"),c(k,o,(function(){return this})),c(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=R,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(P),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function s(i,s){return a.type="throw",a.arg=e,n.next=i,s&&(n.method="next",n.arg=t),!!s}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return s("end");if(o.tryLoc<=this.prev){var l=i.call(o,"catchLoc"),c=i.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return s(o.catchLoc,!0);if(this.prev<o.finallyLoc)return s(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return s(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return s(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&i.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var s=i.arg;P(n)}return s}}throw Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:R(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),m}},e}function Gy(t,e,n,i,s,r,o){try{var a=t[r](o),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(i,s)}function Jy(t){return function(){var e=this,n=arguments;return new Promise((function(i,s){var r=t.apply(e,n);function o(t){Gy(r,i,s,o,a,"next",t)}function a(t){Gy(r,i,s,o,a,"throw",t)}o(void 0)}))}}r_.register(...$y);var Xy=ue({apiKey:"AIzaSyDldmyWPWPd8-HFZDHUGvL4G9hJr1iUhdI",authDomain:"log-for.firebaseapp.com",projectId:"log-for",storageBucket:"log-for.appspot.com",messagingSenderId:"90635650344",appId:"1:90635650344:web:4ce8c6a15b81407f61bc1d",measurementId:"MISSING_ENV_VAR".FIREBASE_MEASUREMENT_ID,databaseURL:"https://log-for-default-rtdb.firebaseio.com/"});!function(t=de(),e){const n=oe(t=Y(t),"app-check");if(su().initialized||function(){const t=u(),e=su();if(e.initialized=!0,"string"!=typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN&&!0!==t.FIREBASE_APPCHECK_DEBUG_TOKEN)return;e.enabled=!0;const n=new m;e.token=n,"string"==typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(Su())}(),Eu()&&Pu().then((t=>console.log(`App Check debug token: ${t}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`))),n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(s.isTokenAutoRefreshEnabled===e.isTokenAutoRefreshEnabled&&s.provider.isEqual(e.provider))return i;throw cu.create("already-initialized",{appName:t.name})}const i=n.initialize({options:e});(function(t,e,n){const i=function(t,e){return tu.set(t,e),tu.get(t)}(t,Object.assign({},eu));i.activated=!0,i.provider=e,i.cachedTokenPromise=async function(t){if(w()){let e;try{e=await function(t){return ku(Cu(t))}(t)}catch(t){Iu.warn(`Failed to read token from IndexedDB. Error: ${t}`)}return e}}(t).then((e=>(e&&Lu(e)&&(i.token=e,Nu(t,{token:e.token})),e))),i.isTokenAutoRefreshEnabled=void 0===n?t.automaticDataCollectionEnabled:n,i.provider.initialize(t)})(t,e.provider,e.isTokenAutoRefreshEnabled),iu(t).isTokenAutoRefreshEnabled&&Ou(i,"INTERNAL",(()=>{}))}(Xy,{provider:new Uu("6LfIaiolAAAAAOlGQwgUO_O7OkqgUaeYEuAI2XTh"),isTokenAutoRefreshEnabled:!0});var Qy,Zy=function(t=de(),e){const n=oe(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const t=(()=>{const t=p("database");if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const n=parseInt(t.substring(e+1),10);return"["===t[0]?[t.substring(1,e-1),n]:[t.substring(0,e),n]})();t&&function(t,e,n,i={}){(t=Y(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&so("Cannot call useEmulator() after instance has already been initialized.");const s=t._repoInternal;let r;if(s.repoInfo_.nodeAdmin)i.mockUserToken&&so('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),r=new ko(ko.OWNER);else if(i.mockUserToken){const e="string"==typeof i.mockUserToken?i.mockUserToken:function(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const r=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(r)),""].join(".")}(i.mockUserToken,t.app.options.projectId);r=new ko(e)}!function(t,e,n,i){t.repoInfo_=new Po(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),i&&(t.authTokenProvider_=i)}(s,e,n,r)}(n,...t)}return n}(Xy);function tv(){return tv=Jy(Yy().mark((function t(){var e,n,i,s,r;return Yy().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Function added() is running"),e=zr(Xy),t.prev=4,t.next=7,Ps(e,"arthurviniciusm.r.coelho@gmail.com","091200156_Aa");case 7:if(n=t.sent,console.log("Usuário autenticado com sucesso:",n.user.uid),n.user,i=document.querySelector(".freight-form")){t.next=13;break}throw new Error("Formulário não encontrado");case 13:i.addEventListener("submit",function(){var t=Jy(Yy().mark((function t(e){var n,s,r,o,a,l,c,h,u,d,p,f,g,m,_,y,v,b,w,x,k,C,I;return Yy().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),n=document.querySelector("[name=product]").value,s=document.querySelector("[name=cep]").value,r=document.querySelector("[name=length]").value,o=document.querySelector("[name=width]").value,a=document.querySelector("[name=height]").value,l=document.querySelector("[name=weight]").value,c=document.querySelector("[name=destination]").value,h=document.querySelector("[name=address]").value,u=document.querySelector("[name=street]").value,d=document.querySelector("[name=state]").value,p=document.querySelector("[name=number]").value,f=document.querySelector("[name=complement]").value,g=document.querySelector("[name=freight-value]").value,m=document.querySelector("[name=additional-info]").value,_=document.querySelector("[name=contact-name]").value,y=document.querySelector("[name=contact-email]").value,v=document.querySelector("[name=contact-phone]").value,b={produto:n,cep_origem:s,comprimento:r,largura:o,altura:a,cep_destino:c,endereco:h,peso:l,rua:u,estado:d,numero:p,complemento:f,valor_carga:g,info_adicional:m,contato_numero:v,contato_nome:_,contato_email:y,data:(new Date).toISOString(),status:"Pendente",codigo_chave:""},w=qh(Zy,"ultimoId"),t.next=22,Yh(w);case 22:return x=t.sent,k=parseInt(x.val(),10),I=qh(Zy,"pedidos/"+(C=k+1)),t.next=28,Kh(I,b);case 28:return t.next=30,Kh(w,C);case 30:console.log("Dados inseridos com sucesso!"),i.reset();case 32:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.next=22;break;case 16:t.prev=16,t.t0=t.catch(4),console.error("Erro durante a autenticação ou inserção de dados:",t.t0),s=t.t0.code,r=t.t0.message,console.error("Erro de autenticação (".concat(s,"): ").concat(r));case 22:case"end":return t.stop()}}),t,null,[[4,16]])}))),tv.apply(this,arguments)}!function(t=de()){const e=oe(t=Y(t),pn);e.isInitialized()?e.getImmediate():function(t,e={}){const n=oe(t,pn);if(n.isInitialized()){const t=n.getImmediate();if(A(e,n.getOptions()))return t;throw bn.create("already-initialized")}n.initialize({options:e})}(t)}(Xy),document.addEventListener("DOMContentLoaded",(function(){!function(){tv.apply(this,arguments)}()})),function(t,e,n,i){(function(t,e,n,i,s){let r;if("object"==typeof i&&(r=void 0,s=i),"function"==typeof i&&(r=i),s&&s.onlyOnce){const e=n,i=(n,i)=>{Th(t._repo,t,a),e(n,i)};i.userCallback=n.userCallback,i.context=n.context,n=i}const o=new Uh(n,r||void 0),a="value"===e?new Gh(o):new Jh(e,o);(function(t,e,n){let i;i=".info"===Yo(e._path)?Cc(t.infoSyncTree_,e,n):Cc(t.serverSyncTree_,e,n),dh(t.eventQueue_,e._path,i)})(t._repo,t,a)})(t,"value",e,n,i)}(qh(Zy,"pedidos"),(function(t){var e=t.val();if(console.log("Dados de pedidos recebidos:",e),e){var n=document.getElementById("real-time-table").querySelector("tbody"),i=document.getElementById("order-history");n.innerHTML="",i.innerHTML="";var s={},r={};for(var o in e){var a=e[o];console.log("Processando pedido:",a);var l=new Date(a.data).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"}),c="\n                <tr>\n                    <td>".concat(a.produto,"</td>\n                    <td>").concat(a.endereco,"</td>\n                    <td>").concat(a.codigoChave,"</td>\n                    <td>").concat(a.status,"</td>\n                </tr>");n.insertAdjacentHTML("beforeend",c);var h="\n                <tr>\n                    <td>".concat(l,"</td>\n                    <td>").concat(a.produto,"</td>\n                    <td>").concat(a.status,"</td>\n                </tr>");i.insertAdjacentHTML("beforeend",h);var u=new Date(a.dataFormatada).getMonth();s[u]||(s[u]=0),r[u]||(r[u]={entregues:0,cancelados:0}),s[u]++,"Entregue"===a.status&&r[u].entregues++,"Cancelado"===a.status&&r[u].cancelados++}console.log("Contagem de pedidos por mês:",s),console.log("Status de pedidos por mês:",r);var d=document.getElementById("monitoringChar").getContext("2d");Qy&&Qy.destroy(),Qy=new r_(d,{type:"line",data:{labels:Object.keys(s).map((function(t){return"Mês ".concat(parseInt(t)+1)})),datasets:[{label:"Total de Pedidos",data:Object.values(s),borderColor:"rgb(75, 192, 192)",fill:!1},{label:"Entregues",data:Object.values(r).map((function(t){return t.entregues})),borderColor:"rgb(54, 162, 235)",fill:!1},{label:"Cancelados",data:Object.values(r).map((function(t){return t.cancelados})),borderColor:"rgb(255, 99, 132)",fill:!1}]},options:{scales:{x:{beginAtZero:!0},y:{beginAtZero:!0}},plugins:{legend:{display:!0,position:"top"},title:{display:!0,text:"Monitoramento de Pedidos"}}}}),console.log("Gráfico atualizado com sucesso!")}else console.log("Nenhum dado de pedidos encontrado.")}),(function(t){console.error("Erro ao acessar os dados:",t)}))})();
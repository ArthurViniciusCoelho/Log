<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel do Cliente</title>
    <link rel="stylesheet" href="../src/css/index.css">
    <link rel="icon" href="./favicon.ico">
    <script type="module" src="../src/js/firebaseConfig.js"></script>
    <script type="module" src="../dist/assets/main.bundle.js"></script>
    <!------------------------- Google fonts --------------------------------->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.12.5/firebase-auth.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.12.5/firebase-database.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/10.12.5/firebase-analytics.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
        <div class="logo">
            <img src="https://logforall.com.br/img/component/toolbar/Logo-log4.png" alt="Logo da Transportadora">
        </div>
        <nav>
            <a href="#" class="btn">Início</a>
            <a href="#" class="btn">Log4</a>
            <a href="#" class="btn">Suporte</a>
            <!-- Dropdown para Minha Conta -->
            <div class="dropdown">
                <button onclick="toggleDropdown()" class="dropbtn">Minha Conta</button>
                <div id="dropdown-content" class="dropdown-content">
                    <a href="#" id="edit-profile">Editar Perfil</a>
                    <a href="#" id="dark-mode">Modo Escuro</a>
                </div>
            </div>
        </nav>
    </header>

    <main>
        <div class="container">
            <div class="section">
                <h2>Monitoramento em Tempo Real</h2>
                <table class="interactive-table" id="real-time-table">
                    <thead>
                        <tr>
                            <th>Produto</th>
                            <th>Endereço</th>
                            <th>Código Chave</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dados serão carregados dinamicamente aqui -->
                    </tbody>
                </table>
            </div>

            <section class="hp">
                <h2>Histórico de Pedidos</h2>
                <table class="interactive-table">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Produto</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody id="order-history">
                        <!-- Dados serão carregados dinamicamente aqui -->
                    </tbody>
                </table>
            </section>

            <div class="section-Gráfico">
                <h2>Gráfico de Monitoramento</h2>
                <div class="chart-container">
                    <canvas id="monitoringChar"></canvas>
                </div>
            </div>

            <div class="freight-simulator">
                <h1>Novo Produto</h1>
                <form class="freight-form" id="freight-form">
                    <div class="form-row">
                        <div class="form-group half-width">
                            <label for="product">Produto:</label>
                            <input type="text" id="product" name="product" required>
                        </div>
                        <div class="form-group half-width">
                            <label for="cep">CEP de Origem:</label>
                            <input type="number" id="cep" name="cep" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group third-width">
                            <label for="length">Comprimento (cm):</label>
                            <input type="number" id="length" name="length" required>
                        </div>
                        <div class="form-group third-width">
                            <label for="width">Largura (cm):</label>
                            <input type="number" id="width" name="width" required>
                        </div>
                        <div class="form-group third-width">
                            <label for="height">Altura (cm):</label>
                            <input type="number" id="height" name="height" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="weight">Peso (kg):</label>
                        <input type="number" id="weight" name="weight" required>
                    </div>
                    <div class="form-group">
                        <label for="destination">CEP de Destino:</label>
                        <input type="number" id="destination" name="destination" required onblur="fetchAddressByCep('destination', 'address', 'street', 'state')">
                    </div>
                    <div class="form-group">
                        <label for="address">Endereço:</label>
                        <input type="text" id="address" name="address" readonly>
                    </div>
                    <div class="form-group">
                        <label for="street">Rua:</label>
                        <input type="text" id="street" name="street" readonly>
                    </div>
                    <div class="form-row">
                        <div class="form-group half-width">
                            <label for="state">Estado:</label>
                            <input type="text" id="state" name="state" readonly>
                        </div>
                        <div class="form-group half-width">
                            <label for="number">Número:</label>
                            <input type="number" id="number" name="number" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="complement">Complemento:</label>
                        <input type="text" id="complement" name="complement" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label for="freight-value">Valor da Carga (R$):</label>
                        <input type="number" id="freight-value" name="freight-value" required>
                    </div>
                    <div class="form-group">
                        <label for="additional-info">Informações Adicionais:</label>
                        <textarea id="additional-info" name="additional-info" rows="4"></textarea>
                    </div>
                    <!-- Novos campos adicionados -->
                    <div class="form-row">
                        <div class="form-group half-width">
                            <label for="contact-name">Nome de Contato:</label>
                            <input type="text" id="contact-name" name="contact-name" required>
                        </div>
                        <div class="form-group half-width">
                            <label for="contact-email">E-mail de Contato:</label>
                            <input type="email" id="contact-email" name="contact-email" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="contact-phone">Telefone de Contato:</label>
                        <input type="tel" id="contact-phone" name="contact-phone" required>
                    </div>
                    <button type="submit">Adicionar Produto</button>
                </form>
            </div>
        </div>

        <div class="list">

        </div>

    </main>

    <footer>
        <div class="footerContainer">

            <div class="socialIcons">
                <a href=""><i class="fab fa-facebook"></i></a>
                <a href=""><i class="fab fa-twitter"></i></a>
                <a href=""><i class="fab fa-instagram"></i></a>
            </div>
            <div class="footerNav">
                <ul>
                    <li><a href="">Home</a></li>
                    <li><a href="">Log4</a></li>
                    <li><a href="">Suporte</a></li>
                    <li><a href="">Minha Conta</a></li>
                </ul>
            </div>
        </div>
        <div class="footerBottom">
            <p>Log4 Serviços de Consultoria em Logística S/A 36.290.619/0001-25</p>
        </div>
    </footer>
    
    <script>
        function fetchAddressByCep(destinationInputId, addressInputId, streetInputId, stateInputId) {
            const cepInput = document.getElementById(destinationInputId);
            const addressInput = document.getElementById(addressInputId);
            const streetInput = document.getElementById(streetInputId);
            const stateInput = document.getElementById(stateInputId);
            const cep = cepInput.value.replace(/\D/g, '');

            if (cep.length !== 8) {
                console.error('CEP inválido');
                return;
            }

            const url = `https://viacep.com.br/ws/${cep}/json/`;
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data.erro) {
                        console.error('CEP não encontrado');
                        return;
                    }
                    addressInput.value = data.bairro || '';
                    streetInput.value = data.logradouro || '';
                    stateInput.value = data.uf || '';
                })
                .catch(error => console.error('Error:', error));
        }

        function toggleDropdown() {
            document.getElementById("dropdown-content").classList.toggle("show");
        }

        window.onclick = function (event) {
            if (!event.target.matches('.dropbtn')) {
                var dropdowns = document.getElementsByClassName("dropdown-content");
                for (var i = 0; i < dropdowns.length; i++) {
                    var openDropdown = dropdowns[i];
                    if (openDropdown.classList.contains('show')) {
                        openDropdown.classList.remove('show');
                    }
                }
            }
        }

        

        const ctx = document.getElementById('monitoringChart').getContext('2d');
        const chart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho'],
                datasets: [{
                    label: 'Monitoramento de Cargas',
                    borderColor: 'rgb(75, 192, 192)',
                    data: [0, 10, 5, 2, 20, 30],
                    fill: false
                }]
            },
            options: {
                scales: {
                    x: {
                        beginAtZero: true
                    },
                    y: {
                        beginAtZero: true
                    }
                },
                plugins: {
                    legend: {
                        display: true,
                        position: 'top'
                    },
                    title: {
                        display: true,
                        text: 'Monitoramento de Cargas'
                    }
                }
            }
        });

    </script>

    <!------------------------- Google fonts --------------------------------->
    
    

    
</body>
</html>
